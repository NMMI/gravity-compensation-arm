C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE INTERRUPTIONS
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Release\interruptions.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\3.3\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -.\interruptions.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(NDEBUG) WL(2) PR(.\DP80
                    -51_Keil_951\Release/interruptions.lst) CD OT(8,SPEED) OJ(.\DP8051_Keil_951\Release\interruptions.obj)

line level    source

*** MESSAGE C286 IN LINE 0 OF (null): license limits optimization to level 5
   1          // ----------------------------------------------------------------------------
   2          // Copyright (C)  qbrobotics. All rights reserved.
   3          // www.qbrobotics.com
   4          // ----------------------------------------------------------------------------
   5          
   6          /**
   7          * \file         interruptions.c
   8          *
   9          * \brief        Interruption handling and firmware core functions
  10          * \date         June 06, 2016
  11          * \author       _qbrobotics_
  12          * \copyright    (C)  qbrobotics. All rights reserved.
  13          */
  14          
  15          
  16          //=================================================================     includes
  17          #include <interruptions.h>
  18          #include <command_processing.h>
  19          #include <globals.h>
  20          #include <utils.h>
  21          
  22          
  23          //==============================================================================
  24          //                                                            RS485 RX INTERRUPT
  25          //==============================================================================
  26          // Processing RS-485 data frame:
  27          //
  28          // - 0:     Waits for beggining characters
  29          // - 1:     Waits for ID;
  30          // - 2:     Data length;
  31          // - 3:     Receive all bytes;
  32          // - 4:     Wait for another device end of transmission;
  33          //
  34          //==============================================================================
  35          
  36          // PWM values needed to obtain 11.5 V given a certain input tension
  37          // Numbers are sperimentally calculated //[index] (millivolts)
  38          static const uint8 pwm_preload_values[29] = {100,    //0 (11500)
  39                                                        83,
  40                                                        78,
  41                                                        76,
  42                                                        74,
  43                                                        72,    //5 (14000)
  44                                                        70,
  45                                                        68,
  46                                                        67,
  47                                                        65,
  48                                                        64,    //10 (16500)
  49                                                        63,
  50                                                        62,
  51                                                        61,
  52                                                        60,
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 2   

  53                                                        59,    //15 (19000)
  54                                                        58,
  55                                                        57,
  56                                                        56,
  57                                                        56,
  58                                                        55,    //20 (21500)
  59                                                        54,
  60                                                        54,
  61                                                        53,
  62                                                        52,
  63                                                        52,    //25 (24000)
  64                                                        52,
  65                                                        51,
  66                                                        51};   //28 (25500)
  67          
  68          //==============================================================================
  69          //                                                            WATCHDOG INTERRUPT
  70          //==============================================================================
  71          
  72          CY_ISR(ISR_WATCHDOG_Handler){
  73   1      
  74   1          // Set WDT flag
  75   1          
  76   1          watchdog_flag = TRUE;
  77   1      
  78   1      }
  79          
  80          //==============================================================================
  81          //                                                            RS485 RX INTERRUPT
  82          //==============================================================================
  83          
  84          CY_ISR(ISR_RS485_RX_ExInterrupt) {
  85   1      
  86   1          // Set RS485 flag
  87   1          
  88   1          interrupt_flag = TRUE;
  89   1           
  90   1      }
  91          
  92          //==============================================================================
  93          //                                                             INTERRUPT MANAGER
  94          //==============================================================================
  95          // Manage interrupt from RS485 
  96          //==============================================================================
  97          // Processing RS-485 data frame:
  98          //
  99          // - WAIT_START:    Waits for beginning characters;
 100          // - WAIT_ID:       Waits for ID;
 101          // - WAIT_LENGTH:   Data length;
 102          // - RECEIVE:       Receive all bytes;
 103          // - UNLOAD:        Wait for another device end of transmission;
 104          //
 105          //==============================================================================
 106          
 107          void interrupt_manager(){
 108   1      
 109   1          
 110   1          //===========================================     local variables definition
 111   1      
 112   1          static uint8 CYDATA state = WAIT_START;                      // state
 113   1          
 114   1          //------------------------------------------------- local data packet
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 3   

 115   1          static uint8 CYDATA data_packet_index;
 116   1          static uint8 CYDATA data_packet_length;
 117   1          static uint8 data_packet_buffer[128];                     
 118   1          static uint8 CYDATA rx_queue[3];                    // last 2 bytes received
 119   1          //-------------------------------------------------
 120   1      
 121   1          uint8 CYDATA    rx_data;                            // RS485 UART rx data
 122   1          CYBIT           rx_data_type;                       // my id?
 123   1          uint8 CYDATA    package_count = 0;                     
 124   1      
 125   1          //======================================================     receive routine
 126   1          
 127   1          // Get data until buffer is not empty 
 128   1          
 129   1          while(UART_RS485_GetRxBufferSize() && (package_count < 6)){  
 130   2              // 6 stima di numero massimo di pacchetti che riesco a leggere senza bloccare l'esecuzione del fir
             -mware
 131   2              
 132   2              // Get next char
 133   2              rx_data = UART_RS485_GetChar();
 134   2              
 135   2              switch (state) {
 136   3                  //-----     wait for frame start     -------------------------------
 137   3                  case WAIT_START:
 138   3                  
 139   3                      rx_queue[0] = rx_queue[1];
 140   3                      rx_queue[1] = rx_queue[2];
 141   3                      rx_queue[2] = rx_data;
 142   3                      
 143   3                      // Check for header configuration package
 144   3                      if ((rx_queue[1] == 58) && (rx_queue[2] == 58)) {
 145   4                          rx_queue[0] = 0;
 146   4                          rx_queue[1] = 0;
 147   4                          rx_queue[2] = 0;
 148   4                          state       = WAIT_ID;                    
 149   4                      }else
 150   3                          if ((rx_queue[0] == 63) &&      //ASCII - ?
 151   3                              (rx_queue[1] == 13) &&      //ASCII - CR
 152   3                              (rx_queue[2] == 10))        //ASCII - LF)
 153   3                              infoGet(INFO_ALL);
 154   3                      break;
 155   3      
 156   3                  //-----     wait for id     ----------------------------------------
 157   3                  case  WAIT_ID:
 158   3      
 159   3                      // packet is for my ID or is broadcast
 160   3                      if (rx_data == c_mem.id || rx_data == 0)
 161   3                          rx_data_type = FALSE;
 162   3                      else                //packet is for others
 163   3                          rx_data_type = TRUE;
 164   3                      
 165   3                      data_packet_length = 0;
 166   3                      state = WAIT_LENGTH;
 167   3                      break;
 168   3      
 169   3                  //-----     wait for length     ------------------------------------
 170   3                  case  WAIT_LENGTH:
 171   3      
 172   3       
 173   3                      data_packet_length = rx_data;
 174   3                      // check validity of pack length
 175   3                      if (data_packet_length <= 1) {
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 4   

 176   4                          data_packet_length = 0;
 177   4                          state = WAIT_START;
 178   4                      } else if (data_packet_length > 128) {
 179   4                          data_packet_length = 0;
 180   4                          state = WAIT_START;
 181   4                      } else {
 182   4                          data_packet_index = 0;
 183   4                          
 184   4                          if(rx_data_type == FALSE)
 185   4                              state = RECEIVE;          // packet for me or broadcast
 186   4                          else
 187   4                              state = UNLOAD;           // packet for others
 188   4                      }
 189   3                      break;
 190   3      
 191   3                  //-----     receiving     -------------------------------------------
 192   3                  case RECEIVE:
 193   3      
 194   3                      data_packet_buffer[data_packet_index] = rx_data;
 195   3                      data_packet_index++;
 196   3                      
 197   3                      // check end of transmission
 198   3                      if (data_packet_index >= data_packet_length) {
 199   4                          // verify if frame ID corresponded to the device ID
 200   4                          if (rx_data_type == FALSE) {
 201   5                              // copying data from buffer to global packet
 202   5                              memcpy(g_rx.buffer, data_packet_buffer, data_packet_length);
 203   5                              g_rx.length = data_packet_length;
 204   5                              g_rx.ready  = 1;
 205   5                              commProcess();
 206   5                          }
 207   4                          
 208   4                          data_packet_index  = 0;
 209   4                          data_packet_length = 0;
 210   4                          state              = WAIT_START;
 211   4                          package_count++;
 212   4                      
 213   4                      }
 214   3                      break;
 215   3      
 216   3                  //-----     other device is receving     ---------------------------
 217   3                  case UNLOAD:
 218   3                      if (!(--data_packet_length)) {
 219   4                          data_packet_index  = 0;
 220   4                          data_packet_length = 0;
 221   4                          RS485_CTS_Write(1);
 222   4                          RS485_CTS_Write(0);
 223   4                          state              = WAIT_START;
 224   4                          package_count++;
 225   4                      }
 226   3                      break;
 227   3              }
 228   2          }
 229   1      }
 230          //==============================================================================
 231          //                                                            FUNCTION SCHEDULER
 232          //==============================================================================
 233          // Call all the function with the right frequency
 234          //==============================================================================
 235          // Base frequency 1000 Hz
 236          //==============================================================================
 237          
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 5   

 238          void function_scheduler(void) {
 239   1       
 240   1          static uint16 counter_calibration = DIV_INIT_VALUE;
 241   1      
 242   1          timer_value0 = (uint32)MY_TIMER_ReadCounter();
 243   1      
 244   1          // Start ADC Conversion, SOC = 1
 245   1      
 246   1          ADC_SOC_Write(0x01); 
 247   1          
 248   1          // Check Interrupt 
 249   1      
 250   1          if (interrupt_flag){
 251   2              interrupt_flag = FALSE;
 252   2              interrupt_manager();
 253   2          }
 254   1        
 255   1          //---------------------------------- Get Encoders
 256   1      
 257   1          encoder_reading(0); 
 258   1          
 259   1          // Check Interrupt     
 260   1          
 261   1          if (interrupt_flag){
 262   2              interrupt_flag = FALSE;
 263   2              interrupt_manager();
 264   2          }   
 265   1          
 266   1          encoder_reading(1);
 267   1          
 268   1          // Check Interrupt 
 269   1          
 270   1          if (interrupt_flag){
 271   2              interrupt_flag = FALSE;
 272   2              interrupt_manager();
 273   2          }
 274   1          
 275   1          encoder_reading(2);
 276   1          
 277   1          // Check Interrupt 
 278   1          
 279   1          if (interrupt_flag){
 280   2              interrupt_flag = FALSE;
 281   2              interrupt_manager();
 282   2          }
 283   1      
 284   1          //---------------------------------- Control Motor
 285   1         
 286   1          motor_control();
 287   1      
 288   1          // Check Interrupt 
 289   1      
 290   1          if (interrupt_flag){
 291   2              interrupt_flag = FALSE;
 292   2              interrupt_manager();
 293   2          }
 294   1      
 295   1          //---------------------------------- Control Overcurrent
 296   1      
 297   1          overcurrent_control();
 298   1          
 299   1          // Check Interrupt 
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 6   

 300   1          
 301   1          if (interrupt_flag){
 302   2              interrupt_flag = FALSE;
 303   2              interrupt_manager();
 304   2          }
 305   1      
 306   1          //---------------------------------- Read conversion buffer - LOCK function
 307   1      
 308   1          analog_read_end();
 309   1      
 310   1          //---------------------------------- Calibration 
 311   1      
 312   1          // Divider 10, freq = 500 Hz
 313   1          if (calib.enabled == TRUE) {
 314   2              if (counter_calibration == CALIBRATION_DIV) {
 315   3                  calibration();
 316   3                  counter_calibration = 0;
 317   3              }
 318   2              counter_calibration++;
 319   2          }
 320   1      
 321   1          // Check Interrupt 
 322   1          
 323   1          if (interrupt_flag){
 324   2              interrupt_flag = FALSE;
 325   2              interrupt_manager();
 326   2          }
 327   1         
 328   1          //---------------------------------- Update States
 329   1          
 330   1          // Load k-1 state
 331   1          memcpy( &g_measOld, &g_meas, sizeof(g_meas) );
 332   1          memcpy( &g_refOld, &g_ref, sizeof(g_ref) );
 333   1      
 334   1          // Load k+1 state
 335   1          memcpy( &g_ref, &g_refNew, sizeof(g_ref) );
 336   1      
 337   1          if (interrupt_flag){
 338   2              interrupt_flag = FALSE;
 339   2              interrupt_manager();
 340   2          }
 341   1      
 342   1          timer_value = (uint32)MY_TIMER_ReadCounter();
 343   1          MY_TIMER_WriteCounter(5000000);
 344   1      
 345   1      }
 346          
 347          //==============================================================================
 348          //                                                                MOTORS CONTROL
 349          //==============================================================================
 350          
 351          void motor_control() {
 352   1      
 353   1          int32 CYDATA pwm_input = 0;
 354   1      
 355   1          int32 CYDATA pos_error;         // position error
 356   1          int32 CYDATA curr_error;        // current error
 357   1      
 358   1          int32 CYDATA i_ref;             // current reference
 359   1          int32 CYDATA handle_value;
 360   1      
 361   1          int32 CYDATA err_joy_1, err_joy_2;
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 7   

 362   1          int32 CYDATA pos_diff, pos_sum;
 363   1          
 364   1          int32 CYDATA k_p = c_mem.k_p;  
 365   1          int32 CYDATA k_i = c_mem.k_i; 
 366   1          int32 CYDATA k_d = c_mem.k_d; 
 367   1      
 368   1          int32 CYDATA k_p_c = c_mem.k_p_c;  
 369   1          int32 CYDATA k_i_c = c_mem.k_i_c; 
 370   1          int32 CYDATA k_d_c = c_mem.k_d_c;   
 371   1      
 372   1          int32 CYDATA k_p_dl = c_mem.k_p_dl;  
 373   1          int32 CYDATA k_i_dl = c_mem.k_i_dl; 
 374   1          int32 CYDATA k_d_dl = c_mem.k_d_dl;
 375   1          
 376   1          int32 CYDATA k_p_c_dl = c_mem.k_p_c_dl;  
 377   1          int32 CYDATA k_i_c_dl = c_mem.k_i_c_dl; 
 378   1          int32 CYDATA k_d_c_dl = c_mem.k_d_c_dl;   
 379   1      
 380   1          // Static Variables
 381   1      
 382   1          static int32 pos_error_sum;     // position error sum for integral
 383   1          static int32 curr_error_sum;    // current error sum for integral
 384   1          
 385   1          static int32 prev_pos_err;      // previous position error for deriv. control
 386   1          static int32 prev_curr_err;     // previous current error for deriv. control
 387   1      
 388   1          static CYBIT motor_dir = FALSE;
 389   1      
 390   1          // =========================== POSITION INPUT ==============================
 391   1          switch(c_mem.input_mode) {
 392   2      
 393   2              case INPUT_MODE_ENCODER3:
 394   2      
 395   2                  // Calculate handle value based on position of handle in the
 396   2                  // sensor chain and multiplication factor between handle and motor position
 397   2                  if (c_mem.double_encoder_on_off) 
 398   2                      handle_value = g_meas.pos[2] * c_mem.motor_handle_ratio;
 399   2                  else
 400   2                      handle_value = g_meas.pos[1] * c_mem.motor_handle_ratio;
 401   2                  
 402   2      
 403   2                  // Read handle and use it as reference for the motor
 404   2                  if (((handle_value - g_ref.pos[0]) > c_mem.max_step_pos) && (c_mem.max_step_pos != 0))
 405   2                      g_ref.pos[0] += c_mem.max_step_pos;
 406   2                  else {
 407   3                      if (((handle_value - g_ref.pos[0]) < c_mem.max_step_neg) && (c_mem.max_step_neg != 0))
 408   3                          g_ref.pos[0] += c_mem.max_step_neg;
 409   3                      else
 410   3                      g_ref.pos[0] = handle_value;
 411   3                  }
 412   2                  break;
 413   2      
 414   2              case INPUT_MODE_JOYSTICK:
 415   2                  switch(c_mem.control_mode) {
 416   3                      // ======================= POSITION CONTROL =======================
 417   3                      case CONTROL_ANGLE:
 418   3                          err_joy_1 = 0;
 419   3                          err_joy_2 = 0;
 420   3                          if(!(g_meas.joystick[0] > 900)) {
 421   4                              err_joy_1 = g_meas.joystick[0] - g_mem.joystick_threshold;
 422   4      
 423   4                              //if (err_joy_1 > 0) {   
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 8   

 424   4                              if(g_meas.joystick[0] > g_mem.joystick_threshold) {     //both motors wind the wir
             -e around the pulley
 425   5                                  g_ref.pos[0] += ((int32) err_joy_1 * g_mem.closure_speed) / (1024 - g_mem.joys
             -tick_threshold);
 426   5                                  g_ref.pos[1] += ((int32) err_joy_1 * g_mem.closure_speed) / (1024 - g_mem.joys
             -tick_threshold);
 427   5      
 428   5                              }
 429   4                              else {
 430   5                                  err_joy_1 = g_meas.joystick[0] + g_mem.joystick_threshold;
 431   5                                  //if (err_joy_1 < 0) {
 432   5                                  if(g_meas.joystick[0] < -g_mem.joystick_threshold) {  //both motors unroll the
             - wire around the pulley
 433   6                                      g_ref.pos[0] += ((int32) err_joy_1 * g_mem.closure_speed) / (1024 - g_mem.
             -joystick_threshold);
 434   6                                      g_ref.pos[1] += ((int32) err_joy_1 * g_mem.closure_speed) / (1024 - g_mem.
             -joystick_threshold);
 435   6      
 436   6                                  }
 437   5                              }
 438   4      
 439   4                              err_joy_2 = g_meas.joystick[1] - g_mem.joystick_threshold;
 440   4                              //if(err_joy_2 > 0) {
 441   4                              if(g_meas.joystick[1] > g_mem.joystick_threshold) {    //The wire is winded around
             - the first pulley and unwinded from the second one
 442   5                                  g_ref.pos[0] += ((int32) err_joy_2 * g_mem.closure_speed) / (1024 - g_mem.joys
             -tick_threshold);
 443   5                                  g_ref.pos[1] -= ((int32) err_joy_2 * g_mem.closure_speed) / (1024 - g_mem.joys
             -tick_threshold);
 444   5                              
 445   5                              }
 446   4                              else {
 447   5                                  err_joy_2 = g_meas.joystick[1] + g_mem.joystick_threshold;
 448   5                                  //if(err_joy_2 < 0) {
 449   5                                  if(g_meas.joystick[1] < -g_mem.joystick_threshold) {  //The wire is unwinded f
             -rom the first pulley and winded on the second one
 450   6                                      g_ref.pos[0] += ((int32) err_joy_2 * g_mem.closure_speed) / (1024 - g_mem.
             -joystick_threshold);
 451   6                                      g_ref.pos[1] -= ((int32) err_joy_2 * g_mem.closure_speed) / (1024 - g_mem.
             -joystick_threshold);
 452   6      
 453   6                                  }
 454   5                              }
 455   4                          }
 456   3      
 457   3                          else {  //The button is pressed and the hand is opened firstly making the position dif
             -ference
 458   4                                  //equal to zero, then the position sum is gradually set to zero 
 459   4                              pos_diff = (g_meas.pos[0] - g_meas.pos[1]) >> c_mem.res[0];
 460   4                              pos_sum = (g_meas.pos[0] + g_meas.pos[1]) >> c_mem.res[0];
 461   4      
 462   4                              if(abs(pos_diff) > 500) {
 463   5                                  if(SIGN(pos_diff) == 1) {
 464   6                                      g_ref.pos[1] += g_mem.closure_speed;
 465   6                                      g_ref.pos[0] -= g_mem.closure_speed / 2;
 466   6                                  }
 467   5                                  else {
 468   6                                      g_ref.pos[0] += g_mem.closure_speed;
 469   6                                      g_ref.pos[1] -= g_mem.closure_speed / 2;
 470   6                                  }
 471   5                                 
 472   5                              }
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 9   

 473   4                              else {
 474   5                                  if(pos_sum > 0) {
 475   6                                      g_ref.pos[0] -= g_mem.closure_speed * 2;
 476   6                                      g_ref.pos[1] -= g_mem.closure_speed * 2;
 477   6                                      if(g_ref.pos[0] < 0)
 478   6                                          g_ref.pos[0] = 0;
 479   6                                      if(g_ref.pos[1] < 0);
 480   6                                          g_ref.pos[1] = 0;
 481   6                                  }
 482   5                              }
 483   4                          }
 484   3                          break;
 485   3                      // ======================= PWM CONTROL =======================
 486   3                      // (Gravity Compensation Arm)
 487   3                      case CONTROL_PWM:
 488   3                          
 489   3                          // g_meas.joystick[1] (UP/DOWN DIRECTION) has to be rescaled to range [-100, 100] 
 490   3                          // to feed motor with coherent pwm input
 491   3                          err_joy_2 = (int32) (-(100.0/512.0) * g_meas.joystick[1]);
 492   3                          
 493   3                          // Compensation Arm is going up (PWM < 0)
 494   3                          if (g_meas.curr[0] < -g_mem.current_limit && g_meas.joystick[1] > 0)
 495   3                              err_joy_2 = 0;
 496   3                          
 497   3                          // Compensation Arm is going up (PWM < 0)
 498   3                          if (g_meas.curr[0] > g_mem.current_limit && g_meas.joystick[1] < 0)
 499   3                              err_joy_2 = 0;
 500   3                              
 501   3                          g_ref.pwm[0] = (int32) err_joy_2;
 502   3                          
 503   3                          break;
 504   3                          
 505   3                      default:
 506   3                          break;
 507   3                  }
 508   2            
 509   2              break;
 510   2                  
 511   2              default:
 512   2                  break;
 513   2          }
 514   1      
 515   1          // Position limit saturation
 516   1          if (c_mem.pos_lim_flag) {
 517   2              if (g_ref.pos[0] < c_mem.pos_lim_inf[0]) 
 518   2                  g_ref.pos[0] = c_mem.pos_lim_inf[0];
 519   2              if (g_ref.pos[0] > c_mem.pos_lim_sup[0]) 
 520   2                  g_ref.pos[0] = c_mem.pos_lim_sup[0];
 521   2          }
 522   1      
 523   1          switch(c_mem.control_mode) {
 524   2              // ======================= CURRENT AND POSITION CONTROL =======================
 525   2              case CURR_AND_POS_CONTROL:
 526   2                  pos_error = g_ref.pos[0] - g_meas.pos[0];
 527   2      
 528   2                  pos_error_sum += pos_error;
 529   2      
 530   2                  // error_sum saturation
 531   2                  if (pos_error_sum > POS_INTEGRAL_SAT_LIMIT)
 532   2                      pos_error_sum = POS_INTEGRAL_SAT_LIMIT;
 533   2                  else {
 534   3                      if (pos_error_sum < -POS_INTEGRAL_SAT_LIMIT) 
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 10  

 535   3                          pos_error_sum = -POS_INTEGRAL_SAT_LIMIT;
 536   3                  }
 537   2                  
 538   2                  // ------ position PID control ------
 539   2      
 540   2                  i_ref = 0;
 541   2                  
 542   2                  // Proportional
 543   2                  if (k_p_dl != 0)
 544   2                      i_ref += (int32)(k_p_dl * pos_error) >> 16;
 545   2      
 546   2                  // Integral
 547   2                  if (k_i_dl != 0)
 548   2                      i_ref += (int32)(k_i_dl * (pos_error_sum >> 6)) >> 10;
 549   2      
 550   2                  // Derivative
 551   2                  if (k_d_dl != 0)
 552   2                      i_ref += (int32)(k_d_dl * (pos_error - prev_pos_err)) >> 16;
 553   2                              
 554   2                  // Update previous position
 555   2                  prev_pos_err = pos_error;
 556   2      
 557   2                  // // current set through position reference
 558   2                  // i_ref = g_ref.pos[0] >> g_mem.res[0];
 559   2      
 560   2                  // motor direction depends on i_ref
 561   2                  if (i_ref >= 0)
 562   2                      motor_dir = TRUE;
 563   2                  else
 564   2                      motor_dir = FALSE;
 565   2      
 566   2                  // current ref must be positive
 567   2                  //i_ref = abs(i_ref);
 568   2      
 569   2                  // saturate max current
 570   2                  if (i_ref > c_mem.current_limit)
 571   2                      i_ref = c_mem.current_limit;
 572   2                  else 
 573   2                      if (i_ref < -c_mem.current_limit)
 574   2                          i_ref = -c_mem.current_limit;
 575   2                  
 576   2      
 577   2                  // saturate min current
 578   2                  /*if (i_ref < MIN_CURR_SAT_LIMIT && i_ref > 0) {
 579   2                      i_ref = MIN_CURR_SAT_LIMIT;
 580   2                  }*/
 581   2      
 582   2                  // // write i_ref on meas curr 2 for DEBUG
 583   2                  //g_meas.curr[1] = i_ref;
 584   2      
 585   2                  // current error and curr error sum
 586   2                  curr_error = i_ref - g_meas.curr[0];
 587   2                  curr_error_sum += curr_error;
 588   2                  
 589   2                  if (curr_error_sum > CURR_INTEGRAL_SAT_LIMIT)
 590   2                      curr_error_sum = CURR_INTEGRAL_SAT_LIMIT;
 591   2                  else {
 592   3                      if (curr_error_sum < -CURR_INTEGRAL_SAT_LIMIT)
 593   3                          curr_error_sum = -CURR_INTEGRAL_SAT_LIMIT;
 594   3                  }
 595   2      
 596   2                  // ----- current PID control -----
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 11  

 597   2      
 598   2                  pwm_input = 0;
 599   2      
 600   2                  // Proportional
 601   2                  if (k_p_c_dl != 0)
 602   2                      pwm_input += (int32)(k_p_c_dl * curr_error) >> 16;
 603   2      
 604   2                  // Integral
 605   2                  if (k_i_c_dl != 0)
 606   2                      pwm_input += (int32)(k_i_c_dl * (curr_error_sum >> 6)) >> 10;
 607   2      
 608   2                  // Derivative
 609   2                  if (k_d_c_dl != 0)
 610   2                      pwm_input += (int32)(k_d_c_dl * (curr_error - prev_curr_err)) >> 16;
 611   2      
 612   2                  // pwm_input saturation
 613   2                  if (pwm_input < -PWM_MAX_VALUE) 
 614   2                      pwm_input = -PWM_MAX_VALUE;
 615   2                  else {
 616   3                      if (pwm_input > PWM_MAX_VALUE)
 617   3                          pwm_input = PWM_MAX_VALUE;
 618   3                  }
 619   2      
 620   2                  // Update previous current
 621   2                  prev_curr_err = curr_error;
 622   2      
 623   2              break;
 624   2      
 625   2              // ============================== POSITION CONTROL =====================
 626   2              case CONTROL_ANGLE:
 627   2                  pos_error = g_ref.pos[0] - g_meas.pos[0];
 628   2      
 629   2                  pos_error_sum += pos_error;
 630   2      
 631   2                  // anti-windup (for integral control)
 632   2                  if (pos_error_sum > ANTI_WINDUP) {
 633   3                      pos_error_sum = ANTI_WINDUP;
 634   3                  } else if (pos_error_sum < -ANTI_WINDUP) {
 635   3                      pos_error_sum = -ANTI_WINDUP;
 636   3                  }
 637   2      
 638   2                  // Proportional
 639   2                  if (k_p != 0) 
 640   2                      pwm_input = (int32)(k_p * pos_error) >> 16;
 641   2                  
 642   2      
 643   2                  // Integral
 644   2                  if (k_i != 0) 
 645   2                      pwm_input += (int32)(k_i * (pos_error_sum >> 6)) >> 10;
 646   2                  
 647   2      
 648   2                  // Derivative
 649   2                  if (k_d != 0) 
 650   2                      pwm_input += (int32)(k_d * (pos_error - prev_pos_err)) >> 16;
 651   2                  
 652   2      
 653   2                  // Update measure
 654   2                  prev_pos_err = pos_error;
 655   2      
 656   2                  if (pwm_input > 0)
 657   2                      motor_dir = TRUE;
 658   2                  else
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 12  

 659   2                      motor_dir = FALSE;
 660   2      
 661   2              break;
 662   2      
 663   2              // ========================== CURRENT CONTROL ==========================
 664   2              case CONTROL_CURRENT:
 665   2                  if(g_ref.onoff && tension_valid) {
 666   3                      
 667   3                      i_ref = g_ref.curr[0];
 668   3      
 669   3                      if (i_ref > c_mem.current_limit) 
 670   3                          i_ref = c_mem.current_limit;
 671   3                      else {
 672   4                          if (i_ref < -c_mem.current_limit)
 673   4                              i_ref = -c_mem.current_limit;
 674   4                      }
 675   3                      
 676   3                      // current error
 677   3                      curr_error = i_ref - g_meas.curr[0];            
 678   3                      curr_error_sum += curr_error;
 679   3                      
 680   3                      if (curr_error_sum > CURR_INTEGRAL_SAT_LIMIT)
 681   3                          curr_error_sum = CURR_INTEGRAL_SAT_LIMIT;
 682   3                      else {
 683   4                          if (curr_error_sum < -CURR_INTEGRAL_SAT_LIMIT) 
 684   4                              curr_error_sum = -CURR_INTEGRAL_SAT_LIMIT;
 685   4                      }
 686   3      
 687   3                      pwm_input = 0;
 688   3      
 689   3                      // Proportional
 690   3                      if (k_p_c != 0)
 691   3                          pwm_input += (int32)(k_p_c * curr_error) >> 16;
 692   3      
 693   3                      // Integral
 694   3                      if (k_i_c != 0)
 695   3                          pwm_input += (int32)(k_i_c * (curr_error_sum >> 6)) >> 10;
 696   3      
 697   3                      // Derivative
 698   3                      if (k_d_c != 0)
 699   3                          pwm_input += (int32)(k_d_c * (curr_error - prev_curr_err)) >> 16;
 700   3                      
 701   3                      prev_curr_err = curr_error;
 702   3                      
 703   3                      if (pwm_input >= 0) 
 704   3                          motor_dir = TRUE;
 705   3                      else
 706   3                          motor_dir = FALSE;
 707   3                  }
 708   2              break;
 709   2              
 710   2              // ================= DIRECT PWM CONTROL ================================
 711   2              case CONTROL_PWM:
 712   2      
 713   2                  pwm_input = g_ref.pwm[0];
 714   2      
 715   2                  if (pwm_input > 0) 
 716   2                      motor_dir = TRUE;
 717   2                  else 
 718   2                      motor_dir = FALSE;
 719   2                  
 720   2      
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 13  

 721   2                  // pwm_input saturation
 722   2                  if (pwm_input < -PWM_MAX_VALUE) 
 723   2                      pwm_input = -PWM_MAX_VALUE;
 724   2                   else if (pwm_input > PWM_MAX_VALUE) 
 725   2                      pwm_input = PWM_MAX_VALUE;
 726   2                  
 727   2      
 728   2              break;
 729   2          }
 730   1      
 731   1          ////////////////////////////////////////////////////////////////////////////
 732   1      
 733   1          if(pwm_input >  PWM_MAX_VALUE) 
 734   1              pwm_input =  PWM_MAX_VALUE;
 735   1          if(pwm_input < -PWM_MAX_VALUE) 
 736   1              pwm_input = -PWM_MAX_VALUE;
 737   1      
 738   1      
 739   1          if (c_mem.control_mode != CONTROL_PWM) 
 740   1              pwm_input = (((pwm_input << 10) / PWM_MAX_VALUE) * dev_pwm_limit) >> 10;
 741   1          
 742   1      
 743   1          pwm_sign = SIGN(pwm_input);
 744   1      
 745   1          if (motor_dir)
 746   1              MOTOR_DIR_Write(0x01);
 747   1          else
 748   1              MOTOR_DIR_Write(0x00);
 749   1      
 750   1          PWM_MOTORS_WriteCompare1(abs(pwm_input));
 751   1      }
 752          
 753          //==============================================================================
 754          //                                                                   ENCODER READING
 755          //==============================================================================
 756          
 757          void encoder_reading(const uint8 idx) {
 758   1      
 759   1          uint8 CYDATA index = idx;
 760   1          
 761   1          uint8 jj;
 762   1          
 763   1          uint32 data_encoder;
 764   1          int32 value_encoder;
 765   1          int32 aux;
 766   1      
 767   1          static int32 last_value_encoder[NUM_OF_SENSORS];
 768   1      
 769   1          static uint8 error[NUM_OF_SENSORS];
 770   1          
 771   1          static CYBIT only_first_time = TRUE;
 772   1      
 773   1          static uint8 one_time_execute = 0;
 774   1          static CYBIT pos_reconstruct = FALSE;
 775   1      
 776   1          // static int32 l_value[NUM_OF_SENSORS];   //last value for vel
 777   1          // static int32 ll_value[NUM_OF_SENSORS];  //last last value for vel
 778   1          // static int32 lll_value[NUM_OF_SENSORS];  //last last last value for vel
 779   1      
 780   1          if (index >= NUM_OF_SENSORS)
 781   1              return;
 782   1          
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 14  

 783   1          if (reset_last_value_flag) {
 784   2              for (jj = NUM_OF_SENSORS; jj--;) 
 785   2                  last_value_encoder[jj] = 0;
 786   2              
 787   2              reset_last_value_flag = 0;
 788   2          }
 789   1      
 790   1          //======================================================     reading sensors
 791   1              // Shift 1 right to erase Dummy bit of chain
 792   1          if (index == 0)
 793   1                  data_encoder = (SHIFTREG_ENC_1_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 794   1          else {
 795   2              if (index == 1)
 796   2                  data_encoder = (SHIFTREG_ENC_2_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 797   2              else // index == 2
 798   2                  data_encoder = (SHIFTREG_ENC_3_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 799   2          }
 800   1             
 801   1      
 802   1          if (check_enc_data(&data_encoder)) {
 803   2      
 804   2              value_encoder = (int16) (((data_encoder & 0x3FFC0) - 0x20000) >> 2 ) + g_mem.m_off[index];
 805   2                                                          // reset last 6 bit 
 806   2                                                          // -> |:|:|id|dim|CMD|CHK|(data---
 807   2                                                          // subtract half of max value
 808   2                                                          // and shift to have 16 bit val
 809   2      
 810   2              // Initialize last_value_encoder
 811   2              if (only_first_time) {
 812   3                  last_value_encoder[index] = value_encoder;
 813   3                  if (index == 2)
 814   3                      only_first_time = 0;
 815   3              }
 816   2      
 817   2              // Take care of rotations
 818   2              aux = value_encoder - last_value_encoder[index];
 819   2      
 820   2              // ====================== 1 TURN ======================
 821   2              // -32768                    0                    32767 -32768                   0                
             -     32767
 822   2              // |-------------------------|-------------------------|-------------------------|----------------
             ----------|
 823   2              //              |                         |      |           |      |                         |
 824   2              //           -16384                     16383    |           |   -16384                     16383
 825   2              //                                               |           |
 826   2              //                                           24575           -24576
 827   2              //                                               |___________|
 828   2              //                                                   49152
 829   2      
 830   2              // if we are in the right interval, take care of rotation
 831   2              // and update the variable only if the difference between
 832   2              // one measure and another is less than 1/4 of turn
 833   2      
 834   2              // Considering we are sampling at 1kHz, this means that our shaft needs
 835   2              // to go slower than 1/4 turn every ms -> 1 turn every 4ms
 836   2              // equal to 250 turn/s -> 15000 RPM
 837   2      
 838   2              if (aux > 49152)
 839   2                  g_meas.rot[index]--;
 840   2              else{ 
 841   3                  if (aux < -49152)
 842   3                      g_meas.rot[index]++;
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 15  

 843   3                  else{
 844   4                      if (abs(aux) > 16384) { // if two measure are too far
 845   5                          error[index]++;
 846   5                          if (error[index] < 10)
 847   5                              // Discard
 848   5                              return;
 849   5                      }
 850   4                  }
 851   3              }
 852   2      
 853   2              error[index] = 0;
 854   2      
 855   2              last_value_encoder[index] = value_encoder;
 856   2      
 857   2              value_encoder += (int32)g_meas.rot[index] << 16;
 858   2      
 859   2              if (c_mem.m_mult[index] != 1.0) {
 860   3                  value_encoder *= c_mem.m_mult[index];
 861   3              }
 862   2      
 863   2              g_meas.pos[index] = value_encoder;
 864   2          }
 865   1      
 866   1          // wait at least 3 * max_num_of_error (10) + 5 = 35 cycles to reconstruct the right turn
 867   1          if (pos_reconstruct == FALSE){
 868   2              if (one_time_execute < 34) 
 869   2                  one_time_execute++;
 870   2              else {
 871   3                  //Double encoder translation
 872   3                  if (c_mem.double_encoder_on_off)
 873   3                      g_meas.rot[0] = calc_turns_fcn(g_meas.pos[0], g_meas.pos[1]);
 874   3      
 875   3                  g_meas.pos[0] += (int32) g_meas.rot[0] << 16;
 876   3      
 877   3                  // If necessary activate motors
 878   3                  g_refNew.pos[0] = g_meas.pos[0];
 879   3      
 880   3                  MOTOR_ON_OFF_Write(g_ref.onoff);
 881   3                  
 882   3                  pos_reconstruct = TRUE;
 883   3              }
 884   2          }
 885   1      }
 886          
 887          //==============================================================================
 888          //                                                           ANALOG MEASUREMENTS
 889          //==============================================================================
 890          
 891          void analog_read_end() {
 892   1      
 893   1          /* =========================================================================
 894   1          /   Ideal formulation to calculate tension and current
 895   1          /
 896   1          /   tension = ((read_value_mV - offset) * 101) / gain -> [mV]
 897   1          /   current = ((read_value_mV - offset) * 375) / (gain * resistor) -> [mA]
 898   1          /
 899   1          /   Definition:
 900   1          /   read_value_mV = counts_read / 0.819 -> conversion from counts to mV
 901   1          /   offset = 2000 -> hardware amplifier bias in mV
 902   1          /   gain = 8.086 -> amplifier gain
 903   1          /   resistor = 18 -> resistor of voltage divider in KOhm 
 904   1          /
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 16  

 905   1          /   Real formulation: tradeoff in good performance and accurancy, ADC_buf[] 
 906   1          /   and offset unit of measurment is counts, instead dev_tension and
 907   1          /   g_meas.curr[] are converted in properly unit.
 908   1          /  =========================================================================
 909   1          */
 910   1      
 911   1          int16 CYDATA i_aux;
 912   1          
 913   1          static joystick_status CYDATA UD_status = RESET;
 914   1          static joystick_status CYDATA LR_status = RESET;  
 915   1          
 916   1          static uint16 UD_counter = 0;
 917   1          static uint16 LR_counter = 0;
 918   1          
 919   1          static int32 UD_mean_value;
 920   1          static int32 LR_mean_value;
 921   1      
 922   1          // Wait for conversion end
 923   1          
 924   1          while(!ADC_STATUS_Read()){
 925   2              if (interrupt_flag){
 926   3                  interrupt_flag = FALSE;
 927   3                  interrupt_manager();
 928   3              }
 929   2          }
 930   1          
 931   1          // Convert tension read
 932   1          dev_tension = ((int32)(ADC_buf[0] - 1638) * 1952) >> 7;
 933   1          
 934   1          if (interrupt_flag){
 935   2              interrupt_flag = FALSE;
 936   2              interrupt_manager();
 937   2          }
 938   1      
 939   1          // Until there is no valid input tension repeat this measurement
 940   1          
 941   1          if (dev_tension > 0){
 942   2              // Set tension valid bit to TRUE
 943   2      
 944   2              tension_valid = TRUE;
 945   2      
 946   2              if(g_mem.activate_pwm_rescaling)        //pwm rescaling is activated
 947   2                  pwm_limit_search();                 //only for 12V motors
 948   2      
 949   2              // Filter and Set currents
 950   2              g_meas.curr[0] = filter_i1((int16) (((int32)(ADC_buf[1] - 1638) * 25771) >> 13) * pwm_sign);
 951   2              
 952   2              // Check Interrupt 
 953   2          
 954   2              if (interrupt_flag){
 955   3                  interrupt_flag = FALSE;
 956   3                  interrupt_manager();
 957   3              }
 958   2      
 959   2              switch (UD_status) {
 960   3                  case NORMAL:
 961   3                      i_aux = ADC_buf[2];
 962   3                      // Remap the analog reading from -1024 to 1024.  
 963   3                      i_aux = (int32) (((float) (i_aux - UD_mean_value) / UD_mean_value) * g_mem.joystick_gains[
             -1]); 
 964   3                      
 965   3                      if (interrupt_flag){
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 17  

 966   4                          interrupt_flag = FALSE;
 967   4                          interrupt_manager();
 968   4                      }
 969   3      
 970   3                      //Saturation
 971   3                      if (i_aux < -1024) 
 972   3                          i_aux = -1024;
 973   3                      if (i_aux > 1024)
 974   3                          i_aux = 1024;
 975   3      
 976   3                      g_meas.joystick[1] = (int16) i_aux;
 977   3      
 978   3                      if (interrupt_flag){
 979   4                          interrupt_flag = FALSE;
 980   4                          interrupt_manager();
 981   4                      }
 982   3      
 983   3                  break;
 984   3      
 985   3                  case RESET: // reset variables
 986   3                      UD_counter = 0;
 987   3                      UD_mean_value = 0;
 988   3                      UD_status = WAIT; // go to waiting status
 989   3      
 990   3                  break;
 991   3      
 992   3                  case DISCARD: // discard first EMG_SAMPLE_TO_DISCARD samples
 993   3                      UD_counter++;
 994   3                      if (UD_counter == JOYSTICK_SAMPLE_TO_DISCARD) {
 995   4                          UD_counter = 0;                     // reset counter
 996   4      
 997   4                          if (interrupt_flag){
 998   5                              interrupt_flag = FALSE;
 999   5                              interrupt_manager();
1000   5                          }
1001   4      
1002   4                          UD_status = SUM_AND_MEAN;           // sum and mean status
1003   4                      }
1004   3      
1005   3                  break;
1006   3      
1007   3                  case SUM_AND_MEAN: // sum first SAMPLES_FOR_EMG_MEAN samples
1008   3                      // NOTE max(value)*SAMPLES_FOR_EMG_MEAN must fit in 32bit
1009   3                      UD_counter++;
1010   3                      UD_mean_value += ADC_buf[2];
1011   3      
1012   3                      if (interrupt_flag){
1013   4                          interrupt_flag = FALSE;
1014   4                          interrupt_manager();
1015   4                      }
1016   3      
1017   3                      if (UD_counter == SAMPLES_FOR_JOYSTICK_MEAN) {
1018   4                          UD_mean_value = UD_mean_value / SAMPLES_FOR_JOYSTICK_MEAN; // calc mean
1019   4      
1020   4                          if (interrupt_flag){
1021   5                              interrupt_flag = FALSE;
1022   5                              interrupt_manager();
1023   5                          }
1024   4      
1025   4                          UD_counter = 0;          // reset counter
1026   4                          UD_status = NORMAL;           // goto normal execution
1027   4                      }
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 18  

1028   3                  break;
1029   3      
1030   3                  case WAIT:
1031   3                      UD_status = DISCARD;           // goto discard sample
1032   3                  break;
1033   3              }
1034   2      
1035   2              switch (LR_status) {
1036   3                  case NORMAL:
1037   3                      i_aux = ADC_buf[3];
1038   3      
1039   3                      i_aux = (int32) (((float) (i_aux - LR_mean_value) / LR_mean_value) * g_mem.joystick_gains[
             -0]); 
1040   3                      
1041   3                      if (interrupt_flag){
1042   4                          interrupt_flag = FALSE;
1043   4                          interrupt_manager();
1044   4                      }
1045   3      
1046   3                      //Saturation
1047   3                      if (i_aux < -1024)
1048   3                          i_aux = -1024;
1049   3                      if (i_aux > 1024)
1050   3                          i_aux = 1024;
1051   3      
1052   3                      if (interrupt_flag){
1053   4                          interrupt_flag = FALSE;
1054   4                          interrupt_manager();
1055   4                      }
1056   3      
1057   3                      g_meas.joystick[0] = (int16) i_aux;
1058   3      
1059   3                  break;
1060   3      
1061   3                  case RESET: // reset variables
1062   3                      LR_counter = 0;
1063   3                      LR_mean_value = 0;
1064   3                      LR_status = WAIT; // goes waiting for all conversions to be done
1065   3                  break;
1066   3      
1067   3                  case DISCARD: // discard first EMG_SAMPLE_TO_DISCARD samples8
1068   3                      LR_counter++;
1069   3                      if (LR_counter == JOYSTICK_SAMPLE_TO_DISCARD) {
1070   4                          LR_counter = 0;                     // reset counter
1071   4      
1072   4                          if (interrupt_flag){
1073   5                              interrupt_flag = FALSE;
1074   5                              interrupt_manager();
1075   5                          }
1076   4      
1077   4                          LR_status = SUM_AND_MEAN;           // sum and mean status
1078   4                      }
1079   3                  break;
1080   3      
1081   3                  case SUM_AND_MEAN: // sum first SAMPLES_FOR_EMG_MEAN samples
1082   3                      // NOTE max(value)*SAMPLES_FOR_EMG_MEAN must fit in 32bit
1083   3                      LR_counter++;
1084   3                      LR_mean_value += ADC_buf[3];
1085   3                      if (LR_counter == SAMPLES_FOR_JOYSTICK_MEAN) {
1086   4                          LR_mean_value = LR_mean_value / SAMPLES_FOR_JOYSTICK_MEAN; // calc mean
1087   4                          
1088   4                          if (interrupt_flag){
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 19  

1089   5                              interrupt_flag = FALSE;
1090   5                              interrupt_manager();
1091   5                          }
1092   4      
1093   4                          LR_counter = 0;               // reset counter
1094   4                          LR_status = NORMAL;           // goto normal execution
1095   4                      }
1096   3                  break;
1097   3      
1098   3                  case WAIT:
1099   3                      if(UD_status == NORMAL)
1100   3                          LR_status = DISCARD;
1101   3                  break;
1102   3              }
1103   2      
1104   2              if (interrupt_flag){
1105   3                  interrupt_flag = FALSE;
1106   3                  interrupt_manager();
1107   3              }
1108   2          }
1109   1          else{
1110   2              UD_status = RESET;
1111   2              LR_status = RESET;
1112   2              
1113   2              tension_valid = FALSE;
1114   2                  
1115   2              if (interrupt_flag){
1116   3                  interrupt_flag = FALSE;
1117   3                  interrupt_manager();
1118   3              }
1119   2              
1120   2              // Reset current
1121   2              g_meas.curr[0] = 0;
1122   2      
1123   2              //Reset Joystick
1124   2              g_meas.joystick[0] = 0;
1125   2              g_meas.joystick[1] = 0;
1126   2      
1127   2          }
1128   1              
1129   1          if (interrupt_flag){
1130   2              interrupt_flag = FALSE;
1131   2              interrupt_manager();
1132   2          }
1133   1      }
1134          
1135          //==============================================================================
1136          //                                                           OVERCURRENT CONTROL
1137          //==============================================================================
1138          
1139          void overcurrent_control() {
1140   1          if (c_mem.current_limit != 0) {
1141   2              // if the current is over the limit
1142   2              if (g_meas.curr[0] > c_mem.current_limit) {
1143   3                  //decrese pwm_limit
1144   3                  dev_pwm_limit--;
1145   3              // if the current is in the safe zone
1146   3              } else if (g_meas.curr[0] < (c_mem.current_limit - CURRENT_HYSTERESIS)) {
1147   3                  //increase pwm_limit
1148   3                  dev_pwm_limit++;
1149   3              }
1150   2      
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 20  

1151   2              // Bound pwm_limit
1152   2              if (dev_pwm_limit < 0) 
1153   2                  dev_pwm_limit = 0;
1154   2              else 
1155   2                  if (dev_pwm_limit > 100) 
1156   2                      dev_pwm_limit = 100;
1157   2          }
1158   1      }
1159          
1160          //==============================================================================
1161          //                                                              PWM_LIMIT_SEARCH
1162          //==============================================================================
1163          
1164          void pwm_limit_search() {
1165   1      
1166   1          uint8 CYDATA index;
1167   1      
1168   1          if (dev_tension > 25500) {
1169   2              dev_pwm_limit = 0;
1170   2          } else if (dev_tension < 11500) {
1171   2              dev_pwm_limit = 100;
1172   2          } else {
1173   2              index = (uint8)((dev_tension - 11500) >> 9);
1174   2              dev_pwm_limit = pwm_preload_values[index];
1175   2          }
1176   1      }
1177          /* [] END OF FILE */
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 21  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION ISR_WATCHDOG_Handler (BEGIN)
                                           ; SOURCE LINE # 72
                                           ; SOURCE LINE # 76
0000 D200        E     SETB    watchdog_flag
                                           ; SOURCE LINE # 78
0002 32                RETI    
             ; FUNCTION ISR_WATCHDOG_Handler (END)

             ; FUNCTION ISR_RS485_RX_ExInterrupt (BEGIN)
                                           ; SOURCE LINE # 84
                                           ; SOURCE LINE # 88
0000 D200        E     SETB    interrupt_flag
                                           ; SOURCE LINE # 90
0002 32                RETI    
             ; FUNCTION ISR_RS485_RX_ExInterrupt (END)

             ; FUNCTION interrupt_manager (BEGIN)
                                           ; SOURCE LINE # 107
                                           ; SOURCE LINE # 123
0000 E4                CLR     A
0001 F500        R     MOV     package_count,A
0003         ?C0003:
                                           ; SOURCE LINE # 129
0003 120000      E     LCALL   UART_RS485_GetRxBufferSize
0006 EF                MOV     A,R7
0007 7003              JNZ     $ + 5H
0009 020000      R     LJMP    ?C0026
000C E500        R     MOV     A,package_count
000E C3                CLR     C
000F 9406              SUBB    A,#06H
0011 4003              JC      $ + 5H
0013 020000      R     LJMP    ?C0026
                                           ; SOURCE LINE # 133
0016 120000      E     LCALL   UART_RS485_GetChar
0019 8F00        R     MOV     rx_data,R7
                                           ; SOURCE LINE # 135
001B E500        R     MOV     A,state
001D 14                DEC     A
001E 6049              JZ      ?C0010
0020 14                DEC     A
0021 6060              JZ      ?C0014
0023 14                DEC     A
0024 7003              JNZ     $ + 5H
0026 020000      R     LJMP    ?C0021
0029 14                DEC     A
002A 7003              JNZ     $ + 5H
002C 020000      R     LJMP    ?C0024
002F 2404              ADD     A,#04H
0031 70D0              JNZ     ?C0003
                                           ; SOURCE LINE # 137
0033         ?C0006:
                                           ; SOURCE LINE # 139
0033 850000      R     MOV     rx_queue,rx_queue+01H
                                           ; SOURCE LINE # 140
0036 850000      R     MOV     rx_queue+01H,rx_queue+02H
                                           ; SOURCE LINE # 141
0039 850000      R     MOV     rx_queue+02H,rx_data
                                           ; SOURCE LINE # 144
003C E500        R     MOV     A,rx_queue+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 22  

003E B43A11            CJNE    A,#03AH,?C0007
0041 E500        R     MOV     A,rx_queue+02H
0043 B43A0C            CJNE    A,#03AH,?C0007
                                           ; SOURCE LINE # 145
0046 E4                CLR     A
0047 F500        R     MOV     rx_queue,A
                                           ; SOURCE LINE # 146
0049 F500        R     MOV     rx_queue+01H,A
                                           ; SOURCE LINE # 147
004B F500        R     MOV     rx_queue+02H,A
                                           ; SOURCE LINE # 148
004D 750001      R     MOV     state,#01H
                                           ; SOURCE LINE # 149
0050 80B1              SJMP    ?C0003
0052         ?C0007:
                                           ; SOURCE LINE # 150
0052 E500        R     MOV     A,rx_queue
0054 B43FAC            CJNE    A,#03FH,?C0003
0057 E500        R     MOV     A,rx_queue+01H
0059 B40DA7            CJNE    A,#0DH,?C0003
005C E500        R     MOV     A,rx_queue+02H
005E 640A              XRL     A,#0AH
0060 70A1              JNZ     ?C0003
                                           ; SOURCE LINE # 153
0062 FF                MOV     R7,A
0063 FE                MOV     R6,A
0064 120000      E     LCALL   _infoGet
                                           ; SOURCE LINE # 154
0067 809A              SJMP    ?C0003
                                           ; SOURCE LINE # 157
0069         ?C0010:
                                           ; SOURCE LINE # 160
0069 900000      E     MOV     DPTR,#c_mem+01H
006C E0                MOVX    A,@DPTR
006D 6500        R     XRL     A,rx_data
006F 6004              JZ      ?C0012
0071 E500        R     MOV     A,rx_data
0073 7004              JNZ     ?C0011
0075         ?C0012:
                                           ; SOURCE LINE # 161
0075 C200        R     CLR     rx_data_type
0077 8002              SJMP    ?C0013
0079         ?C0011:
                                           ; SOURCE LINE # 163
0079 D200        R     SETB    rx_data_type
007B         ?C0013:
                                           ; SOURCE LINE # 165
007B E4                CLR     A
007C F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 166
007E 750002      R     MOV     state,#02H
                                           ; SOURCE LINE # 167
0081 8080              SJMP    ?C0003
                                           ; SOURCE LINE # 170
0083         ?C0014:
                                           ; SOURCE LINE # 173
0083 850000      R     MOV     data_packet_length,rx_data
                                           ; SOURCE LINE # 175
0086 E500        R     MOV     A,data_packet_length
0088 D3                SETB    C
0089 9401              SUBB    A,#01H
008B 5008              JNC     ?C0015
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 23  

                                           ; SOURCE LINE # 176
008D E4                CLR     A
008E F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 177
0090 F500        R     MOV     state,A
                                           ; SOURCE LINE # 178
0092 020000      R     LJMP    ?C0003
0095         ?C0015:
0095 E500        R     MOV     A,data_packet_length
0097 D3                SETB    C
0098 9480              SUBB    A,#080H
009A 4008              JC      ?C0017
                                           ; SOURCE LINE # 179
009C E4                CLR     A
009D F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 180
009F F500        R     MOV     state,A
                                           ; SOURCE LINE # 181
00A1 020000      R     LJMP    ?C0003
00A4         ?C0017:
                                           ; SOURCE LINE # 182
00A4 E4                CLR     A
00A5 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 184
00A7 200006            JB      rx_data_type,?C0019
                                           ; SOURCE LINE # 185
00AA 750003      R     MOV     state,#03H
00AD 020000      R     LJMP    ?C0003
00B0         ?C0019:
                                           ; SOURCE LINE # 187
00B0 750004      R     MOV     state,#04H
                                           ; SOURCE LINE # 188
                                           ; SOURCE LINE # 189
00B3 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 192
00B6         ?C0021:
                                           ; SOURCE LINE # 194
00B6 7400        R     MOV     A,#LOW data_packet_buffer
00B8 2500        R     ADD     A,data_packet_index
00BA F582              MOV     DPL,A
00BC E4                CLR     A
00BD 3400        R     ADDC    A,#HIGH data_packet_buffer
00BF F583              MOV     DPH,A
00C1 E500        R     MOV     A,rx_data
00C3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 195
00C4 0500        R     INC     data_packet_index
                                           ; SOURCE LINE # 198
00C6 E500        R     MOV     A,data_packet_index
00C8 C3                CLR     C
00C9 9500        R     SUBB    A,data_packet_length
00CB 5003              JNC     $ + 5H
00CD 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 200
00D0 200025            JB      rx_data_type,?C0023
                                           ; SOURCE LINE # 202
00D3 AF00        R     MOV     R7,data_packet_length
00D5 7E00              MOV     R6,#00H
00D7 7800        E     MOV     R0,#LOW g_rx
00D9 7C00        E     MOV     R4,#HIGH g_rx
00DB 7D01              MOV     R5,#01H
00DD 7B01              MOV     R3,#01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 24  

00DF 7A00        R     MOV     R2,#HIGH data_packet_buffer
00E1 7900        R     MOV     R1,#LOW data_packet_buffer
00E3 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 203
00E6 900000      E     MOV     DPTR,#g_rx+080H
00E9 E4                CLR     A
00EA F0                MOVX    @DPTR,A
00EB A3                INC     DPTR
00EC E500        R     MOV     A,data_packet_length
00EE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 204
00EF 900000      E     MOV     DPTR,#g_rx+084H
00F2 7401              MOV     A,#01H
00F4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 205
00F5 120000      E     LCALL   commProcess
                                           ; SOURCE LINE # 206
00F8         ?C0023:
                                           ; SOURCE LINE # 208
00F8 E4                CLR     A
00F9 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 209
00FB F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 210
00FD F500        R     MOV     state,A
                                           ; SOURCE LINE # 211
00FF 0500        R     INC     package_count
                                           ; SOURCE LINE # 213
                                           ; SOURCE LINE # 214
0101 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 217
0104         ?C0024:
                                           ; SOURCE LINE # 218
0104 1500        R     DEC     data_packet_length
0106 E500        R     MOV     A,data_packet_length
0108 6003              JZ      $ + 5H
010A 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 219
010D F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 220
010F F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 221
0111 7F01              MOV     R7,#01H
0113 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 222
0116 E4                CLR     A
0117 FF                MOV     R7,A
0118 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 223
011B E4                CLR     A
011C F500        R     MOV     state,A
                                           ; SOURCE LINE # 224
011E 0500        R     INC     package_count
                                           ; SOURCE LINE # 225
                                           ; SOURCE LINE # 226
0120 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 227
                                           ; SOURCE LINE # 228
0123 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 229
0126         ?C0026:
0126 22                RET     
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 25  

             ; FUNCTION interrupt_manager (END)

             ; FUNCTION function_scheduler (BEGIN)
                                           ; SOURCE LINE # 238
                                           ; SOURCE LINE # 242
0000 120000      E     LCALL   MY_TIMER_ReadCounter
0003 900000      E     MOV     DPTR,#timer_value0
0006 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 246
0009 7F01              MOV     R7,#01H
000B 120000      E     LCALL   _ADC_SOC_Write
                                           ; SOURCE LINE # 250
000E 300005            JNB     interrupt_flag,?C0027
                                           ; SOURCE LINE # 251
0011 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 252
0013 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 253
0016         ?C0027:
                                           ; SOURCE LINE # 257
0016 E4                CLR     A
0017 FF                MOV     R7,A
0018 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 261
001B 300005            JNB     interrupt_flag,?C0028
                                           ; SOURCE LINE # 262
001E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 263
0020 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 264
0023         ?C0028:
                                           ; SOURCE LINE # 266
0023 7F01              MOV     R7,#01H
0025 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 270
0028 300005            JNB     interrupt_flag,?C0029
                                           ; SOURCE LINE # 271
002B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 272
002D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 273
0030         ?C0029:
                                           ; SOURCE LINE # 275
0030 7F02              MOV     R7,#02H
0032 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 279
0035 300005            JNB     interrupt_flag,?C0030
                                           ; SOURCE LINE # 280
0038 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 281
003A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 282
003D         ?C0030:
                                           ; SOURCE LINE # 286
003D 120000      R     LCALL   motor_control
                                           ; SOURCE LINE # 290
0040 300005            JNB     interrupt_flag,?C0031
                                           ; SOURCE LINE # 291
0043 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 292
0045 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 293
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 26  

0048         ?C0031:
                                           ; SOURCE LINE # 297
0048 120000      R     LCALL   overcurrent_control
                                           ; SOURCE LINE # 301
004B 300005            JNB     interrupt_flag,?C0032
                                           ; SOURCE LINE # 302
004E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 303
0050 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 304
0053         ?C0032:
                                           ; SOURCE LINE # 308
0053 120000      R     LCALL   analog_read_end
                                           ; SOURCE LINE # 313
0056 900000      E     MOV     DPTR,#calib
0059 E0                MOVX    A,@DPTR
005A B40124            CJNE    A,#01H,?C0033
                                           ; SOURCE LINE # 314
005D 900000      R     MOV     DPTR,#counter_calibration
0060 E0                MOVX    A,@DPTR
0061 7004              JNZ     ?C0212
0063 A3                INC     DPTR
0064 E0                MOVX    A,@DPTR
0065 640A              XRL     A,#0AH
0067         ?C0212:
0067 700A              JNZ     ?C0034
                                           ; SOURCE LINE # 315
0069 120000      E     LCALL   calibration
                                           ; SOURCE LINE # 316
006C E4                CLR     A
006D 900000      R     MOV     DPTR,#counter_calibration
0070 F0                MOVX    @DPTR,A
0071 A3                INC     DPTR
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 317
0073         ?C0034:
                                           ; SOURCE LINE # 318
0073 900000      R     MOV     DPTR,#counter_calibration+01H
0076 E0                MOVX    A,@DPTR
0077 04                INC     A
0078 F0                MOVX    @DPTR,A
0079 7006              JNZ     ?C0213
007B 900000      R     MOV     DPTR,#counter_calibration
007E E0                MOVX    A,@DPTR
007F 04                INC     A
0080 F0                MOVX    @DPTR,A
0081         ?C0213:
                                           ; SOURCE LINE # 319
0081         ?C0033:
                                           ; SOURCE LINE # 323
0081 300005            JNB     interrupt_flag,?C0035
                                           ; SOURCE LINE # 324
0084 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 325
0086 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 326
0089         ?C0035:
                                           ; SOURCE LINE # 331
0089 7800        E     MOV     R0,#LOW g_measOld
008B 7C00        E     MOV     R4,#HIGH g_measOld
008D 7D01              MOV     R5,#01H
008F 7B01              MOV     R3,#01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 27  

0091 7A00        E     MOV     R2,#HIGH g_meas
0093 7900        E     MOV     R1,#LOW g_meas
0095 7E00              MOV     R6,#00H
0097 7F33              MOV     R7,#033H
0099 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 332
009C 7800        E     MOV     R0,#LOW g_refOld
009E 7C00        E     MOV     R4,#HIGH g_refOld
00A0 7D01              MOV     R5,#01H
00A2 7B01              MOV     R3,#01H
00A4 7A00        E     MOV     R2,#HIGH g_ref
00A6 7900        E     MOV     R1,#LOW g_ref
00A8 7E00              MOV     R6,#00H
00AA 7F19              MOV     R7,#019H
00AC 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 335
00AF 7800        E     MOV     R0,#LOW g_ref
00B1 7C00        E     MOV     R4,#HIGH g_ref
00B3 7D01              MOV     R5,#01H
00B5 7B01              MOV     R3,#01H
00B7 7A00        E     MOV     R2,#HIGH g_refNew
00B9 7900        E     MOV     R1,#LOW g_refNew
00BB 7E00              MOV     R6,#00H
00BD 7F19              MOV     R7,#019H
00BF 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 337
00C2 300005            JNB     interrupt_flag,?C0036
                                           ; SOURCE LINE # 338
00C5 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 339
00C7 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 340
00CA         ?C0036:
                                           ; SOURCE LINE # 342
00CA 120000      E     LCALL   MY_TIMER_ReadCounter
00CD 900000      E     MOV     DPTR,#timer_value
00D0 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 343
00D3 7F40              MOV     R7,#040H
00D5 7E4B              MOV     R6,#04BH
00D7 7D4C              MOV     R5,#04CH
00D9 7C00              MOV     R4,#00H
00DB 120000      E     LCALL   _MY_TIMER_WriteCounter
                                           ; SOURCE LINE # 345
00DE 22                RET     
             ; FUNCTION function_scheduler (END)

             ; FUNCTION motor_control (BEGIN)
                                           ; SOURCE LINE # 351
                                           ; SOURCE LINE # 353
0000 E4                CLR     A
0001 F500        R     MOV     pwm_input+03H,A
0003 F500        R     MOV     pwm_input+02H,A
0005 F500        R     MOV     pwm_input+01H,A
0007 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 364
0009 900000      E     MOV     DPTR,#c_mem+02H
000C E0                MOVX    A,@DPTR
000D FC                MOV     R4,A
000E A3                INC     DPTR
000F E0                MOVX    A,@DPTR
0010 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 28  

0011 A3                INC     DPTR
0012 E0                MOVX    A,@DPTR
0013 FE                MOV     R6,A
0014 A3                INC     DPTR
0015 E0                MOVX    A,@DPTR
0016 F500        R     MOV     k_p+03H,A
0018 8E00        R     MOV     k_p+02H,R6
001A 8D00        R     MOV     k_p+01H,R5
001C 8C00        R     MOV     k_p,R4
                                           ; SOURCE LINE # 365
001E A3                INC     DPTR
001F E0                MOVX    A,@DPTR
0020 FC                MOV     R4,A
0021 A3                INC     DPTR
0022 E0                MOVX    A,@DPTR
0023 FD                MOV     R5,A
0024 A3                INC     DPTR
0025 E0                MOVX    A,@DPTR
0026 FE                MOV     R6,A
0027 A3                INC     DPTR
0028 E0                MOVX    A,@DPTR
0029 F500        R     MOV     k_i+03H,A
002B 8E00        R     MOV     k_i+02H,R6
002D 8D00        R     MOV     k_i+01H,R5
002F 8C00        R     MOV     k_i,R4
                                           ; SOURCE LINE # 366
0031 A3                INC     DPTR
0032 E0                MOVX    A,@DPTR
0033 FC                MOV     R4,A
0034 A3                INC     DPTR
0035 E0                MOVX    A,@DPTR
0036 FD                MOV     R5,A
0037 A3                INC     DPTR
0038 E0                MOVX    A,@DPTR
0039 FE                MOV     R6,A
003A A3                INC     DPTR
003B E0                MOVX    A,@DPTR
003C F500        R     MOV     k_d+03H,A
003E 8E00        R     MOV     k_d+02H,R6
0040 8D00        R     MOV     k_d+01H,R5
0042 8C00        R     MOV     k_d,R4
                                           ; SOURCE LINE # 368
0044 A3                INC     DPTR
0045 E0                MOVX    A,@DPTR
0046 FC                MOV     R4,A
0047 A3                INC     DPTR
0048 E0                MOVX    A,@DPTR
0049 FD                MOV     R5,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C FE                MOV     R6,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F F500        R     MOV     k_p_c+03H,A
0051 8E00        R     MOV     k_p_c+02H,R6
0053 8D00        R     MOV     k_p_c+01H,R5
0055 8C00        R     MOV     k_p_c,R4
                                           ; SOURCE LINE # 369
0057 A3                INC     DPTR
0058 E0                MOVX    A,@DPTR
0059 FC                MOV     R4,A
005A A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 29  

005B E0                MOVX    A,@DPTR
005C FD                MOV     R5,A
005D A3                INC     DPTR
005E E0                MOVX    A,@DPTR
005F FE                MOV     R6,A
0060 A3                INC     DPTR
0061 E0                MOVX    A,@DPTR
0062 F500        R     MOV     k_i_c+03H,A
0064 8E00        R     MOV     k_i_c+02H,R6
0066 8D00        R     MOV     k_i_c+01H,R5
0068 8C00        R     MOV     k_i_c,R4
                                           ; SOURCE LINE # 370
006A A3                INC     DPTR
006B E0                MOVX    A,@DPTR
006C FC                MOV     R4,A
006D A3                INC     DPTR
006E E0                MOVX    A,@DPTR
006F FD                MOV     R5,A
0070 A3                INC     DPTR
0071 E0                MOVX    A,@DPTR
0072 FE                MOV     R6,A
0073 A3                INC     DPTR
0074 E0                MOVX    A,@DPTR
0075 F500        R     MOV     k_d_c+03H,A
0077 8E00        R     MOV     k_d_c+02H,R6
0079 8D00        R     MOV     k_d_c+01H,R5
007B 8C00        R     MOV     k_d_c,R4
                                           ; SOURCE LINE # 372
007D A3                INC     DPTR
007E E0                MOVX    A,@DPTR
007F FC                MOV     R4,A
0080 A3                INC     DPTR
0081 E0                MOVX    A,@DPTR
0082 FD                MOV     R5,A
0083 A3                INC     DPTR
0084 E0                MOVX    A,@DPTR
0085 FE                MOV     R6,A
0086 A3                INC     DPTR
0087 E0                MOVX    A,@DPTR
0088 F500        R     MOV     k_p_dl+03H,A
008A 8E00        R     MOV     k_p_dl+02H,R6
008C 8D00        R     MOV     k_p_dl+01H,R5
008E 8C00        R     MOV     k_p_dl,R4
                                           ; SOURCE LINE # 373
0090 A3                INC     DPTR
0091 E0                MOVX    A,@DPTR
0092 FC                MOV     R4,A
0093 A3                INC     DPTR
0094 E0                MOVX    A,@DPTR
0095 FD                MOV     R5,A
0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 FE                MOV     R6,A
0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B F500        R     MOV     k_i_dl+03H,A
009D 8E00        R     MOV     k_i_dl+02H,R6
009F 8D00        R     MOV     k_i_dl+01H,R5
00A1 8C00        R     MOV     k_i_dl,R4
                                           ; SOURCE LINE # 374
00A3 A3                INC     DPTR
00A4 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 30  

00A5 FC                MOV     R4,A
00A6 A3                INC     DPTR
00A7 E0                MOVX    A,@DPTR
00A8 FD                MOV     R5,A
00A9 A3                INC     DPTR
00AA E0                MOVX    A,@DPTR
00AB FE                MOV     R6,A
00AC A3                INC     DPTR
00AD E0                MOVX    A,@DPTR
00AE F500        R     MOV     k_d_dl+03H,A
00B0 8E00        R     MOV     k_d_dl+02H,R6
00B2 8D00        R     MOV     k_d_dl+01H,R5
00B4 8C00        R     MOV     k_d_dl,R4
                                           ; SOURCE LINE # 376
00B6 A3                INC     DPTR
00B7 E0                MOVX    A,@DPTR
00B8 FC                MOV     R4,A
00B9 A3                INC     DPTR
00BA E0                MOVX    A,@DPTR
00BB FD                MOV     R5,A
00BC A3                INC     DPTR
00BD E0                MOVX    A,@DPTR
00BE FE                MOV     R6,A
00BF A3                INC     DPTR
00C0 E0                MOVX    A,@DPTR
00C1 F500        R     MOV     k_p_c_dl+03H,A
00C3 8E00        R     MOV     k_p_c_dl+02H,R6
00C5 8D00        R     MOV     k_p_c_dl+01H,R5
00C7 8C00        R     MOV     k_p_c_dl,R4
                                           ; SOURCE LINE # 377
00C9 A3                INC     DPTR
00CA E0                MOVX    A,@DPTR
00CB FC                MOV     R4,A
00CC A3                INC     DPTR
00CD E0                MOVX    A,@DPTR
00CE FD                MOV     R5,A
00CF A3                INC     DPTR
00D0 E0                MOVX    A,@DPTR
00D1 FE                MOV     R6,A
00D2 A3                INC     DPTR
00D3 E0                MOVX    A,@DPTR
00D4 F500        R     MOV     k_i_c_dl+03H,A
00D6 8E00        R     MOV     k_i_c_dl+02H,R6
00D8 8D00        R     MOV     k_i_c_dl+01H,R5
00DA 8C00        R     MOV     k_i_c_dl,R4
                                           ; SOURCE LINE # 378
00DC A3                INC     DPTR
00DD E0                MOVX    A,@DPTR
00DE FC                MOV     R4,A
00DF A3                INC     DPTR
00E0 E0                MOVX    A,@DPTR
00E1 FD                MOV     R5,A
00E2 A3                INC     DPTR
00E3 E0                MOVX    A,@DPTR
00E4 FE                MOV     R6,A
00E5 A3                INC     DPTR
00E6 E0                MOVX    A,@DPTR
00E7 F500        R     MOV     k_d_c_dl+03H,A
00E9 8E00        R     MOV     k_d_c_dl+02H,R6
00EB 8D00        R     MOV     k_d_c_dl+01H,R5
00ED 8C00        R     MOV     k_d_c_dl,R4
                                           ; SOURCE LINE # 391
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 31  

00EF 900000      E     MOV     DPTR,#c_mem+033H
00F2 E0                MOVX    A,@DPTR
00F3 24FE              ADD     A,#0FEH
00F5 7003              JNZ     $ + 5H
00F7 020000      R     LJMP    ?C0046
00FA 04                INC     A
00FB 6003              JZ      $ + 5H
00FD 020000      R     LJMP    ?C0038
                                           ; SOURCE LINE # 393
0100         ?C0039:
                                           ; SOURCE LINE # 397
0100 900000      E     MOV     DPTR,#c_mem+06BH
0103 E0                MOVX    A,@DPTR
0104 6024              JZ      ?C0040
                                           ; SOURCE LINE # 398
0106 A3                INC     DPTR
0107 E0                MOVX    A,@DPTR
0108 FF                MOV     R7,A
0109 33                RLC     A
010A 95E0              SUBB    A,ACC
010C FE                MOV     R6,A
010D FD                MOV     R5,A
010E FC                MOV     R4,A
010F 900000      E     MOV     DPTR,#g_meas+08H
0112 E0                MOVX    A,@DPTR
0113 F8                MOV     R0,A
0114 A3                INC     DPTR
0115 E0                MOVX    A,@DPTR
0116 F9                MOV     R1,A
0117 A3                INC     DPTR
0118 E0                MOVX    A,@DPTR
0119 FA                MOV     R2,A
011A A3                INC     DPTR
011B E0                MOVX    A,@DPTR
011C FB                MOV     R3,A
011D 120000      E     LCALL   ?C?LMUL
0120 8F00        R     MOV     handle_value+03H,R7
0122 8E00        R     MOV     handle_value+02H,R6
0124 8D00        R     MOV     handle_value+01H,R5
0126 8C00        R     MOV     handle_value,R4
0128 8024              SJMP    ?C0041
012A         ?C0040:
                                           ; SOURCE LINE # 400
012A 900000      E     MOV     DPTR,#c_mem+06CH
012D E0                MOVX    A,@DPTR
012E FF                MOV     R7,A
012F 33                RLC     A
0130 95E0              SUBB    A,ACC
0132 FE                MOV     R6,A
0133 FD                MOV     R5,A
0134 FC                MOV     R4,A
0135 900000      E     MOV     DPTR,#g_meas+04H
0138 E0                MOVX    A,@DPTR
0139 F8                MOV     R0,A
013A A3                INC     DPTR
013B E0                MOVX    A,@DPTR
013C F9                MOV     R1,A
013D A3                INC     DPTR
013E E0                MOVX    A,@DPTR
013F FA                MOV     R2,A
0140 A3                INC     DPTR
0141 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 32  

0142 FB                MOV     R3,A
0143 120000      E     LCALL   ?C?LMUL
0146 8F00        R     MOV     handle_value+03H,R7
0148 8E00        R     MOV     handle_value+02H,R6
014A 8D00        R     MOV     handle_value+01H,R5
014C 8C00        R     MOV     handle_value,R4
014E         ?C0041:
                                           ; SOURCE LINE # 404
014E 900000      E     MOV     DPTR,#g_ref
0151 E0                MOVX    A,@DPTR
0152 F8                MOV     R0,A
0153 A3                INC     DPTR
0154 E0                MOVX    A,@DPTR
0155 F9                MOV     R1,A
0156 A3                INC     DPTR
0157 E0                MOVX    A,@DPTR
0158 FA                MOV     R2,A
0159 A3                INC     DPTR
015A E0                MOVX    A,@DPTR
015B FB                MOV     R3,A
015C C3                CLR     C
015D E500        R     MOV     A,handle_value+03H
015F 9B                SUBB    A,R3
0160 FF                MOV     R7,A
0161 E500        R     MOV     A,handle_value+02H
0163 9A                SUBB    A,R2
0164 FE                MOV     R6,A
0165 E500        R     MOV     A,handle_value+01H
0167 99                SUBB    A,R1
0168 FD                MOV     R5,A
0169 E500        R     MOV     A,handle_value
016B 98                SUBB    A,R0
016C FC                MOV     R4,A
016D 900000      E     MOV     DPTR,#c_mem+061H
0170 E0                MOVX    A,@DPTR
0171 F8                MOV     R0,A
0172 A3                INC     DPTR
0173 E0                MOVX    A,@DPTR
0174 F9                MOV     R1,A
0175 A3                INC     DPTR
0176 E0                MOVX    A,@DPTR
0177 FA                MOV     R2,A
0178 A3                INC     DPTR
0179 E0                MOVX    A,@DPTR
017A FB                MOV     R3,A
017B C3                CLR     C
017C 120000      E     LCALL   ?C?SLCMP
017F 5044              JNC     ?C0042
0181 E4                CLR     A
0182 FF                MOV     R7,A
0183 FE                MOV     R6,A
0184 FD                MOV     R5,A
0185 FC                MOV     R4,A
0186 900000      E     MOV     DPTR,#c_mem+061H
0189 E0                MOVX    A,@DPTR
018A F8                MOV     R0,A
018B A3                INC     DPTR
018C E0                MOVX    A,@DPTR
018D A3                INC     DPTR
018E E0                MOVX    A,@DPTR
018F A3                INC     DPTR
0190 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 33  

0191 C3                CLR     C
0192 120000      E     LCALL   ?C?SLCMP
0195 602E              JZ      ?C0042
                                           ; SOURCE LINE # 405
0197 900000      E     MOV     DPTR,#g_ref
019A E0                MOVX    A,@DPTR
019B FC                MOV     R4,A
019C A3                INC     DPTR
019D E0                MOVX    A,@DPTR
019E FD                MOV     R5,A
019F A3                INC     DPTR
01A0 E0                MOVX    A,@DPTR
01A1 FE                MOV     R6,A
01A2 A3                INC     DPTR
01A3 E0                MOVX    A,@DPTR
01A4 FF                MOV     R7,A
01A5 900000      E     MOV     DPTR,#c_mem+061H
01A8 E0                MOVX    A,@DPTR
01A9 F8                MOV     R0,A
01AA A3                INC     DPTR
01AB E0                MOVX    A,@DPTR
01AC A3                INC     DPTR
01AD E0                MOVX    A,@DPTR
01AE A3                INC     DPTR
01AF E0                MOVX    A,@DPTR
01B0 EF                MOV     A,R7
01B1 2B                ADD     A,R3
01B2 FF                MOV     R7,A
01B3 EE                MOV     A,R6
01B4 3A                ADDC    A,R2
01B5 FE                MOV     R6,A
01B6 ED                MOV     A,R5
01B7 39                ADDC    A,R1
01B8 FD                MOV     R5,A
01B9 EC                MOV     A,R4
01BA 38                ADDC    A,R0
01BB FC                MOV     R4,A
01BC 900000      E     MOV     DPTR,#g_ref
01BF 120000      E     LCALL   ?C?LSTXDATA
01C2 020000      R     LJMP    ?C0038
01C5         ?C0042:
                                           ; SOURCE LINE # 406
                                           ; SOURCE LINE # 407
01C5 900000      E     MOV     DPTR,#g_ref
01C8 E0                MOVX    A,@DPTR
01C9 F8                MOV     R0,A
01CA A3                INC     DPTR
01CB E0                MOVX    A,@DPTR
01CC F9                MOV     R1,A
01CD A3                INC     DPTR
01CE E0                MOVX    A,@DPTR
01CF FA                MOV     R2,A
01D0 A3                INC     DPTR
01D1 E0                MOVX    A,@DPTR
01D2 FB                MOV     R3,A
01D3 C3                CLR     C
01D4 E500        R     MOV     A,handle_value+03H
01D6 9B                SUBB    A,R3
01D7 FF                MOV     R7,A
01D8 E500        R     MOV     A,handle_value+02H
01DA 9A                SUBB    A,R2
01DB FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 34  

01DC E500        R     MOV     A,handle_value+01H
01DE 99                SUBB    A,R1
01DF FD                MOV     R5,A
01E0 E500        R     MOV     A,handle_value
01E2 98                SUBB    A,R0
01E3 FC                MOV     R4,A
01E4 900000      E     MOV     DPTR,#c_mem+065H
01E7 E0                MOVX    A,@DPTR
01E8 F8                MOV     R0,A
01E9 A3                INC     DPTR
01EA E0                MOVX    A,@DPTR
01EB F9                MOV     R1,A
01EC A3                INC     DPTR
01ED E0                MOVX    A,@DPTR
01EE FA                MOV     R2,A
01EF A3                INC     DPTR
01F0 E0                MOVX    A,@DPTR
01F1 FB                MOV     R3,A
01F2 D3                SETB    C
01F3 120000      E     LCALL   ?C?SLCMP
01F6 4043              JC      ?C0044
01F8 E4                CLR     A
01F9 FF                MOV     R7,A
01FA FE                MOV     R6,A
01FB FD                MOV     R5,A
01FC FC                MOV     R4,A
01FD 900000      E     MOV     DPTR,#c_mem+065H
0200 E0                MOVX    A,@DPTR
0201 F8                MOV     R0,A
0202 A3                INC     DPTR
0203 E0                MOVX    A,@DPTR
0204 A3                INC     DPTR
0205 E0                MOVX    A,@DPTR
0206 A3                INC     DPTR
0207 E0                MOVX    A,@DPTR
0208 120000      E     LCALL   ?C?SLCMP
020B 602E              JZ      ?C0044
                                           ; SOURCE LINE # 408
020D 900000      E     MOV     DPTR,#g_ref
0210 E0                MOVX    A,@DPTR
0211 FC                MOV     R4,A
0212 A3                INC     DPTR
0213 E0                MOVX    A,@DPTR
0214 FD                MOV     R5,A
0215 A3                INC     DPTR
0216 E0                MOVX    A,@DPTR
0217 FE                MOV     R6,A
0218 A3                INC     DPTR
0219 E0                MOVX    A,@DPTR
021A FF                MOV     R7,A
021B 900000      E     MOV     DPTR,#c_mem+065H
021E E0                MOVX    A,@DPTR
021F F8                MOV     R0,A
0220 A3                INC     DPTR
0221 E0                MOVX    A,@DPTR
0222 A3                INC     DPTR
0223 E0                MOVX    A,@DPTR
0224 A3                INC     DPTR
0225 E0                MOVX    A,@DPTR
0226 EF                MOV     A,R7
0227 2B                ADD     A,R3
0228 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 35  

0229 EE                MOV     A,R6
022A 3A                ADDC    A,R2
022B FE                MOV     R6,A
022C ED                MOV     A,R5
022D 39                ADDC    A,R1
022E FD                MOV     R5,A
022F EC                MOV     A,R4
0230 38                ADDC    A,R0
0231 FC                MOV     R4,A
0232 900000      E     MOV     DPTR,#g_ref
0235 120000      E     LCALL   ?C?LSTXDATA
0238 020000      R     LJMP    ?C0038
023B         ?C0044:
                                           ; SOURCE LINE # 410
023B AF00        R     MOV     R7,handle_value+03H
023D AE00        R     MOV     R6,handle_value+02H
023F AD00        R     MOV     R5,handle_value+01H
0241 AC00        R     MOV     R4,handle_value
0243 900000      E     MOV     DPTR,#g_ref
0246 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 411
                                           ; SOURCE LINE # 412
0249 020000      R     LJMP    ?C0038
                                           ; SOURCE LINE # 414
024C         ?C0046:
                                           ; SOURCE LINE # 415
024C 900000      E     MOV     DPTR,#c_mem+034H
024F E0                MOVX    A,@DPTR
0250 14                DEC     A
0251 7003              JNZ     $ + 5H
0253 020000      R     LJMP    ?C0068
0256 04                INC     A
0257 6003              JZ      $ + 5H
0259 020000      R     LJMP    ?C0038
                                           ; SOURCE LINE # 417
025C         ?C0048:
                                           ; SOURCE LINE # 418
025C E4                CLR     A
025D F500        R     MOV     err_joy_1+03H,A
025F F500        R     MOV     err_joy_1+02H,A
0261 F500        R     MOV     err_joy_1+01H,A
0263 F500        R     MOV     err_joy_1,A
                                           ; SOURCE LINE # 419
0265 F500        R     MOV     err_joy_2+03H,A
0267 F500        R     MOV     err_joy_2+02H,A
0269 F500        R     MOV     err_joy_2+01H,A
026B F500        R     MOV     err_joy_2,A
                                           ; SOURCE LINE # 420
026D D3                SETB    C
026E 900000      E     MOV     DPTR,#g_meas+030H
0271 E0                MOVX    A,@DPTR
0272 9484              SUBB    A,#084H
0274 900000      E     MOV     DPTR,#g_meas+02FH
0277 E0                MOVX    A,@DPTR
0278 6480              XRL     A,#080H
027A 9483              SUBB    A,#083H
027C 4003              JC      ?C0050
027E D3                SETB    C
027F 8001              SJMP    ?C0051
0281         ?C0050:
0281 C3                CLR     C
0282         ?C0051:
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 36  

0282 5003              JNC     $ + 5H
0284 020000      R     LJMP    ?C0049
                                           ; SOURCE LINE # 421
0287 900000      E     MOV     DPTR,#g_mem+08AH
028A E0                MOVX    A,@DPTR
028B FA                MOV     R2,A
028C A3                INC     DPTR
028D E0                MOVX    A,@DPTR
028E FB                MOV     R3,A
028F 900000      E     MOV     DPTR,#g_meas+030H
0292 E0                MOVX    A,@DPTR
0293 9B                SUBB    A,R3
0294 FF                MOV     R7,A
0295 900000      E     MOV     DPTR,#g_meas+02FH
0298 E0                MOVX    A,@DPTR
0299 9A                SUBB    A,R2
029A FE                MOV     R6,A
029B 33                RLC     A
029C 95E0              SUBB    A,ACC
029E 8F00        R     MOV     err_joy_1+03H,R7
02A0 8E00        R     MOV     err_joy_1+02H,R6
02A2 F500        R     MOV     err_joy_1+01H,A
02A4 F500        R     MOV     err_joy_1,A
                                           ; SOURCE LINE # 424
02A6 D3                SETB    C
02A7 A3                INC     DPTR
02A8 E0                MOVX    A,@DPTR
02A9 9B                SUBB    A,R3
02AA EA                MOV     A,R2
02AB 6480              XRL     A,#080H
02AD F8                MOV     R0,A
02AE 900000      E     MOV     DPTR,#g_meas+02FH
02B1 E0                MOVX    A,@DPTR
02B2 6480              XRL     A,#080H
02B4 98                SUBB    A,R0
02B5 5003              JNC     $ + 5H
02B7 020000      R     LJMP    ?C0052
                                           ; SOURCE LINE # 425
02BA 900000      E     MOV     DPTR,#g_ref
02BD E0                MOVX    A,@DPTR
02BE F8                MOV     R0,A
02BF A3                INC     DPTR
02C0 E0                MOVX    A,@DPTR
02C1 F9                MOV     R1,A
02C2 A3                INC     DPTR
02C3 E0                MOVX    A,@DPTR
02C4 FA                MOV     R2,A
02C5 A3                INC     DPTR
02C6 E0                MOVX    A,@DPTR
02C7 FB                MOV     R3,A
02C8 C000              PUSH    AR0
02CA C001              PUSH    AR1
02CC C002              PUSH    AR2
02CE C003              PUSH    AR3
02D0 900000      E     MOV     DPTR,#g_mem+088H
02D3 E0                MOVX    A,@DPTR
02D4 FE                MOV     R6,A
02D5 A3                INC     DPTR
02D6 E0                MOVX    A,@DPTR
02D7 FF                MOV     R7,A
02D8 E4                CLR     A
02D9 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 37  

02DA FD                MOV     R5,A
02DB AB00        R     MOV     R3,err_joy_1+03H
02DD AA00        R     MOV     R2,err_joy_1+02H
02DF A900        R     MOV     R1,err_joy_1+01H
02E1 A800        R     MOV     R0,err_joy_1
02E3 120000      E     LCALL   ?C?LMUL
02E6 C006              PUSH    AR6
02E8 C007              PUSH    AR7
02EA 900000      E     MOV     DPTR,#g_mem+08AH
02ED E0                MOVX    A,@DPTR
02EE FE                MOV     R6,A
02EF A3                INC     DPTR
02F0 E0                MOVX    A,@DPTR
02F1 FF                MOV     R7,A
02F2 C3                CLR     C
02F3 E4                CLR     A
02F4 9F                SUBB    A,R7
02F5 FF                MOV     R7,A
02F6 7404              MOV     A,#04H
02F8 9E                SUBB    A,R6
02F9 FE                MOV     R6,A
02FA AB07              MOV     R3,AR7
02FC FA                MOV     R2,A
02FD 33                RLC     A
02FE 95E0              SUBB    A,ACC
0300 F9                MOV     R1,A
0301 F8                MOV     R0,A
0302 D007              POP     AR7
0304 D006              POP     AR6
0306 120000      E     LCALL   ?C?SLDIV
0309 D003              POP     AR3
030B D002              POP     AR2
030D D001              POP     AR1
030F D000              POP     AR0
0311 EB                MOV     A,R3
0312 2F                ADD     A,R7
0313 FF                MOV     R7,A
0314 EA                MOV     A,R2
0315 3E                ADDC    A,R6
0316 FE                MOV     R6,A
0317 E9                MOV     A,R1
0318 3D                ADDC    A,R5
0319 FD                MOV     R5,A
031A E8                MOV     A,R0
031B 3C                ADDC    A,R4
031C FC                MOV     R4,A
031D 900000      E     MOV     DPTR,#g_ref
0320 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 426
0323 900000      E     MOV     DPTR,#g_ref+04H
0326 E0                MOVX    A,@DPTR
0327 F8                MOV     R0,A
0328 A3                INC     DPTR
0329 E0                MOVX    A,@DPTR
032A F9                MOV     R1,A
032B A3                INC     DPTR
032C E0                MOVX    A,@DPTR
032D FA                MOV     R2,A
032E A3                INC     DPTR
032F E0                MOVX    A,@DPTR
0330 FB                MOV     R3,A
0331 C000              PUSH    AR0
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 38  

0333 C001              PUSH    AR1
0335 C002              PUSH    AR2
0337 C003              PUSH    AR3
0339 900000      E     MOV     DPTR,#g_mem+088H
033C E0                MOVX    A,@DPTR
033D FE                MOV     R6,A
033E A3                INC     DPTR
033F E0                MOVX    A,@DPTR
0340 FF                MOV     R7,A
0341 E4                CLR     A
0342 FC                MOV     R4,A
0343 FD                MOV     R5,A
0344 AB00        R     MOV     R3,err_joy_1+03H
0346 AA00        R     MOV     R2,err_joy_1+02H
0348 A900        R     MOV     R1,err_joy_1+01H
034A A800        R     MOV     R0,err_joy_1
034C 120000      E     LCALL   ?C?LMUL
034F C006              PUSH    AR6
0351 C007              PUSH    AR7
0353 900000      E     MOV     DPTR,#g_mem+08AH
0356 E0                MOVX    A,@DPTR
0357 FE                MOV     R6,A
0358 A3                INC     DPTR
0359 E0                MOVX    A,@DPTR
035A FF                MOV     R7,A
035B C3                CLR     C
035C E4                CLR     A
035D 9F                SUBB    A,R7
035E FF                MOV     R7,A
035F 7404              MOV     A,#04H
0361 9E                SUBB    A,R6
0362 FE                MOV     R6,A
0363 AB07              MOV     R3,AR7
0365 FA                MOV     R2,A
0366 33                RLC     A
0367 95E0              SUBB    A,ACC
0369 F9                MOV     R1,A
036A F8                MOV     R0,A
036B D007              POP     AR7
036D D006              POP     AR6
036F 120000      E     LCALL   ?C?SLDIV
0372 D003              POP     AR3
0374 D002              POP     AR2
0376 D001              POP     AR1
0378 D000              POP     AR0
037A EB                MOV     A,R3
037B 2F                ADD     A,R7
037C FF                MOV     R7,A
037D EA                MOV     A,R2
037E 3E                ADDC    A,R6
037F FE                MOV     R6,A
0380 E9                MOV     A,R1
0381 3D                ADDC    A,R5
0382 FD                MOV     R5,A
0383 E8                MOV     A,R0
0384 3C                ADDC    A,R4
0385 FC                MOV     R4,A
0386 900000      E     MOV     DPTR,#g_ref+04H
0389 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 428
038C 020000      R     LJMP    ?C0053
038F         ?C0052:
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 39  

                                           ; SOURCE LINE # 429
                                           ; SOURCE LINE # 430
038F 900000      E     MOV     DPTR,#g_mem+08AH
0392 E0                MOVX    A,@DPTR
0393 FA                MOV     R2,A
0394 A3                INC     DPTR
0395 E0                MOVX    A,@DPTR
0396 FB                MOV     R3,A
0397 900000      E     MOV     DPTR,#g_meas+030H
039A E0                MOVX    A,@DPTR
039B 2B                ADD     A,R3
039C FF                MOV     R7,A
039D 900000      E     MOV     DPTR,#g_meas+02FH
03A0 E0                MOVX    A,@DPTR
03A1 3A                ADDC    A,R2
03A2 FE                MOV     R6,A
03A3 33                RLC     A
03A4 95E0              SUBB    A,ACC
03A6 8F00        R     MOV     err_joy_1+03H,R7
03A8 8E00        R     MOV     err_joy_1+02H,R6
03AA F500        R     MOV     err_joy_1+01H,A
03AC F500        R     MOV     err_joy_1,A
                                           ; SOURCE LINE # 432
03AE C3                CLR     C
03AF E4                CLR     A
03B0 9B                SUBB    A,R3
03B1 FF                MOV     R7,A
03B2 E4                CLR     A
03B3 9A                SUBB    A,R2
03B4 FE                MOV     R6,A
03B5 C3                CLR     C
03B6 A3                INC     DPTR
03B7 E0                MOVX    A,@DPTR
03B8 9F                SUBB    A,R7
03B9 EE                MOV     A,R6
03BA 6480              XRL     A,#080H
03BC F8                MOV     R0,A
03BD 900000      E     MOV     DPTR,#g_meas+02FH
03C0 E0                MOVX    A,@DPTR
03C1 6480              XRL     A,#080H
03C3 98                SUBB    A,R0
03C4 4003              JC      $ + 5H
03C6 020000      R     LJMP    ?C0053
                                           ; SOURCE LINE # 433
03C9 900000      E     MOV     DPTR,#g_ref
03CC E0                MOVX    A,@DPTR
03CD F8                MOV     R0,A
03CE A3                INC     DPTR
03CF E0                MOVX    A,@DPTR
03D0 F9                MOV     R1,A
03D1 A3                INC     DPTR
03D2 E0                MOVX    A,@DPTR
03D3 FA                MOV     R2,A
03D4 A3                INC     DPTR
03D5 E0                MOVX    A,@DPTR
03D6 FB                MOV     R3,A
03D7 C000              PUSH    AR0
03D9 C001              PUSH    AR1
03DB C002              PUSH    AR2
03DD C003              PUSH    AR3
03DF 900000      E     MOV     DPTR,#g_mem+088H
03E2 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 40  

03E3 FE                MOV     R6,A
03E4 A3                INC     DPTR
03E5 E0                MOVX    A,@DPTR
03E6 FF                MOV     R7,A
03E7 E4                CLR     A
03E8 FC                MOV     R4,A
03E9 FD                MOV     R5,A
03EA AB00        R     MOV     R3,err_joy_1+03H
03EC AA00        R     MOV     R2,err_joy_1+02H
03EE A900        R     MOV     R1,err_joy_1+01H
03F0 A800        R     MOV     R0,err_joy_1
03F2 120000      E     LCALL   ?C?LMUL
03F5 C006              PUSH    AR6
03F7 C007              PUSH    AR7
03F9 900000      E     MOV     DPTR,#g_mem+08AH
03FC E0                MOVX    A,@DPTR
03FD FE                MOV     R6,A
03FE A3                INC     DPTR
03FF E0                MOVX    A,@DPTR
0400 FF                MOV     R7,A
0401 C3                CLR     C
0402 E4                CLR     A
0403 9F                SUBB    A,R7
0404 FF                MOV     R7,A
0405 7404              MOV     A,#04H
0407 9E                SUBB    A,R6
0408 FE                MOV     R6,A
0409 AB07              MOV     R3,AR7
040B FA                MOV     R2,A
040C 33                RLC     A
040D 95E0              SUBB    A,ACC
040F F9                MOV     R1,A
0410 F8                MOV     R0,A
0411 D007              POP     AR7
0413 D006              POP     AR6
0415 120000      E     LCALL   ?C?SLDIV
0418 D003              POP     AR3
041A D002              POP     AR2
041C D001              POP     AR1
041E D000              POP     AR0
0420 EB                MOV     A,R3
0421 2F                ADD     A,R7
0422 FF                MOV     R7,A
0423 EA                MOV     A,R2
0424 3E                ADDC    A,R6
0425 FE                MOV     R6,A
0426 E9                MOV     A,R1
0427 3D                ADDC    A,R5
0428 FD                MOV     R5,A
0429 E8                MOV     A,R0
042A 3C                ADDC    A,R4
042B FC                MOV     R4,A
042C 900000      E     MOV     DPTR,#g_ref
042F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 434
0432 900000      E     MOV     DPTR,#g_ref+04H
0435 E0                MOVX    A,@DPTR
0436 F8                MOV     R0,A
0437 A3                INC     DPTR
0438 E0                MOVX    A,@DPTR
0439 F9                MOV     R1,A
043A A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 41  

043B E0                MOVX    A,@DPTR
043C FA                MOV     R2,A
043D A3                INC     DPTR
043E E0                MOVX    A,@DPTR
043F FB                MOV     R3,A
0440 C000              PUSH    AR0
0442 C001              PUSH    AR1
0444 C002              PUSH    AR2
0446 C003              PUSH    AR3
0448 900000      E     MOV     DPTR,#g_mem+088H
044B E0                MOVX    A,@DPTR
044C FE                MOV     R6,A
044D A3                INC     DPTR
044E E0                MOVX    A,@DPTR
044F FF                MOV     R7,A
0450 E4                CLR     A
0451 FC                MOV     R4,A
0452 FD                MOV     R5,A
0453 AB00        R     MOV     R3,err_joy_1+03H
0455 AA00        R     MOV     R2,err_joy_1+02H
0457 A900        R     MOV     R1,err_joy_1+01H
0459 A800        R     MOV     R0,err_joy_1
045B 120000      E     LCALL   ?C?LMUL
045E C006              PUSH    AR6
0460 C007              PUSH    AR7
0462 900000      E     MOV     DPTR,#g_mem+08AH
0465 E0                MOVX    A,@DPTR
0466 FE                MOV     R6,A
0467 A3                INC     DPTR
0468 E0                MOVX    A,@DPTR
0469 FF                MOV     R7,A
046A C3                CLR     C
046B E4                CLR     A
046C 9F                SUBB    A,R7
046D FF                MOV     R7,A
046E 7404              MOV     A,#04H
0470 9E                SUBB    A,R6
0471 FE                MOV     R6,A
0472 AB07              MOV     R3,AR7
0474 FA                MOV     R2,A
0475 33                RLC     A
0476 95E0              SUBB    A,ACC
0478 F9                MOV     R1,A
0479 F8                MOV     R0,A
047A D007              POP     AR7
047C D006              POP     AR6
047E 120000      E     LCALL   ?C?SLDIV
0481 D003              POP     AR3
0483 D002              POP     AR2
0485 D001              POP     AR1
0487 D000              POP     AR0
0489 EB                MOV     A,R3
048A 2F                ADD     A,R7
048B FF                MOV     R7,A
048C EA                MOV     A,R2
048D 3E                ADDC    A,R6
048E FE                MOV     R6,A
048F E9                MOV     A,R1
0490 3D                ADDC    A,R5
0491 FD                MOV     R5,A
0492 E8                MOV     A,R0
0493 3C                ADDC    A,R4
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 42  

0494 FC                MOV     R4,A
0495 900000      E     MOV     DPTR,#g_ref+04H
0498 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 436
                                           ; SOURCE LINE # 437
049B         ?C0053:
                                           ; SOURCE LINE # 439
049B 900000      E     MOV     DPTR,#g_mem+08AH
049E E0                MOVX    A,@DPTR
049F FA                MOV     R2,A
04A0 A3                INC     DPTR
04A1 E0                MOVX    A,@DPTR
04A2 FB                MOV     R3,A
04A3 C3                CLR     C
04A4 900000      E     MOV     DPTR,#g_meas+032H
04A7 E0                MOVX    A,@DPTR
04A8 9B                SUBB    A,R3
04A9 FF                MOV     R7,A
04AA 900000      E     MOV     DPTR,#g_meas+031H
04AD E0                MOVX    A,@DPTR
04AE 9A                SUBB    A,R2
04AF FE                MOV     R6,A
04B0 33                RLC     A
04B1 95E0              SUBB    A,ACC
04B3 8F00        R     MOV     err_joy_2+03H,R7
04B5 8E00        R     MOV     err_joy_2+02H,R6
04B7 F500        R     MOV     err_joy_2+01H,A
04B9 F500        R     MOV     err_joy_2,A
                                           ; SOURCE LINE # 441
04BB D3                SETB    C
04BC A3                INC     DPTR
04BD E0                MOVX    A,@DPTR
04BE 9B                SUBB    A,R3
04BF EA                MOV     A,R2
04C0 6480              XRL     A,#080H
04C2 F8                MOV     R0,A
04C3 900000      E     MOV     DPTR,#g_meas+031H
04C6 E0                MOVX    A,@DPTR
04C7 6480              XRL     A,#080H
04C9 98                SUBB    A,R0
04CA 5003              JNC     $ + 5H
04CC 020000      R     LJMP    ?C0055
                                           ; SOURCE LINE # 442
04CF 900000      E     MOV     DPTR,#g_ref
04D2 E0                MOVX    A,@DPTR
04D3 F8                MOV     R0,A
04D4 A3                INC     DPTR
04D5 E0                MOVX    A,@DPTR
04D6 F9                MOV     R1,A
04D7 A3                INC     DPTR
04D8 E0                MOVX    A,@DPTR
04D9 FA                MOV     R2,A
04DA A3                INC     DPTR
04DB E0                MOVX    A,@DPTR
04DC FB                MOV     R3,A
04DD C000              PUSH    AR0
04DF C001              PUSH    AR1
04E1 C002              PUSH    AR2
04E3 C003              PUSH    AR3
04E5 900000      E     MOV     DPTR,#g_mem+088H
04E8 E0                MOVX    A,@DPTR
04E9 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 43  

04EA A3                INC     DPTR
04EB E0                MOVX    A,@DPTR
04EC FF                MOV     R7,A
04ED E4                CLR     A
04EE FC                MOV     R4,A
04EF FD                MOV     R5,A
04F0 AB00        R     MOV     R3,err_joy_2+03H
04F2 AA00        R     MOV     R2,err_joy_2+02H
04F4 A900        R     MOV     R1,err_joy_2+01H
04F6 A800        R     MOV     R0,err_joy_2
04F8 120000      E     LCALL   ?C?LMUL
04FB C006              PUSH    AR6
04FD C007              PUSH    AR7
04FF 900000      E     MOV     DPTR,#g_mem+08AH
0502 E0                MOVX    A,@DPTR
0503 FE                MOV     R6,A
0504 A3                INC     DPTR
0505 E0                MOVX    A,@DPTR
0506 FF                MOV     R7,A
0507 C3                CLR     C
0508 E4                CLR     A
0509 9F                SUBB    A,R7
050A FF                MOV     R7,A
050B 7404              MOV     A,#04H
050D 9E                SUBB    A,R6
050E FE                MOV     R6,A
050F AB07              MOV     R3,AR7
0511 FA                MOV     R2,A
0512 33                RLC     A
0513 95E0              SUBB    A,ACC
0515 F9                MOV     R1,A
0516 F8                MOV     R0,A
0517 D007              POP     AR7
0519 D006              POP     AR6
051B 120000      E     LCALL   ?C?SLDIV
051E D003              POP     AR3
0520 D002              POP     AR2
0522 D001              POP     AR1
0524 D000              POP     AR0
0526 EB                MOV     A,R3
0527 2F                ADD     A,R7
0528 FF                MOV     R7,A
0529 EA                MOV     A,R2
052A 3E                ADDC    A,R6
052B FE                MOV     R6,A
052C E9                MOV     A,R1
052D 3D                ADDC    A,R5
052E FD                MOV     R5,A
052F E8                MOV     A,R0
0530 3C                ADDC    A,R4
0531 FC                MOV     R4,A
0532 900000      E     MOV     DPTR,#g_ref
0535 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 443
0538 900000      E     MOV     DPTR,#g_ref+04H
053B E0                MOVX    A,@DPTR
053C FC                MOV     R4,A
053D A3                INC     DPTR
053E E0                MOVX    A,@DPTR
053F FD                MOV     R5,A
0540 A3                INC     DPTR
0541 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 44  

0542 FE                MOV     R6,A
0543 A3                INC     DPTR
0544 E0                MOVX    A,@DPTR
0545 FF                MOV     R7,A
0546 C004              PUSH    AR4
0548 C005              PUSH    AR5
054A C006              PUSH    AR6
054C C007              PUSH    AR7
054E 900000      E     MOV     DPTR,#g_mem+088H
0551 E0                MOVX    A,@DPTR
0552 FE                MOV     R6,A
0553 A3                INC     DPTR
0554 E0                MOVX    A,@DPTR
0555 FF                MOV     R7,A
0556 E4                CLR     A
0557 FC                MOV     R4,A
0558 FD                MOV     R5,A
0559 AB00        R     MOV     R3,err_joy_2+03H
055B AA00        R     MOV     R2,err_joy_2+02H
055D A900        R     MOV     R1,err_joy_2+01H
055F A800        R     MOV     R0,err_joy_2
0561 120000      E     LCALL   ?C?LMUL
0564 C006              PUSH    AR6
0566 C007              PUSH    AR7
0568 900000      E     MOV     DPTR,#g_mem+08AH
056B E0                MOVX    A,@DPTR
056C FE                MOV     R6,A
056D A3                INC     DPTR
056E E0                MOVX    A,@DPTR
056F FF                MOV     R7,A
0570 C3                CLR     C
0571 E4                CLR     A
0572 9F                SUBB    A,R7
0573 FF                MOV     R7,A
0574 7404              MOV     A,#04H
0576 9E                SUBB    A,R6
0577 FE                MOV     R6,A
0578 AB07              MOV     R3,AR7
057A FA                MOV     R2,A
057B 33                RLC     A
057C 95E0              SUBB    A,ACC
057E F9                MOV     R1,A
057F F8                MOV     R0,A
0580 D007              POP     AR7
0582 D006              POP     AR6
0584 120000      E     LCALL   ?C?SLDIV
0587 A804              MOV     R0,AR4
0589 A905              MOV     R1,AR5
058B AA06              MOV     R2,AR6
058D AB07              MOV     R3,AR7
058F D007              POP     AR7
0591 D006              POP     AR6
0593 D005              POP     AR5
0595 D004              POP     AR4
0597 C3                CLR     C
0598 EF                MOV     A,R7
0599 9B                SUBB    A,R3
059A FF                MOV     R7,A
059B EE                MOV     A,R6
059C 9A                SUBB    A,R2
059D FE                MOV     R6,A
059E ED                MOV     A,R5
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 45  

059F 99                SUBB    A,R1
05A0 FD                MOV     R5,A
05A1 EC                MOV     A,R4
05A2 98                SUBB    A,R0
05A3 FC                MOV     R4,A
05A4 900000      E     MOV     DPTR,#g_ref+04H
05A7 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 445
05AA 020000      R     LJMP    ?C0038
05AD         ?C0055:
                                           ; SOURCE LINE # 446
                                           ; SOURCE LINE # 447
05AD 900000      E     MOV     DPTR,#g_mem+08AH
05B0 E0                MOVX    A,@DPTR
05B1 FA                MOV     R2,A
05B2 A3                INC     DPTR
05B3 E0                MOVX    A,@DPTR
05B4 FB                MOV     R3,A
05B5 900000      E     MOV     DPTR,#g_meas+032H
05B8 E0                MOVX    A,@DPTR
05B9 2B                ADD     A,R3
05BA FF                MOV     R7,A
05BB 900000      E     MOV     DPTR,#g_meas+031H
05BE E0                MOVX    A,@DPTR
05BF 3A                ADDC    A,R2
05C0 FE                MOV     R6,A
05C1 33                RLC     A
05C2 95E0              SUBB    A,ACC
05C4 8F00        R     MOV     err_joy_2+03H,R7
05C6 8E00        R     MOV     err_joy_2+02H,R6
05C8 F500        R     MOV     err_joy_2+01H,A
05CA F500        R     MOV     err_joy_2,A
                                           ; SOURCE LINE # 449
05CC C3                CLR     C
05CD E4                CLR     A
05CE 9B                SUBB    A,R3
05CF FF                MOV     R7,A
05D0 E4                CLR     A
05D1 9A                SUBB    A,R2
05D2 FE                MOV     R6,A
05D3 C3                CLR     C
05D4 A3                INC     DPTR
05D5 E0                MOVX    A,@DPTR
05D6 9F                SUBB    A,R7
05D7 EE                MOV     A,R6
05D8 6480              XRL     A,#080H
05DA F8                MOV     R0,A
05DB 900000      E     MOV     DPTR,#g_meas+031H
05DE E0                MOVX    A,@DPTR
05DF 6480              XRL     A,#080H
05E1 98                SUBB    A,R0
05E2 4003              JC      $ + 5H
05E4 020000      R     LJMP    ?C0038
                                           ; SOURCE LINE # 450
05E7 900000      E     MOV     DPTR,#g_ref
05EA E0                MOVX    A,@DPTR
05EB F8                MOV     R0,A
05EC A3                INC     DPTR
05ED E0                MOVX    A,@DPTR
05EE F9                MOV     R1,A
05EF A3                INC     DPTR
05F0 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 46  

05F1 FA                MOV     R2,A
05F2 A3                INC     DPTR
05F3 E0                MOVX    A,@DPTR
05F4 FB                MOV     R3,A
05F5 C000              PUSH    AR0
05F7 C001              PUSH    AR1
05F9 C002              PUSH    AR2
05FB C003              PUSH    AR3
05FD 900000      E     MOV     DPTR,#g_mem+088H
0600 E0                MOVX    A,@DPTR
0601 FE                MOV     R6,A
0602 A3                INC     DPTR
0603 E0                MOVX    A,@DPTR
0604 FF                MOV     R7,A
0605 E4                CLR     A
0606 FC                MOV     R4,A
0607 FD                MOV     R5,A
0608 AB00        R     MOV     R3,err_joy_2+03H
060A AA00        R     MOV     R2,err_joy_2+02H
060C A900        R     MOV     R1,err_joy_2+01H
060E A800        R     MOV     R0,err_joy_2
0610 120000      E     LCALL   ?C?LMUL
0613 C006              PUSH    AR6
0615 C007              PUSH    AR7
0617 900000      E     MOV     DPTR,#g_mem+08AH
061A E0                MOVX    A,@DPTR
061B FE                MOV     R6,A
061C A3                INC     DPTR
061D E0                MOVX    A,@DPTR
061E FF                MOV     R7,A
061F C3                CLR     C
0620 E4                CLR     A
0621 9F                SUBB    A,R7
0622 FF                MOV     R7,A
0623 7404              MOV     A,#04H
0625 9E                SUBB    A,R6
0626 FE                MOV     R6,A
0627 AB07              MOV     R3,AR7
0629 FA                MOV     R2,A
062A 33                RLC     A
062B 95E0              SUBB    A,ACC
062D F9                MOV     R1,A
062E F8                MOV     R0,A
062F D007              POP     AR7
0631 D006              POP     AR6
0633 120000      E     LCALL   ?C?SLDIV
0636 D003              POP     AR3
0638 D002              POP     AR2
063A D001              POP     AR1
063C D000              POP     AR0
063E EB                MOV     A,R3
063F 2F                ADD     A,R7
0640 FF                MOV     R7,A
0641 EA                MOV     A,R2
0642 3E                ADDC    A,R6
0643 FE                MOV     R6,A
0644 E9                MOV     A,R1
0645 3D                ADDC    A,R5
0646 FD                MOV     R5,A
0647 E8                MOV     A,R0
0648 3C                ADDC    A,R4
0649 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 47  

064A 900000      E     MOV     DPTR,#g_ref
064D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 451
0650 900000      E     MOV     DPTR,#g_ref+04H
0653 E0                MOVX    A,@DPTR
0654 FC                MOV     R4,A
0655 A3                INC     DPTR
0656 E0                MOVX    A,@DPTR
0657 FD                MOV     R5,A
0658 A3                INC     DPTR
0659 E0                MOVX    A,@DPTR
065A FE                MOV     R6,A
065B A3                INC     DPTR
065C E0                MOVX    A,@DPTR
065D FF                MOV     R7,A
065E C004              PUSH    AR4
0660 C005              PUSH    AR5
0662 C006              PUSH    AR6
0664 C007              PUSH    AR7
0666 900000      E     MOV     DPTR,#g_mem+088H
0669 E0                MOVX    A,@DPTR
066A FE                MOV     R6,A
066B A3                INC     DPTR
066C E0                MOVX    A,@DPTR
066D FF                MOV     R7,A
066E E4                CLR     A
066F FC                MOV     R4,A
0670 FD                MOV     R5,A
0671 AB00        R     MOV     R3,err_joy_2+03H
0673 AA00        R     MOV     R2,err_joy_2+02H
0675 A900        R     MOV     R1,err_joy_2+01H
0677 A800        R     MOV     R0,err_joy_2
0679 120000      E     LCALL   ?C?LMUL
067C C006              PUSH    AR6
067E C007              PUSH    AR7
0680 900000      E     MOV     DPTR,#g_mem+08AH
0683 E0                MOVX    A,@DPTR
0684 FE                MOV     R6,A
0685 A3                INC     DPTR
0686 E0                MOVX    A,@DPTR
0687 FF                MOV     R7,A
0688 C3                CLR     C
0689 E4                CLR     A
068A 9F                SUBB    A,R7
068B FF                MOV     R7,A
068C 7404              MOV     A,#04H
068E 9E                SUBB    A,R6
068F FE                MOV     R6,A
0690 AB07              MOV     R3,AR7
0692 FA                MOV     R2,A
0693 33                RLC     A
0694 95E0              SUBB    A,ACC
0696 F9                MOV     R1,A
0697 F8                MOV     R0,A
0698 D007              POP     AR7
069A D006              POP     AR6
069C 120000      E     LCALL   ?C?SLDIV
069F A804              MOV     R0,AR4
06A1 A905              MOV     R1,AR5
06A3 AA06              MOV     R2,AR6
06A5 AB07              MOV     R3,AR7
06A7 D007              POP     AR7
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 48  

06A9 D006              POP     AR6
06AB D005              POP     AR5
06AD D004              POP     AR4
06AF C3                CLR     C
06B0 EF                MOV     A,R7
06B1 9B                SUBB    A,R3
06B2 FF                MOV     R7,A
06B3 EE                MOV     A,R6
06B4 9A                SUBB    A,R2
06B5 FE                MOV     R6,A
06B6 ED                MOV     A,R5
06B7 99                SUBB    A,R1
06B8 FD                MOV     R5,A
06B9 EC                MOV     A,R4
06BA 98                SUBB    A,R0
06BB FC                MOV     R4,A
06BC 900000      E     MOV     DPTR,#g_ref+04H
06BF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 453
                                           ; SOURCE LINE # 454
                                           ; SOURCE LINE # 455
06C2 020000      R     LJMP    ?C0038
06C5         ?C0049:
                                           ; SOURCE LINE # 457
                                           ; SOURCE LINE # 459
06C5 900000      E     MOV     DPTR,#g_meas+04H
06C8 E0                MOVX    A,@DPTR
06C9 F8                MOV     R0,A
06CA A3                INC     DPTR
06CB E0                MOVX    A,@DPTR
06CC F9                MOV     R1,A
06CD A3                INC     DPTR
06CE E0                MOVX    A,@DPTR
06CF FA                MOV     R2,A
06D0 A3                INC     DPTR
06D1 E0                MOVX    A,@DPTR
06D2 FB                MOV     R3,A
06D3 900000      E     MOV     DPTR,#g_meas
06D6 E0                MOVX    A,@DPTR
06D7 FC                MOV     R4,A
06D8 A3                INC     DPTR
06D9 E0                MOVX    A,@DPTR
06DA FD                MOV     R5,A
06DB A3                INC     DPTR
06DC E0                MOVX    A,@DPTR
06DD FE                MOV     R6,A
06DE A3                INC     DPTR
06DF E0                MOVX    A,@DPTR
06E0 C3                CLR     C
06E1 9B                SUBB    A,R3
06E2 FF                MOV     R7,A
06E3 EE                MOV     A,R6
06E4 9A                SUBB    A,R2
06E5 FE                MOV     R6,A
06E6 ED                MOV     A,R5
06E7 99                SUBB    A,R1
06E8 FD                MOV     R5,A
06E9 EC                MOV     A,R4
06EA 98                SUBB    A,R0
06EB FC                MOV     R4,A
06EC 900000      E     MOV     DPTR,#c_mem+035H
06EF E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 49  

06F0 F9                MOV     R1,A
06F1 F8                MOV     R0,A
06F2 120000      E     LCALL   ?C?SLSHR
06F5 8F00        R     MOV     pos_diff+03H,R7
06F7 8E00        R     MOV     pos_diff+02H,R6
06F9 8D00        R     MOV     pos_diff+01H,R5
06FB 8C00        R     MOV     pos_diff,R4
                                           ; SOURCE LINE # 460
06FD 900000      E     MOV     DPTR,#g_meas+04H
0700 E0                MOVX    A,@DPTR
0701 FC                MOV     R4,A
0702 A3                INC     DPTR
0703 E0                MOVX    A,@DPTR
0704 FD                MOV     R5,A
0705 A3                INC     DPTR
0706 E0                MOVX    A,@DPTR
0707 FE                MOV     R6,A
0708 A3                INC     DPTR
0709 E0                MOVX    A,@DPTR
070A FF                MOV     R7,A
070B 900000      E     MOV     DPTR,#g_meas
070E E0                MOVX    A,@DPTR
070F F8                MOV     R0,A
0710 A3                INC     DPTR
0711 E0                MOVX    A,@DPTR
0712 F9                MOV     R1,A
0713 A3                INC     DPTR
0714 E0                MOVX    A,@DPTR
0715 FA                MOV     R2,A
0716 A3                INC     DPTR
0717 E0                MOVX    A,@DPTR
0718 2F                ADD     A,R7
0719 FF                MOV     R7,A
071A EA                MOV     A,R2
071B 3E                ADDC    A,R6
071C FE                MOV     R6,A
071D E9                MOV     A,R1
071E 3D                ADDC    A,R5
071F FD                MOV     R5,A
0720 E8                MOV     A,R0
0721 3C                ADDC    A,R4
0722 FC                MOV     R4,A
0723 900000      E     MOV     DPTR,#c_mem+035H
0726 E0                MOVX    A,@DPTR
0727 F9                MOV     R1,A
0728 F8                MOV     R0,A
0729 120000      E     LCALL   ?C?SLSHR
072C 8F00        R     MOV     pos_sum+03H,R7
072E 8E00        R     MOV     pos_sum+02H,R6
0730 8D00        R     MOV     pos_sum+01H,R5
0732 8C00        R     MOV     pos_sum,R4
                                           ; SOURCE LINE # 462
0734 AE00        R     MOV     R6,pos_diff+02H
0736 AF00        R     MOV     R7,pos_diff+03H
0738 120000      E     LCALL   _abs
073B D3                SETB    C
073C EF                MOV     A,R7
073D 94F4              SUBB    A,#0F4H
073F EE                MOV     A,R6
0740 6480              XRL     A,#080H
0742 9481              SUBB    A,#081H
0744 5003              JNC     $ + 5H
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 50  

0746 020000      R     LJMP    ?C0059
                                           ; SOURCE LINE # 463
0749 E4                CLR     A
074A FF                MOV     R7,A
074B FE                MOV     R6,A
074C FD                MOV     R5,A
074D FC                MOV     R4,A
074E AB00        R     MOV     R3,pos_diff+03H
0750 AA00        R     MOV     R2,pos_diff+02H
0752 A900        R     MOV     R1,pos_diff+01H
0754 A800        R     MOV     R0,pos_diff
0756 120000      E     LCALL   ?C?SLCMP
0759 4006              JC      ?C0061
075B 7E00              MOV     R6,#00H
075D 7F01              MOV     R7,#01H
075F 8004              SJMP    ?C0062
0761         ?C0061:
0761 7EFF              MOV     R6,#0FFH
0763 7FFF              MOV     R7,#0FFH
0765         ?C0062:
0765 EF                MOV     A,R7
0766 6401              XRL     A,#01H
0768 4E                ORL     A,R6
0769 7068              JNZ     ?C0060
                                           ; SOURCE LINE # 464
076B 900000      E     MOV     DPTR,#g_ref+04H
076E E0                MOVX    A,@DPTR
076F F8                MOV     R0,A
0770 A3                INC     DPTR
0771 E0                MOVX    A,@DPTR
0772 F9                MOV     R1,A
0773 A3                INC     DPTR
0774 E0                MOVX    A,@DPTR
0775 FA                MOV     R2,A
0776 A3                INC     DPTR
0777 E0                MOVX    A,@DPTR
0778 FB                MOV     R3,A
0779 900000      E     MOV     DPTR,#g_mem+088H
077C E0                MOVX    A,@DPTR
077D FE                MOV     R6,A
077E A3                INC     DPTR
077F E0                MOVX    A,@DPTR
0780 FF                MOV     R7,A
0781 E4                CLR     A
0782 FC                MOV     R4,A
0783 FD                MOV     R5,A
0784 EB                MOV     A,R3
0785 2F                ADD     A,R7
0786 FF                MOV     R7,A
0787 EA                MOV     A,R2
0788 3E                ADDC    A,R6
0789 FE                MOV     R6,A
078A ED                MOV     A,R5
078B 39                ADDC    A,R1
078C FD                MOV     R5,A
078D EC                MOV     A,R4
078E 38                ADDC    A,R0
078F FC                MOV     R4,A
0790 900000      E     MOV     DPTR,#g_ref+04H
0793 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 465
0796 900000      E     MOV     DPTR,#g_ref
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 51  

0799 E0                MOVX    A,@DPTR
079A FC                MOV     R4,A
079B A3                INC     DPTR
079C E0                MOVX    A,@DPTR
079D FD                MOV     R5,A
079E A3                INC     DPTR
079F E0                MOVX    A,@DPTR
07A0 FE                MOV     R6,A
07A1 A3                INC     DPTR
07A2 E0                MOVX    A,@DPTR
07A3 FF                MOV     R7,A
07A4 C006              PUSH    AR6
07A6 C007              PUSH    AR7
07A8 900000      E     MOV     DPTR,#g_mem+088H
07AB E0                MOVX    A,@DPTR
07AC C3                CLR     C
07AD 13                RRC     A
07AE FE                MOV     R6,A
07AF A3                INC     DPTR
07B0 E0                MOVX    A,@DPTR
07B1 13                RRC     A
07B2 FF                MOV     R7,A
07B3 FB                MOV     R3,A
07B4 AA06              MOV     R2,AR6
07B6 E4                CLR     A
07B7 D007              POP     AR7
07B9 D006              POP     AR6
07BB C3                CLR     C
07BC EF                MOV     A,R7
07BD 9B                SUBB    A,R3
07BE FF                MOV     R7,A
07BF EE                MOV     A,R6
07C0 9A                SUBB    A,R2
07C1 FE                MOV     R6,A
07C2 ED                MOV     A,R5
07C3 9400              SUBB    A,#00H
07C5 FD                MOV     R5,A
07C6 EC                MOV     A,R4
07C7 9400              SUBB    A,#00H
07C9 FC                MOV     R4,A
07CA 900000      E     MOV     DPTR,#g_ref
07CD 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 466
07D0 020000      R     LJMP    ?C0038
07D3         ?C0060:
                                           ; SOURCE LINE # 467
                                           ; SOURCE LINE # 468
07D3 900000      E     MOV     DPTR,#g_ref
07D6 E0                MOVX    A,@DPTR
07D7 F8                MOV     R0,A
07D8 A3                INC     DPTR
07D9 E0                MOVX    A,@DPTR
07DA F9                MOV     R1,A
07DB A3                INC     DPTR
07DC E0                MOVX    A,@DPTR
07DD FA                MOV     R2,A
07DE A3                INC     DPTR
07DF E0                MOVX    A,@DPTR
07E0 FB                MOV     R3,A
07E1 900000      E     MOV     DPTR,#g_mem+088H
07E4 E0                MOVX    A,@DPTR
07E5 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 52  

07E6 A3                INC     DPTR
07E7 E0                MOVX    A,@DPTR
07E8 FF                MOV     R7,A
07E9 E4                CLR     A
07EA FC                MOV     R4,A
07EB FD                MOV     R5,A
07EC EB                MOV     A,R3
07ED 2F                ADD     A,R7
07EE FF                MOV     R7,A
07EF EA                MOV     A,R2
07F0 3E                ADDC    A,R6
07F1 FE                MOV     R6,A
07F2 ED                MOV     A,R5
07F3 39                ADDC    A,R1
07F4 FD                MOV     R5,A
07F5 EC                MOV     A,R4
07F6 38                ADDC    A,R0
07F7 FC                MOV     R4,A
07F8 900000      E     MOV     DPTR,#g_ref
07FB 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 469
07FE 900000      E     MOV     DPTR,#g_ref+04H
0801 E0                MOVX    A,@DPTR
0802 FC                MOV     R4,A
0803 A3                INC     DPTR
0804 E0                MOVX    A,@DPTR
0805 FD                MOV     R5,A
0806 A3                INC     DPTR
0807 E0                MOVX    A,@DPTR
0808 FE                MOV     R6,A
0809 A3                INC     DPTR
080A E0                MOVX    A,@DPTR
080B FF                MOV     R7,A
080C C006              PUSH    AR6
080E C007              PUSH    AR7
0810 900000      E     MOV     DPTR,#g_mem+088H
0813 E0                MOVX    A,@DPTR
0814 C3                CLR     C
0815 13                RRC     A
0816 FE                MOV     R6,A
0817 A3                INC     DPTR
0818 E0                MOVX    A,@DPTR
0819 13                RRC     A
081A FF                MOV     R7,A
081B FB                MOV     R3,A
081C AA06              MOV     R2,AR6
081E E4                CLR     A
081F D007              POP     AR7
0821 D006              POP     AR6
0823 C3                CLR     C
0824 EF                MOV     A,R7
0825 9B                SUBB    A,R3
0826 FF                MOV     R7,A
0827 EE                MOV     A,R6
0828 9A                SUBB    A,R2
0829 FE                MOV     R6,A
082A ED                MOV     A,R5
082B 9400              SUBB    A,#00H
082D FD                MOV     R5,A
082E EC                MOV     A,R4
082F 9400              SUBB    A,#00H
0831 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 53  

0832 900000      E     MOV     DPTR,#g_ref+04H
0835 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 470
                                           ; SOURCE LINE # 472
0838 020000      R     LJMP    ?C0038
083B         ?C0059:
                                           ; SOURCE LINE # 473
                                           ; SOURCE LINE # 474
083B E4                CLR     A
083C FF                MOV     R7,A
083D FE                MOV     R6,A
083E FD                MOV     R5,A
083F FC                MOV     R4,A
0840 AB00        R     MOV     R3,pos_sum+03H
0842 AA00        R     MOV     R2,pos_sum+02H
0844 A900        R     MOV     R1,pos_sum+01H
0846 A800        R     MOV     R0,pos_sum
0848 D3                SETB    C
0849 120000      E     LCALL   ?C?SLCMP
084C 5003              JNC     $ + 5H
084E 020000      R     LJMP    ?C0038
                                           ; SOURCE LINE # 475
0851 900000      E     MOV     DPTR,#g_ref
0854 E0                MOVX    A,@DPTR
0855 FC                MOV     R4,A
0856 A3                INC     DPTR
0857 E0                MOVX    A,@DPTR
0858 FD                MOV     R5,A
0859 A3                INC     DPTR
085A E0                MOVX    A,@DPTR
085B FE                MOV     R6,A
085C A3                INC     DPTR
085D E0                MOVX    A,@DPTR
085E FF                MOV     R7,A
085F C006              PUSH    AR6
0861 C007              PUSH    AR7
0863 900000      E     MOV     DPTR,#g_mem+089H
0866 E0                MOVX    A,@DPTR
0867 25E0              ADD     A,ACC
0869 FF                MOV     R7,A
086A 900000      E     MOV     DPTR,#g_mem+088H
086D E0                MOVX    A,@DPTR
086E 33                RLC     A
086F FE                MOV     R6,A
0870 AB07              MOV     R3,AR7
0872 FA                MOV     R2,A
0873 E4                CLR     A
0874 D007              POP     AR7
0876 D006              POP     AR6
0878 C3                CLR     C
0879 EF                MOV     A,R7
087A 9B                SUBB    A,R3
087B FF                MOV     R7,A
087C EE                MOV     A,R6
087D 9A                SUBB    A,R2
087E FE                MOV     R6,A
087F ED                MOV     A,R5
0880 9400              SUBB    A,#00H
0882 FD                MOV     R5,A
0883 EC                MOV     A,R4
0884 9400              SUBB    A,#00H
0886 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 54  

0887 900000      E     MOV     DPTR,#g_ref
088A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 476
088D 900000      E     MOV     DPTR,#g_ref+04H
0890 E0                MOVX    A,@DPTR
0891 FC                MOV     R4,A
0892 A3                INC     DPTR
0893 E0                MOVX    A,@DPTR
0894 FD                MOV     R5,A
0895 A3                INC     DPTR
0896 E0                MOVX    A,@DPTR
0897 FE                MOV     R6,A
0898 A3                INC     DPTR
0899 E0                MOVX    A,@DPTR
089A FF                MOV     R7,A
089B C006              PUSH    AR6
089D C007              PUSH    AR7
089F 900000      E     MOV     DPTR,#g_mem+089H
08A2 E0                MOVX    A,@DPTR
08A3 25E0              ADD     A,ACC
08A5 FF                MOV     R7,A
08A6 900000      E     MOV     DPTR,#g_mem+088H
08A9 E0                MOVX    A,@DPTR
08AA 33                RLC     A
08AB FE                MOV     R6,A
08AC AB07              MOV     R3,AR7
08AE FA                MOV     R2,A
08AF E4                CLR     A
08B0 D007              POP     AR7
08B2 D006              POP     AR6
08B4 C3                CLR     C
08B5 EF                MOV     A,R7
08B6 9B                SUBB    A,R3
08B7 FF                MOV     R7,A
08B8 EE                MOV     A,R6
08B9 9A                SUBB    A,R2
08BA FE                MOV     R6,A
08BB ED                MOV     A,R5
08BC 9400              SUBB    A,#00H
08BE FD                MOV     R5,A
08BF EC                MOV     A,R4
08C0 9400              SUBB    A,#00H
08C2 FC                MOV     R4,A
08C3 900000      E     MOV     DPTR,#g_ref+04H
08C6 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 477
08C9 E4                CLR     A
08CA FF                MOV     R7,A
08CB FE                MOV     R6,A
08CC FD                MOV     R5,A
08CD FC                MOV     R4,A
08CE 900000      E     MOV     DPTR,#g_ref
08D1 E0                MOVX    A,@DPTR
08D2 F8                MOV     R0,A
08D3 A3                INC     DPTR
08D4 E0                MOVX    A,@DPTR
08D5 F9                MOV     R1,A
08D6 A3                INC     DPTR
08D7 E0                MOVX    A,@DPTR
08D8 FA                MOV     R2,A
08D9 A3                INC     DPTR
08DA E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 55  

08DB FB                MOV     R3,A
08DC C3                CLR     C
08DD 120000      E     LCALL   ?C?SLCMP
08E0 500B              JNC     ?C0066
                                           ; SOURCE LINE # 478
08E2 E4                CLR     A
08E3 FF                MOV     R7,A
08E4 FE                MOV     R6,A
08E5 FD                MOV     R5,A
08E6 FC                MOV     R4,A
08E7 900000      E     MOV     DPTR,#g_ref
08EA 120000      E     LCALL   ?C?LSTXDATA
08ED         ?C0066:
                                           ; SOURCE LINE # 479
08ED         ?C0067:
                                           ; SOURCE LINE # 480
08ED E4                CLR     A
08EE FF                MOV     R7,A
08EF FE                MOV     R6,A
08F0 FD                MOV     R5,A
08F1 FC                MOV     R4,A
08F2 900000      E     MOV     DPTR,#g_ref+04H
08F5 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 481
                                           ; SOURCE LINE # 482
                                           ; SOURCE LINE # 483
                                           ; SOURCE LINE # 484
08F8 020000      R     LJMP    ?C0038
                                           ; SOURCE LINE # 487
08FB         ?C0068:
                                           ; SOURCE LINE # 491
08FB 900000      E     MOV     DPTR,#g_meas+031H
08FE E0                MOVX    A,@DPTR
08FF FC                MOV     R4,A
0900 A3                INC     DPTR
0901 E0                MOVX    A,@DPTR
0902 FD                MOV     R5,A
0903 EC                MOV     A,R4
0904 120000      E     LCALL   ?C?FCASTI
0907 E4                CLR     A
0908 FB                MOV     R3,A
0909 FA                MOV     R2,A
090A 7948              MOV     R1,#048H
090C 78BE              MOV     R0,#0BEH
090E 120000      E     LCALL   ?C?FPMUL
0911 120000      E     LCALL   ?C?CASTF
0914 8F00        R     MOV     err_joy_2+03H,R7
0916 8E00        R     MOV     err_joy_2+02H,R6
0918 8D00        R     MOV     err_joy_2+01H,R5
091A 8C00        R     MOV     err_joy_2,R4
                                           ; SOURCE LINE # 494
091C 900000      E     MOV     DPTR,#g_mem+069H
091F E0                MOVX    A,@DPTR
0920 FE                MOV     R6,A
0921 A3                INC     DPTR
0922 E0                MOVX    A,@DPTR
0923 FF                MOV     R7,A
0924 C3                CLR     C
0925 E4                CLR     A
0926 9F                SUBB    A,R7
0927 FF                MOV     R7,A
0928 E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 56  

0929 9E                SUBB    A,R6
092A FE                MOV     R6,A
092B 33                RLC     A
092C 95E0              SUBB    A,ACC
092E FD                MOV     R5,A
092F FC                MOV     R4,A
0930 900000      E     MOV     DPTR,#g_meas+0CH
0933 E0                MOVX    A,@DPTR
0934 F8                MOV     R0,A
0935 A3                INC     DPTR
0936 E0                MOVX    A,@DPTR
0937 F9                MOV     R1,A
0938 A3                INC     DPTR
0939 E0                MOVX    A,@DPTR
093A FA                MOV     R2,A
093B A3                INC     DPTR
093C E0                MOVX    A,@DPTR
093D FB                MOV     R3,A
093E C3                CLR     C
093F 120000      E     LCALL   ?C?SLCMP
0942 5019              JNC     ?C0069
0944 900000      E     MOV     DPTR,#g_meas+032H
0947 E0                MOVX    A,@DPTR
0948 9400              SUBB    A,#00H
094A 900000      E     MOV     DPTR,#g_meas+031H
094D E0                MOVX    A,@DPTR
094E 6480              XRL     A,#080H
0950 9480              SUBB    A,#080H
0952 4009              JC      ?C0069
                                           ; SOURCE LINE # 495
0954 E4                CLR     A
0955 F500        R     MOV     err_joy_2+03H,A
0957 F500        R     MOV     err_joy_2+02H,A
0959 F500        R     MOV     err_joy_2+01H,A
095B F500        R     MOV     err_joy_2,A
095D         ?C0069:
                                           ; SOURCE LINE # 498
095D 900000      E     MOV     DPTR,#g_mem+069H
0960 E0                MOVX    A,@DPTR
0961 FE                MOV     R6,A
0962 A3                INC     DPTR
0963 E0                MOVX    A,@DPTR
0964 FF                MOV     R7,A
0965 EE                MOV     A,R6
0966 33                RLC     A
0967 95E0              SUBB    A,ACC
0969 FD                MOV     R5,A
096A FC                MOV     R4,A
096B 900000      E     MOV     DPTR,#g_meas+0CH
096E E0                MOVX    A,@DPTR
096F F8                MOV     R0,A
0970 A3                INC     DPTR
0971 E0                MOVX    A,@DPTR
0972 F9                MOV     R1,A
0973 A3                INC     DPTR
0974 E0                MOVX    A,@DPTR
0975 FA                MOV     R2,A
0976 A3                INC     DPTR
0977 E0                MOVX    A,@DPTR
0978 FB                MOV     R3,A
0979 D3                SETB    C
097A 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 57  

097D 4013              JC      ?C0070
097F 900000      E     MOV     DPTR,#g_meas+031H
0982 E0                MOVX    A,@DPTR
0983 6480              XRL     A,#080H
0985 9480              SUBB    A,#080H
0987 5009              JNC     ?C0070
                                           ; SOURCE LINE # 499
0989 E4                CLR     A
098A F500        R     MOV     err_joy_2+03H,A
098C F500        R     MOV     err_joy_2+02H,A
098E F500        R     MOV     err_joy_2+01H,A
0990 F500        R     MOV     err_joy_2,A
0992         ?C0070:
                                           ; SOURCE LINE # 501
0992 AF00        R     MOV     R7,err_joy_2+03H
0994 AE00        R     MOV     R6,err_joy_2+02H
0996 AD00        R     MOV     R5,err_joy_2+01H
0998 AC00        R     MOV     R4,err_joy_2
099A 900000      E     MOV     DPTR,#g_ref+010H
099D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 503
                                           ; SOURCE LINE # 505
                                           ; SOURCE LINE # 506
                                           ; SOURCE LINE # 507
                                           ; SOURCE LINE # 509
                                           ; SOURCE LINE # 511
                                           ; SOURCE LINE # 512
                                           ; SOURCE LINE # 513
09A0         ?C0038:
                                           ; SOURCE LINE # 516
09A0 900000      E     MOV     DPTR,#c_mem+050H
09A3 E0                MOVX    A,@DPTR
09A4 606A              JZ      ?C0073
                                           ; SOURCE LINE # 517
09A6 A3                INC     DPTR
09A7 E0                MOVX    A,@DPTR
09A8 FC                MOV     R4,A
09A9 A3                INC     DPTR
09AA E0                MOVX    A,@DPTR
09AB FD                MOV     R5,A
09AC A3                INC     DPTR
09AD E0                MOVX    A,@DPTR
09AE FE                MOV     R6,A
09AF A3                INC     DPTR
09B0 E0                MOVX    A,@DPTR
09B1 FF                MOV     R7,A
09B2 900000      E     MOV     DPTR,#g_ref
09B5 E0                MOVX    A,@DPTR
09B6 F8                MOV     R0,A
09B7 A3                INC     DPTR
09B8 E0                MOVX    A,@DPTR
09B9 F9                MOV     R1,A
09BA A3                INC     DPTR
09BB E0                MOVX    A,@DPTR
09BC FA                MOV     R2,A
09BD A3                INC     DPTR
09BE E0                MOVX    A,@DPTR
09BF FB                MOV     R3,A
09C0 C3                CLR     C
09C1 120000      E     LCALL   ?C?SLCMP
09C4 5014              JNC     ?C0074
                                           ; SOURCE LINE # 518
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 58  

09C6 900000      E     MOV     DPTR,#c_mem+051H
09C9 E0                MOVX    A,@DPTR
09CA FC                MOV     R4,A
09CB A3                INC     DPTR
09CC E0                MOVX    A,@DPTR
09CD FD                MOV     R5,A
09CE A3                INC     DPTR
09CF E0                MOVX    A,@DPTR
09D0 FE                MOV     R6,A
09D1 A3                INC     DPTR
09D2 E0                MOVX    A,@DPTR
09D3 FF                MOV     R7,A
09D4 900000      E     MOV     DPTR,#g_ref
09D7 120000      E     LCALL   ?C?LSTXDATA
09DA         ?C0074:
                                           ; SOURCE LINE # 519
09DA 900000      E     MOV     DPTR,#c_mem+059H
09DD E0                MOVX    A,@DPTR
09DE FC                MOV     R4,A
09DF A3                INC     DPTR
09E0 E0                MOVX    A,@DPTR
09E1 FD                MOV     R5,A
09E2 A3                INC     DPTR
09E3 E0                MOVX    A,@DPTR
09E4 FE                MOV     R6,A
09E5 A3                INC     DPTR
09E6 E0                MOVX    A,@DPTR
09E7 FF                MOV     R7,A
09E8 900000      E     MOV     DPTR,#g_ref
09EB E0                MOVX    A,@DPTR
09EC F8                MOV     R0,A
09ED A3                INC     DPTR
09EE E0                MOVX    A,@DPTR
09EF F9                MOV     R1,A
09F0 A3                INC     DPTR
09F1 E0                MOVX    A,@DPTR
09F2 FA                MOV     R2,A
09F3 A3                INC     DPTR
09F4 E0                MOVX    A,@DPTR
09F5 FB                MOV     R3,A
09F6 D3                SETB    C
09F7 120000      E     LCALL   ?C?SLCMP
09FA 4014              JC      ?C0073
                                           ; SOURCE LINE # 520
09FC 900000      E     MOV     DPTR,#c_mem+059H
09FF E0                MOVX    A,@DPTR
0A00 FC                MOV     R4,A
0A01 A3                INC     DPTR
0A02 E0                MOVX    A,@DPTR
0A03 FD                MOV     R5,A
0A04 A3                INC     DPTR
0A05 E0                MOVX    A,@DPTR
0A06 FE                MOV     R6,A
0A07 A3                INC     DPTR
0A08 E0                MOVX    A,@DPTR
0A09 FF                MOV     R7,A
0A0A 900000      E     MOV     DPTR,#g_ref
0A0D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 521
0A10         ?C0073:
                                           ; SOURCE LINE # 523
0A10 900000      E     MOV     DPTR,#c_mem+034H
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 59  

0A13 E0                MOVX    A,@DPTR
0A14 7003              JNZ     $ + 5H
0A16 020000      R     LJMP    ?C0098
0A19 14                DEC     A
0A1A 7003              JNZ     $ + 5H
0A1C 020000      R     LJMP    ?C0120
0A1F 14                DEC     A
0A20 7003              JNZ     $ + 5H
0A22 020000      R     LJMP    ?C0107
0A25 14                DEC     A
0A26 6003              JZ      $ + 5H
0A28 020000      R     LJMP    ?C0076
                                           ; SOURCE LINE # 525
0A2B         ?C0077:
                                           ; SOURCE LINE # 526
0A2B 900000      E     MOV     DPTR,#g_meas
0A2E E0                MOVX    A,@DPTR
0A2F F8                MOV     R0,A
0A30 A3                INC     DPTR
0A31 E0                MOVX    A,@DPTR
0A32 F9                MOV     R1,A
0A33 A3                INC     DPTR
0A34 E0                MOVX    A,@DPTR
0A35 FA                MOV     R2,A
0A36 A3                INC     DPTR
0A37 E0                MOVX    A,@DPTR
0A38 FB                MOV     R3,A
0A39 900000      E     MOV     DPTR,#g_ref
0A3C E0                MOVX    A,@DPTR
0A3D FC                MOV     R4,A
0A3E A3                INC     DPTR
0A3F E0                MOVX    A,@DPTR
0A40 FD                MOV     R5,A
0A41 A3                INC     DPTR
0A42 E0                MOVX    A,@DPTR
0A43 FE                MOV     R6,A
0A44 A3                INC     DPTR
0A45 E0                MOVX    A,@DPTR
0A46 C3                CLR     C
0A47 9B                SUBB    A,R3
0A48 F500        R     MOV     pos_error+03H,A
0A4A EE                MOV     A,R6
0A4B 9A                SUBB    A,R2
0A4C F500        R     MOV     pos_error+02H,A
0A4E ED                MOV     A,R5
0A4F 99                SUBB    A,R1
0A50 F500        R     MOV     pos_error+01H,A
0A52 EC                MOV     A,R4
0A53 98                SUBB    A,R0
0A54 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 528
0A56 900000      R     MOV     DPTR,#pos_error_sum
0A59 E0                MOVX    A,@DPTR
0A5A FC                MOV     R4,A
0A5B A3                INC     DPTR
0A5C E0                MOVX    A,@DPTR
0A5D FD                MOV     R5,A
0A5E A3                INC     DPTR
0A5F E0                MOVX    A,@DPTR
0A60 FE                MOV     R6,A
0A61 A3                INC     DPTR
0A62 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 60  

0A63 2500        R     ADD     A,pos_error+03H
0A65 FF                MOV     R7,A
0A66 EE                MOV     A,R6
0A67 3500        R     ADDC    A,pos_error+02H
0A69 FE                MOV     R6,A
0A6A ED                MOV     A,R5
0A6B 3500        R     ADDC    A,pos_error+01H
0A6D FD                MOV     R5,A
0A6E EC                MOV     A,R4
0A6F 3500        R     ADDC    A,pos_error
0A71 FC                MOV     R4,A
0A72 900000      R     MOV     DPTR,#pos_error_sum
0A75 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 531
0A78 7F80              MOV     R7,#080H
0A7A 7EF0              MOV     R6,#0F0H
0A7C 7DFA              MOV     R5,#0FAH
0A7E 7C02              MOV     R4,#02H
0A80 900000      R     MOV     DPTR,#pos_error_sum
0A83 E0                MOVX    A,@DPTR
0A84 F8                MOV     R0,A
0A85 A3                INC     DPTR
0A86 E0                MOVX    A,@DPTR
0A87 F9                MOV     R1,A
0A88 A3                INC     DPTR
0A89 E0                MOVX    A,@DPTR
0A8A FA                MOV     R2,A
0A8B A3                INC     DPTR
0A8C E0                MOVX    A,@DPTR
0A8D FB                MOV     R3,A
0A8E D3                SETB    C
0A8F 120000      E     LCALL   ?C?SLCMP
0A92 4010              JC      ?C0078
                                           ; SOURCE LINE # 532
0A94 7F80              MOV     R7,#080H
0A96 7EF0              MOV     R6,#0F0H
0A98 7DFA              MOV     R5,#0FAH
0A9A 7C02              MOV     R4,#02H
0A9C 900000      R     MOV     DPTR,#pos_error_sum
0A9F 120000      E     LCALL   ?C?LSTXDATA
0AA2 802A              SJMP    ?C0079
0AA4         ?C0078:
                                           ; SOURCE LINE # 533
                                           ; SOURCE LINE # 534
0AA4 7F80              MOV     R7,#080H
0AA6 7E0F              MOV     R6,#0FH
0AA8 7D05              MOV     R5,#05H
0AAA 7CFD              MOV     R4,#0FDH
0AAC 900000      R     MOV     DPTR,#pos_error_sum
0AAF E0                MOVX    A,@DPTR
0AB0 F8                MOV     R0,A
0AB1 A3                INC     DPTR
0AB2 E0                MOVX    A,@DPTR
0AB3 F9                MOV     R1,A
0AB4 A3                INC     DPTR
0AB5 E0                MOVX    A,@DPTR
0AB6 FA                MOV     R2,A
0AB7 A3                INC     DPTR
0AB8 E0                MOVX    A,@DPTR
0AB9 FB                MOV     R3,A
0ABA C3                CLR     C
0ABB 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 61  

0ABE 500E              JNC     ?C0079
                                           ; SOURCE LINE # 535
0AC0 7F80              MOV     R7,#080H
0AC2 7E0F              MOV     R6,#0FH
0AC4 7D05              MOV     R5,#05H
0AC6 7CFD              MOV     R4,#0FDH
0AC8 900000      R     MOV     DPTR,#pos_error_sum
0ACB 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 536
0ACE         ?C0079:
                                           ; SOURCE LINE # 540
0ACE E4                CLR     A
0ACF F500        R     MOV     i_ref+03H,A
0AD1 F500        R     MOV     i_ref+02H,A
0AD3 F500        R     MOV     i_ref+01H,A
0AD5 F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 543
0AD7 FF                MOV     R7,A
0AD8 FE                MOV     R6,A
0AD9 FD                MOV     R5,A
0ADA FC                MOV     R4,A
0ADB AB00        R     MOV     R3,k_p_dl+03H
0ADD AA00        R     MOV     R2,k_p_dl+02H
0ADF A900        R     MOV     R1,k_p_dl+01H
0AE1 A800        R     MOV     R0,k_p_dl
0AE3 C3                CLR     C
0AE4 120000      E     LCALL   ?C?SLCMP
0AE7 6026              JZ      ?C0081
                                           ; SOURCE LINE # 544
0AE9 AF00        R     MOV     R7,pos_error+03H
0AEB AE00        R     MOV     R6,pos_error+02H
0AED AD00        R     MOV     R5,pos_error+01H
0AEF AC00        R     MOV     R4,pos_error
0AF1 A800        R     MOV     R0,k_p_dl
0AF3 120000      E     LCALL   ?C?LMUL
0AF6 7810              MOV     R0,#010H
0AF8 120000      E     LCALL   ?C?SLSHR
0AFB E500        R     MOV     A,i_ref+03H
0AFD 2F                ADD     A,R7
0AFE F500        R     MOV     i_ref+03H,A
0B00 E500        R     MOV     A,i_ref+02H
0B02 3E                ADDC    A,R6
0B03 F500        R     MOV     i_ref+02H,A
0B05 E500        R     MOV     A,i_ref+01H
0B07 3D                ADDC    A,R5
0B08 F500        R     MOV     i_ref+01H,A
0B0A E500        R     MOV     A,i_ref
0B0C 3C                ADDC    A,R4
0B0D F500        R     MOV     i_ref,A
0B0F         ?C0081:
                                           ; SOURCE LINE # 547
0B0F E4                CLR     A
0B10 FF                MOV     R7,A
0B11 FE                MOV     R6,A
0B12 FD                MOV     R5,A
0B13 FC                MOV     R4,A
0B14 AB00        R     MOV     R3,k_i_dl+03H
0B16 AA00        R     MOV     R2,k_i_dl+02H
0B18 A900        R     MOV     R1,k_i_dl+01H
0B1A A800        R     MOV     R0,k_i_dl
0B1C C3                CLR     C
0B1D 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 62  

0B20 6031              JZ      ?C0082
                                           ; SOURCE LINE # 548
0B22 900000      R     MOV     DPTR,#pos_error_sum
0B25 E0                MOVX    A,@DPTR
0B26 FC                MOV     R4,A
0B27 A3                INC     DPTR
0B28 E0                MOVX    A,@DPTR
0B29 FD                MOV     R5,A
0B2A A3                INC     DPTR
0B2B E0                MOVX    A,@DPTR
0B2C FE                MOV     R6,A
0B2D A3                INC     DPTR
0B2E E0                MOVX    A,@DPTR
0B2F FF                MOV     R7,A
0B30 7806              MOV     R0,#06H
0B32 120000      E     LCALL   ?C?SLSHR
0B35 A800        R     MOV     R0,k_i_dl
0B37 120000      E     LCALL   ?C?LMUL
0B3A 780A              MOV     R0,#0AH
0B3C 120000      E     LCALL   ?C?SLSHR
0B3F E500        R     MOV     A,i_ref+03H
0B41 2F                ADD     A,R7
0B42 F500        R     MOV     i_ref+03H,A
0B44 E500        R     MOV     A,i_ref+02H
0B46 3E                ADDC    A,R6
0B47 F500        R     MOV     i_ref+02H,A
0B49 E500        R     MOV     A,i_ref+01H
0B4B 3D                ADDC    A,R5
0B4C F500        R     MOV     i_ref+01H,A
0B4E E500        R     MOV     A,i_ref
0B50 3C                ADDC    A,R4
0B51 F500        R     MOV     i_ref,A
0B53         ?C0082:
                                           ; SOURCE LINE # 551
0B53 E4                CLR     A
0B54 FF                MOV     R7,A
0B55 FE                MOV     R6,A
0B56 FD                MOV     R5,A
0B57 FC                MOV     R4,A
0B58 AB00        R     MOV     R3,k_d_dl+03H
0B5A AA00        R     MOV     R2,k_d_dl+02H
0B5C A900        R     MOV     R1,k_d_dl+01H
0B5E A800        R     MOV     R0,k_d_dl
0B60 C3                CLR     C
0B61 120000      E     LCALL   ?C?SLCMP
0B64 6043              JZ      ?C0083
                                           ; SOURCE LINE # 552
0B66 900000      R     MOV     DPTR,#prev_pos_err
0B69 E0                MOVX    A,@DPTR
0B6A F8                MOV     R0,A
0B6B A3                INC     DPTR
0B6C E0                MOVX    A,@DPTR
0B6D F9                MOV     R1,A
0B6E A3                INC     DPTR
0B6F E0                MOVX    A,@DPTR
0B70 FA                MOV     R2,A
0B71 A3                INC     DPTR
0B72 E0                MOVX    A,@DPTR
0B73 FB                MOV     R3,A
0B74 C3                CLR     C
0B75 E500        R     MOV     A,pos_error+03H
0B77 9B                SUBB    A,R3
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 63  

0B78 FF                MOV     R7,A
0B79 E500        R     MOV     A,pos_error+02H
0B7B 9A                SUBB    A,R2
0B7C FE                MOV     R6,A
0B7D E500        R     MOV     A,pos_error+01H
0B7F 99                SUBB    A,R1
0B80 FD                MOV     R5,A
0B81 E500        R     MOV     A,pos_error
0B83 98                SUBB    A,R0
0B84 FC                MOV     R4,A
0B85 AB00        R     MOV     R3,k_d_dl+03H
0B87 AA00        R     MOV     R2,k_d_dl+02H
0B89 A900        R     MOV     R1,k_d_dl+01H
0B8B A800        R     MOV     R0,k_d_dl
0B8D 120000      E     LCALL   ?C?LMUL
0B90 7810              MOV     R0,#010H
0B92 120000      E     LCALL   ?C?SLSHR
0B95 E500        R     MOV     A,i_ref+03H
0B97 2F                ADD     A,R7
0B98 F500        R     MOV     i_ref+03H,A
0B9A E500        R     MOV     A,i_ref+02H
0B9C 3E                ADDC    A,R6
0B9D F500        R     MOV     i_ref+02H,A
0B9F E500        R     MOV     A,i_ref+01H
0BA1 3D                ADDC    A,R5
0BA2 F500        R     MOV     i_ref+01H,A
0BA4 E500        R     MOV     A,i_ref
0BA6 3C                ADDC    A,R4
0BA7 F500        R     MOV     i_ref,A
0BA9         ?C0083:
                                           ; SOURCE LINE # 555
0BA9 AF00        R     MOV     R7,pos_error+03H
0BAB AE00        R     MOV     R6,pos_error+02H
0BAD AD00        R     MOV     R5,pos_error+01H
0BAF AC00        R     MOV     R4,pos_error
0BB1 900000      R     MOV     DPTR,#prev_pos_err
0BB4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 561
0BB7 E4                CLR     A
0BB8 FF                MOV     R7,A
0BB9 FE                MOV     R6,A
0BBA FD                MOV     R5,A
0BBB FC                MOV     R4,A
0BBC AB00        R     MOV     R3,i_ref+03H
0BBE AA00        R     MOV     R2,i_ref+02H
0BC0 A900        R     MOV     R1,i_ref+01H
0BC2 A800        R     MOV     R0,i_ref
0BC4 C3                CLR     C
0BC5 120000      E     LCALL   ?C?SLCMP
0BC8 4004              JC      ?C0084
                                           ; SOURCE LINE # 562
0BCA D200        R     SETB    motor_dir
0BCC 8002              SJMP    ?C0085
0BCE         ?C0084:
                                           ; SOURCE LINE # 564
0BCE C200        R     CLR     motor_dir
0BD0         ?C0085:
                                           ; SOURCE LINE # 570
0BD0 900000      E     MOV     DPTR,#c_mem+069H
0BD3 E0                MOVX    A,@DPTR
0BD4 FE                MOV     R6,A
0BD5 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 64  

0BD6 E0                MOVX    A,@DPTR
0BD7 FF                MOV     R7,A
0BD8 EE                MOV     A,R6
0BD9 33                RLC     A
0BDA 95E0              SUBB    A,ACC
0BDC FD                MOV     R5,A
0BDD FC                MOV     R4,A
0BDE AB00        R     MOV     R3,i_ref+03H
0BE0 AA00        R     MOV     R2,i_ref+02H
0BE2 A900        R     MOV     R1,i_ref+01H
0BE4 A800        R     MOV     R0,i_ref
0BE6 D3                SETB    C
0BE7 120000      E     LCALL   ?C?SLCMP
0BEA 4016              JC      ?C0086
                                           ; SOURCE LINE # 571
0BEC 900000      E     MOV     DPTR,#c_mem+069H
0BEF E0                MOVX    A,@DPTR
0BF0 FE                MOV     R6,A
0BF1 A3                INC     DPTR
0BF2 E0                MOVX    A,@DPTR
0BF3 FF                MOV     R7,A
0BF4 EE                MOV     A,R6
0BF5 33                RLC     A
0BF6 95E0              SUBB    A,ACC
0BF8 8F00        R     MOV     i_ref+03H,R7
0BFA 8E00        R     MOV     i_ref+02H,R6
0BFC F500        R     MOV     i_ref+01H,A
0BFE F500        R     MOV     i_ref,A
0C00 803C              SJMP    ?C0087
0C02         ?C0086:
                                           ; SOURCE LINE # 573
0C02 900000      E     MOV     DPTR,#c_mem+069H
0C05 E0                MOVX    A,@DPTR
0C06 FE                MOV     R6,A
0C07 A3                INC     DPTR
0C08 E0                MOVX    A,@DPTR
0C09 FF                MOV     R7,A
0C0A C3                CLR     C
0C0B E4                CLR     A
0C0C 9F                SUBB    A,R7
0C0D FF                MOV     R7,A
0C0E E4                CLR     A
0C0F 9E                SUBB    A,R6
0C10 FE                MOV     R6,A
0C11 33                RLC     A
0C12 95E0              SUBB    A,ACC
0C14 FD                MOV     R5,A
0C15 FC                MOV     R4,A
0C16 AB00        R     MOV     R3,i_ref+03H
0C18 AA00        R     MOV     R2,i_ref+02H
0C1A A900        R     MOV     R1,i_ref+01H
0C1C A800        R     MOV     R0,i_ref
0C1E C3                CLR     C
0C1F 120000      E     LCALL   ?C?SLCMP
0C22 501A              JNC     ?C0087
                                           ; SOURCE LINE # 574
0C24 900000      E     MOV     DPTR,#c_mem+069H
0C27 E0                MOVX    A,@DPTR
0C28 FE                MOV     R6,A
0C29 A3                INC     DPTR
0C2A E0                MOVX    A,@DPTR
0C2B FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 65  

0C2C C3                CLR     C
0C2D E4                CLR     A
0C2E 9F                SUBB    A,R7
0C2F FF                MOV     R7,A
0C30 E4                CLR     A
0C31 9E                SUBB    A,R6
0C32 FE                MOV     R6,A
0C33 33                RLC     A
0C34 95E0              SUBB    A,ACC
0C36 8F00        R     MOV     i_ref+03H,R7
0C38 8E00        R     MOV     i_ref+02H,R6
0C3A F500        R     MOV     i_ref+01H,A
0C3C F500        R     MOV     i_ref,A
0C3E         ?C0087:
                                           ; SOURCE LINE # 586
0C3E 900000      E     MOV     DPTR,#g_meas+0CH
0C41 E0                MOVX    A,@DPTR
0C42 F8                MOV     R0,A
0C43 A3                INC     DPTR
0C44 E0                MOVX    A,@DPTR
0C45 F9                MOV     R1,A
0C46 A3                INC     DPTR
0C47 E0                MOVX    A,@DPTR
0C48 FA                MOV     R2,A
0C49 A3                INC     DPTR
0C4A E0                MOVX    A,@DPTR
0C4B FB                MOV     R3,A
0C4C C3                CLR     C
0C4D E500        R     MOV     A,i_ref+03H
0C4F 9B                SUBB    A,R3
0C50 F500        R     MOV     curr_error+03H,A
0C52 E500        R     MOV     A,i_ref+02H
0C54 9A                SUBB    A,R2
0C55 F500        R     MOV     curr_error+02H,A
0C57 E500        R     MOV     A,i_ref+01H
0C59 99                SUBB    A,R1
0C5A F500        R     MOV     curr_error+01H,A
0C5C E500        R     MOV     A,i_ref
0C5E 98                SUBB    A,R0
0C5F F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 587
0C61 900000      R     MOV     DPTR,#curr_error_sum
0C64 E0                MOVX    A,@DPTR
0C65 FC                MOV     R4,A
0C66 A3                INC     DPTR
0C67 E0                MOVX    A,@DPTR
0C68 FD                MOV     R5,A
0C69 A3                INC     DPTR
0C6A E0                MOVX    A,@DPTR
0C6B FE                MOV     R6,A
0C6C A3                INC     DPTR
0C6D E0                MOVX    A,@DPTR
0C6E 2500        R     ADD     A,curr_error+03H
0C70 FF                MOV     R7,A
0C71 EE                MOV     A,R6
0C72 3500        R     ADDC    A,curr_error+02H
0C74 FE                MOV     R6,A
0C75 ED                MOV     A,R5
0C76 3500        R     ADDC    A,curr_error+01H
0C78 FD                MOV     R5,A
0C79 EC                MOV     A,R4
0C7A 3500        R     ADDC    A,curr_error
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 66  

0C7C FC                MOV     R4,A
0C7D 900000      R     MOV     DPTR,#curr_error_sum
0C80 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 589
0C83 7FA0              MOV     R7,#0A0H
0C85 7E86              MOV     R6,#086H
0C87 7D01              MOV     R5,#01H
0C89 7C00              MOV     R4,#00H
0C8B 900000      R     MOV     DPTR,#curr_error_sum
0C8E E0                MOVX    A,@DPTR
0C8F F8                MOV     R0,A
0C90 A3                INC     DPTR
0C91 E0                MOVX    A,@DPTR
0C92 F9                MOV     R1,A
0C93 A3                INC     DPTR
0C94 E0                MOVX    A,@DPTR
0C95 FA                MOV     R2,A
0C96 A3                INC     DPTR
0C97 E0                MOVX    A,@DPTR
0C98 FB                MOV     R3,A
0C99 D3                SETB    C
0C9A 120000      E     LCALL   ?C?SLCMP
0C9D 4010              JC      ?C0089
                                           ; SOURCE LINE # 590
0C9F 7FA0              MOV     R7,#0A0H
0CA1 7E86              MOV     R6,#086H
0CA3 7D01              MOV     R5,#01H
0CA5 7C00              MOV     R4,#00H
0CA7 900000      R     MOV     DPTR,#curr_error_sum
0CAA 120000      E     LCALL   ?C?LSTXDATA
0CAD 802A              SJMP    ?C0090
0CAF         ?C0089:
                                           ; SOURCE LINE # 591
                                           ; SOURCE LINE # 592
0CAF 7F60              MOV     R7,#060H
0CB1 7E79              MOV     R6,#079H
0CB3 7DFE              MOV     R5,#0FEH
0CB5 7CFF              MOV     R4,#0FFH
0CB7 900000      R     MOV     DPTR,#curr_error_sum
0CBA E0                MOVX    A,@DPTR
0CBB F8                MOV     R0,A
0CBC A3                INC     DPTR
0CBD E0                MOVX    A,@DPTR
0CBE F9                MOV     R1,A
0CBF A3                INC     DPTR
0CC0 E0                MOVX    A,@DPTR
0CC1 FA                MOV     R2,A
0CC2 A3                INC     DPTR
0CC3 E0                MOVX    A,@DPTR
0CC4 FB                MOV     R3,A
0CC5 C3                CLR     C
0CC6 120000      E     LCALL   ?C?SLCMP
0CC9 500E              JNC     ?C0090
                                           ; SOURCE LINE # 593
0CCB 7F60              MOV     R7,#060H
0CCD 7E79              MOV     R6,#079H
0CCF 7DFE              MOV     R5,#0FEH
0CD1 7CFF              MOV     R4,#0FFH
0CD3 900000      R     MOV     DPTR,#curr_error_sum
0CD6 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 594
0CD9         ?C0090:
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 67  

                                           ; SOURCE LINE # 598
0CD9 E4                CLR     A
0CDA F500        R     MOV     pwm_input+03H,A
0CDC F500        R     MOV     pwm_input+02H,A
0CDE F500        R     MOV     pwm_input+01H,A
0CE0 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 601
0CE2 FF                MOV     R7,A
0CE3 FE                MOV     R6,A
0CE4 FD                MOV     R5,A
0CE5 FC                MOV     R4,A
0CE6 AB00        R     MOV     R3,k_p_c_dl+03H
0CE8 AA00        R     MOV     R2,k_p_c_dl+02H
0CEA A900        R     MOV     R1,k_p_c_dl+01H
0CEC A800        R     MOV     R0,k_p_c_dl
0CEE C3                CLR     C
0CEF 120000      E     LCALL   ?C?SLCMP
0CF2 6026              JZ      ?C0092
                                           ; SOURCE LINE # 602
0CF4 AF00        R     MOV     R7,curr_error+03H
0CF6 AE00        R     MOV     R6,curr_error+02H
0CF8 AD00        R     MOV     R5,curr_error+01H
0CFA AC00        R     MOV     R4,curr_error
0CFC A800        R     MOV     R0,k_p_c_dl
0CFE 120000      E     LCALL   ?C?LMUL
0D01 7810              MOV     R0,#010H
0D03 120000      E     LCALL   ?C?SLSHR
0D06 E500        R     MOV     A,pwm_input+03H
0D08 2F                ADD     A,R7
0D09 F500        R     MOV     pwm_input+03H,A
0D0B E500        R     MOV     A,pwm_input+02H
0D0D 3E                ADDC    A,R6
0D0E F500        R     MOV     pwm_input+02H,A
0D10 E500        R     MOV     A,pwm_input+01H
0D12 3D                ADDC    A,R5
0D13 F500        R     MOV     pwm_input+01H,A
0D15 E500        R     MOV     A,pwm_input
0D17 3C                ADDC    A,R4
0D18 F500        R     MOV     pwm_input,A
0D1A         ?C0092:
                                           ; SOURCE LINE # 605
0D1A E4                CLR     A
0D1B FF                MOV     R7,A
0D1C FE                MOV     R6,A
0D1D FD                MOV     R5,A
0D1E FC                MOV     R4,A
0D1F AB00        R     MOV     R3,k_i_c_dl+03H
0D21 AA00        R     MOV     R2,k_i_c_dl+02H
0D23 A900        R     MOV     R1,k_i_c_dl+01H
0D25 A800        R     MOV     R0,k_i_c_dl
0D27 C3                CLR     C
0D28 120000      E     LCALL   ?C?SLCMP
0D2B 6031              JZ      ?C0093
                                           ; SOURCE LINE # 606
0D2D 900000      R     MOV     DPTR,#curr_error_sum
0D30 E0                MOVX    A,@DPTR
0D31 FC                MOV     R4,A
0D32 A3                INC     DPTR
0D33 E0                MOVX    A,@DPTR
0D34 FD                MOV     R5,A
0D35 A3                INC     DPTR
0D36 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 68  

0D37 FE                MOV     R6,A
0D38 A3                INC     DPTR
0D39 E0                MOVX    A,@DPTR
0D3A FF                MOV     R7,A
0D3B 7806              MOV     R0,#06H
0D3D 120000      E     LCALL   ?C?SLSHR
0D40 A800        R     MOV     R0,k_i_c_dl
0D42 120000      E     LCALL   ?C?LMUL
0D45 780A              MOV     R0,#0AH
0D47 120000      E     LCALL   ?C?SLSHR
0D4A E500        R     MOV     A,pwm_input+03H
0D4C 2F                ADD     A,R7
0D4D F500        R     MOV     pwm_input+03H,A
0D4F E500        R     MOV     A,pwm_input+02H
0D51 3E                ADDC    A,R6
0D52 F500        R     MOV     pwm_input+02H,A
0D54 E500        R     MOV     A,pwm_input+01H
0D56 3D                ADDC    A,R5
0D57 F500        R     MOV     pwm_input+01H,A
0D59 E500        R     MOV     A,pwm_input
0D5B 3C                ADDC    A,R4
0D5C F500        R     MOV     pwm_input,A
0D5E         ?C0093:
                                           ; SOURCE LINE # 609
0D5E E4                CLR     A
0D5F FF                MOV     R7,A
0D60 FE                MOV     R6,A
0D61 FD                MOV     R5,A
0D62 FC                MOV     R4,A
0D63 AB00        R     MOV     R3,k_d_c_dl+03H
0D65 AA00        R     MOV     R2,k_d_c_dl+02H
0D67 A900        R     MOV     R1,k_d_c_dl+01H
0D69 A800        R     MOV     R0,k_d_c_dl
0D6B C3                CLR     C
0D6C 120000      E     LCALL   ?C?SLCMP
0D6F 6043              JZ      ?C0094
                                           ; SOURCE LINE # 610
0D71 900000      R     MOV     DPTR,#prev_curr_err
0D74 E0                MOVX    A,@DPTR
0D75 F8                MOV     R0,A
0D76 A3                INC     DPTR
0D77 E0                MOVX    A,@DPTR
0D78 F9                MOV     R1,A
0D79 A3                INC     DPTR
0D7A E0                MOVX    A,@DPTR
0D7B FA                MOV     R2,A
0D7C A3                INC     DPTR
0D7D E0                MOVX    A,@DPTR
0D7E FB                MOV     R3,A
0D7F C3                CLR     C
0D80 E500        R     MOV     A,curr_error+03H
0D82 9B                SUBB    A,R3
0D83 FF                MOV     R7,A
0D84 E500        R     MOV     A,curr_error+02H
0D86 9A                SUBB    A,R2
0D87 FE                MOV     R6,A
0D88 E500        R     MOV     A,curr_error+01H
0D8A 99                SUBB    A,R1
0D8B FD                MOV     R5,A
0D8C E500        R     MOV     A,curr_error
0D8E 98                SUBB    A,R0
0D8F FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 69  

0D90 AB00        R     MOV     R3,k_d_c_dl+03H
0D92 AA00        R     MOV     R2,k_d_c_dl+02H
0D94 A900        R     MOV     R1,k_d_c_dl+01H
0D96 A800        R     MOV     R0,k_d_c_dl
0D98 120000      E     LCALL   ?C?LMUL
0D9B 7810              MOV     R0,#010H
0D9D 120000      E     LCALL   ?C?SLSHR
0DA0 E500        R     MOV     A,pwm_input+03H
0DA2 2F                ADD     A,R7
0DA3 F500        R     MOV     pwm_input+03H,A
0DA5 E500        R     MOV     A,pwm_input+02H
0DA7 3E                ADDC    A,R6
0DA8 F500        R     MOV     pwm_input+02H,A
0DAA E500        R     MOV     A,pwm_input+01H
0DAC 3D                ADDC    A,R5
0DAD F500        R     MOV     pwm_input+01H,A
0DAF E500        R     MOV     A,pwm_input
0DB1 3C                ADDC    A,R4
0DB2 F500        R     MOV     pwm_input,A
0DB4         ?C0094:
                                           ; SOURCE LINE # 613
0DB4 74FF              MOV     A,#0FFH
0DB6 7F9C              MOV     R7,#09CH
0DB8 FE                MOV     R6,A
0DB9 FD                MOV     R5,A
0DBA FC                MOV     R4,A
0DBB AB00        R     MOV     R3,pwm_input+03H
0DBD AA00        R     MOV     R2,pwm_input+02H
0DBF A900        R     MOV     R1,pwm_input+01H
0DC1 A800        R     MOV     R0,pwm_input
0DC3 C3                CLR     C
0DC4 120000      E     LCALL   ?C?SLCMP
0DC7 500D              JNC     ?C0095
                                           ; SOURCE LINE # 614
0DC9 74FF              MOV     A,#0FFH
0DCB 75009C      R     MOV     pwm_input+03H,#09CH
0DCE F500        R     MOV     pwm_input+02H,A
0DD0 F500        R     MOV     pwm_input+01H,A
0DD2 F500        R     MOV     pwm_input,A
0DD4 801E              SJMP    ?C0096
0DD6         ?C0095:
                                           ; SOURCE LINE # 615
                                           ; SOURCE LINE # 616
0DD6 E4                CLR     A
0DD7 7F64              MOV     R7,#064H
0DD9 FE                MOV     R6,A
0DDA FD                MOV     R5,A
0DDB FC                MOV     R4,A
0DDC AB00        R     MOV     R3,pwm_input+03H
0DDE AA00        R     MOV     R2,pwm_input+02H
0DE0 A900        R     MOV     R1,pwm_input+01H
0DE2 A800        R     MOV     R0,pwm_input
0DE4 D3                SETB    C
0DE5 120000      E     LCALL   ?C?SLCMP
0DE8 400A              JC      ?C0096
                                           ; SOURCE LINE # 617
0DEA E4                CLR     A
0DEB 750064      R     MOV     pwm_input+03H,#064H
0DEE F500        R     MOV     pwm_input+02H,A
0DF0 F500        R     MOV     pwm_input+01H,A
0DF2 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 618
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 70  

0DF4         ?C0096:
                                           ; SOURCE LINE # 621
0DF4 AF00        R     MOV     R7,curr_error+03H
0DF6 AE00        R     MOV     R6,curr_error+02H
0DF8 AD00        R     MOV     R5,curr_error+01H
0DFA AC00        R     MOV     R4,curr_error
0DFC 900000      R     MOV     DPTR,#prev_curr_err
0DFF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 623
0E02 020000      R     LJMP    ?C0076
                                           ; SOURCE LINE # 626
0E05         ?C0098:
                                           ; SOURCE LINE # 627
0E05 900000      E     MOV     DPTR,#g_meas
0E08 E0                MOVX    A,@DPTR
0E09 F8                MOV     R0,A
0E0A A3                INC     DPTR
0E0B E0                MOVX    A,@DPTR
0E0C F9                MOV     R1,A
0E0D A3                INC     DPTR
0E0E E0                MOVX    A,@DPTR
0E0F FA                MOV     R2,A
0E10 A3                INC     DPTR
0E11 E0                MOVX    A,@DPTR
0E12 FB                MOV     R3,A
0E13 900000      E     MOV     DPTR,#g_ref
0E16 E0                MOVX    A,@DPTR
0E17 FC                MOV     R4,A
0E18 A3                INC     DPTR
0E19 E0                MOVX    A,@DPTR
0E1A FD                MOV     R5,A
0E1B A3                INC     DPTR
0E1C E0                MOVX    A,@DPTR
0E1D FE                MOV     R6,A
0E1E A3                INC     DPTR
0E1F E0                MOVX    A,@DPTR
0E20 C3                CLR     C
0E21 9B                SUBB    A,R3
0E22 F500        R     MOV     pos_error+03H,A
0E24 EE                MOV     A,R6
0E25 9A                SUBB    A,R2
0E26 F500        R     MOV     pos_error+02H,A
0E28 ED                MOV     A,R5
0E29 99                SUBB    A,R1
0E2A F500        R     MOV     pos_error+01H,A
0E2C EC                MOV     A,R4
0E2D 98                SUBB    A,R0
0E2E F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 629
0E30 900000      R     MOV     DPTR,#pos_error_sum
0E33 E0                MOVX    A,@DPTR
0E34 FC                MOV     R4,A
0E35 A3                INC     DPTR
0E36 E0                MOVX    A,@DPTR
0E37 FD                MOV     R5,A
0E38 A3                INC     DPTR
0E39 E0                MOVX    A,@DPTR
0E3A FE                MOV     R6,A
0E3B A3                INC     DPTR
0E3C E0                MOVX    A,@DPTR
0E3D 2500        R     ADD     A,pos_error+03H
0E3F FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 71  

0E40 EE                MOV     A,R6
0E41 3500        R     ADDC    A,pos_error+02H
0E43 FE                MOV     R6,A
0E44 ED                MOV     A,R5
0E45 3500        R     ADDC    A,pos_error+01H
0E47 FD                MOV     R5,A
0E48 EC                MOV     A,R4
0E49 3500        R     ADDC    A,pos_error
0E4B FC                MOV     R4,A
0E4C 900000      R     MOV     DPTR,#pos_error_sum
0E4F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 632
0E52 E4                CLR     A
0E53 7FE8              MOV     R7,#0E8H
0E55 7E03              MOV     R6,#03H
0E57 FD                MOV     R5,A
0E58 FC                MOV     R4,A
0E59 900000      R     MOV     DPTR,#pos_error_sum
0E5C E0                MOVX    A,@DPTR
0E5D F8                MOV     R0,A
0E5E A3                INC     DPTR
0E5F E0                MOVX    A,@DPTR
0E60 F9                MOV     R1,A
0E61 A3                INC     DPTR
0E62 E0                MOVX    A,@DPTR
0E63 FA                MOV     R2,A
0E64 A3                INC     DPTR
0E65 E0                MOVX    A,@DPTR
0E66 FB                MOV     R3,A
0E67 D3                SETB    C
0E68 120000      E     LCALL   ?C?SLCMP
0E6B 400F              JC      ?C0099
                                           ; SOURCE LINE # 633
0E6D E4                CLR     A
0E6E 7FE8              MOV     R7,#0E8H
0E70 7E03              MOV     R6,#03H
0E72 FD                MOV     R5,A
0E73 FC                MOV     R4,A
0E74 900000      R     MOV     DPTR,#pos_error_sum
0E77 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 634
0E7A 802A              SJMP    ?C0100
0E7C         ?C0099:
0E7C 7F18              MOV     R7,#018H
0E7E 7EFC              MOV     R6,#0FCH
0E80 7DFF              MOV     R5,#0FFH
0E82 7CFF              MOV     R4,#0FFH
0E84 900000      R     MOV     DPTR,#pos_error_sum
0E87 E0                MOVX    A,@DPTR
0E88 F8                MOV     R0,A
0E89 A3                INC     DPTR
0E8A E0                MOVX    A,@DPTR
0E8B F9                MOV     R1,A
0E8C A3                INC     DPTR
0E8D E0                MOVX    A,@DPTR
0E8E FA                MOV     R2,A
0E8F A3                INC     DPTR
0E90 E0                MOVX    A,@DPTR
0E91 FB                MOV     R3,A
0E92 C3                CLR     C
0E93 120000      E     LCALL   ?C?SLCMP
0E96 500E              JNC     ?C0100
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 72  

                                           ; SOURCE LINE # 635
0E98 7F18              MOV     R7,#018H
0E9A 7EFC              MOV     R6,#0FCH
0E9C 7DFF              MOV     R5,#0FFH
0E9E 7CFF              MOV     R4,#0FFH
0EA0 900000      R     MOV     DPTR,#pos_error_sum
0EA3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 636
0EA6         ?C0100:
                                           ; SOURCE LINE # 639
0EA6 E4                CLR     A
0EA7 FF                MOV     R7,A
0EA8 FE                MOV     R6,A
0EA9 FD                MOV     R5,A
0EAA FC                MOV     R4,A
0EAB AB00        R     MOV     R3,k_p+03H
0EAD AA00        R     MOV     R2,k_p+02H
0EAF A900        R     MOV     R1,k_p+01H
0EB1 A800        R     MOV     R0,k_p
0EB3 C3                CLR     C
0EB4 120000      E     LCALL   ?C?SLCMP
0EB7 601A              JZ      ?C0102
                                           ; SOURCE LINE # 640
0EB9 AF00        R     MOV     R7,pos_error+03H
0EBB AE00        R     MOV     R6,pos_error+02H
0EBD AD00        R     MOV     R5,pos_error+01H
0EBF AC00        R     MOV     R4,pos_error
0EC1 A800        R     MOV     R0,k_p
0EC3 120000      E     LCALL   ?C?LMUL
0EC6 7810              MOV     R0,#010H
0EC8 120000      E     LCALL   ?C?SLSHR
0ECB 8F00        R     MOV     pwm_input+03H,R7
0ECD 8E00        R     MOV     pwm_input+02H,R6
0ECF 8D00        R     MOV     pwm_input+01H,R5
0ED1 8C00        R     MOV     pwm_input,R4
0ED3         ?C0102:
                                           ; SOURCE LINE # 644
0ED3 E4                CLR     A
0ED4 FF                MOV     R7,A
0ED5 FE                MOV     R6,A
0ED6 FD                MOV     R5,A
0ED7 FC                MOV     R4,A
0ED8 AB00        R     MOV     R3,k_i+03H
0EDA AA00        R     MOV     R2,k_i+02H
0EDC A900        R     MOV     R1,k_i+01H
0EDE A800        R     MOV     R0,k_i
0EE0 C3                CLR     C
0EE1 120000      E     LCALL   ?C?SLCMP
0EE4 6031              JZ      ?C0103
                                           ; SOURCE LINE # 645
0EE6 900000      R     MOV     DPTR,#pos_error_sum
0EE9 E0                MOVX    A,@DPTR
0EEA FC                MOV     R4,A
0EEB A3                INC     DPTR
0EEC E0                MOVX    A,@DPTR
0EED FD                MOV     R5,A
0EEE A3                INC     DPTR
0EEF E0                MOVX    A,@DPTR
0EF0 FE                MOV     R6,A
0EF1 A3                INC     DPTR
0EF2 E0                MOVX    A,@DPTR
0EF3 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 73  

0EF4 7806              MOV     R0,#06H
0EF6 120000      E     LCALL   ?C?SLSHR
0EF9 A800        R     MOV     R0,k_i
0EFB 120000      E     LCALL   ?C?LMUL
0EFE 780A              MOV     R0,#0AH
0F00 120000      E     LCALL   ?C?SLSHR
0F03 E500        R     MOV     A,pwm_input+03H
0F05 2F                ADD     A,R7
0F06 F500        R     MOV     pwm_input+03H,A
0F08 E500        R     MOV     A,pwm_input+02H
0F0A 3E                ADDC    A,R6
0F0B F500        R     MOV     pwm_input+02H,A
0F0D E500        R     MOV     A,pwm_input+01H
0F0F 3D                ADDC    A,R5
0F10 F500        R     MOV     pwm_input+01H,A
0F12 E500        R     MOV     A,pwm_input
0F14 3C                ADDC    A,R4
0F15 F500        R     MOV     pwm_input,A
0F17         ?C0103:
                                           ; SOURCE LINE # 649
0F17 E4                CLR     A
0F18 FF                MOV     R7,A
0F19 FE                MOV     R6,A
0F1A FD                MOV     R5,A
0F1B FC                MOV     R4,A
0F1C AB00        R     MOV     R3,k_d+03H
0F1E AA00        R     MOV     R2,k_d+02H
0F20 A900        R     MOV     R1,k_d+01H
0F22 A800        R     MOV     R0,k_d
0F24 C3                CLR     C
0F25 120000      E     LCALL   ?C?SLCMP
0F28 6043              JZ      ?C0104
                                           ; SOURCE LINE # 650
0F2A 900000      R     MOV     DPTR,#prev_pos_err
0F2D E0                MOVX    A,@DPTR
0F2E F8                MOV     R0,A
0F2F A3                INC     DPTR
0F30 E0                MOVX    A,@DPTR
0F31 F9                MOV     R1,A
0F32 A3                INC     DPTR
0F33 E0                MOVX    A,@DPTR
0F34 FA                MOV     R2,A
0F35 A3                INC     DPTR
0F36 E0                MOVX    A,@DPTR
0F37 FB                MOV     R3,A
0F38 C3                CLR     C
0F39 E500        R     MOV     A,pos_error+03H
0F3B 9B                SUBB    A,R3
0F3C FF                MOV     R7,A
0F3D E500        R     MOV     A,pos_error+02H
0F3F 9A                SUBB    A,R2
0F40 FE                MOV     R6,A
0F41 E500        R     MOV     A,pos_error+01H
0F43 99                SUBB    A,R1
0F44 FD                MOV     R5,A
0F45 E500        R     MOV     A,pos_error
0F47 98                SUBB    A,R0
0F48 FC                MOV     R4,A
0F49 AB00        R     MOV     R3,k_d+03H
0F4B AA00        R     MOV     R2,k_d+02H
0F4D A900        R     MOV     R1,k_d+01H
0F4F A800        R     MOV     R0,k_d
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 74  

0F51 120000      E     LCALL   ?C?LMUL
0F54 7810              MOV     R0,#010H
0F56 120000      E     LCALL   ?C?SLSHR
0F59 E500        R     MOV     A,pwm_input+03H
0F5B 2F                ADD     A,R7
0F5C F500        R     MOV     pwm_input+03H,A
0F5E E500        R     MOV     A,pwm_input+02H
0F60 3E                ADDC    A,R6
0F61 F500        R     MOV     pwm_input+02H,A
0F63 E500        R     MOV     A,pwm_input+01H
0F65 3D                ADDC    A,R5
0F66 F500        R     MOV     pwm_input+01H,A
0F68 E500        R     MOV     A,pwm_input
0F6A 3C                ADDC    A,R4
0F6B F500        R     MOV     pwm_input,A
0F6D         ?C0104:
                                           ; SOURCE LINE # 654
0F6D AF00        R     MOV     R7,pos_error+03H
0F6F AE00        R     MOV     R6,pos_error+02H
0F71 AD00        R     MOV     R5,pos_error+01H
0F73 AC00        R     MOV     R4,pos_error
0F75 900000      R     MOV     DPTR,#prev_pos_err
0F78 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 656
0F7B E4                CLR     A
0F7C FF                MOV     R7,A
0F7D FE                MOV     R6,A
0F7E FD                MOV     R5,A
0F7F FC                MOV     R4,A
0F80 AB00        R     MOV     R3,pwm_input+03H
0F82 AA00        R     MOV     R2,pwm_input+02H
0F84 A900        R     MOV     R1,pwm_input+01H
0F86 A800        R     MOV     R0,pwm_input
0F88 D3                SETB    C
0F89 120000      E     LCALL   ?C?SLCMP
0F8C 4005              JC      ?C0105
                                           ; SOURCE LINE # 657
0F8E D200        R     SETB    motor_dir
0F90 020000      R     LJMP    ?C0076
0F93         ?C0105:
                                           ; SOURCE LINE # 659
0F93 C200        R     CLR     motor_dir
                                           ; SOURCE LINE # 661
0F95 020000      R     LJMP    ?C0076
                                           ; SOURCE LINE # 664
0F98         ?C0107:
                                           ; SOURCE LINE # 665
0F98 900000      E     MOV     DPTR,#g_ref+018H
0F9B E0                MOVX    A,@DPTR
0F9C 7003              JNZ     $ + 5H
0F9E 020000      R     LJMP    ?C0076
0FA1 200003      E     JB      tension_valid,$ + 6H
0FA4 020000      R     LJMP    ?C0076
                                           ; SOURCE LINE # 667
0FA7 900000      E     MOV     DPTR,#g_ref+08H
0FAA E0                MOVX    A,@DPTR
0FAB FC                MOV     R4,A
0FAC A3                INC     DPTR
0FAD E0                MOVX    A,@DPTR
0FAE FD                MOV     R5,A
0FAF A3                INC     DPTR
0FB0 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 75  

0FB1 FE                MOV     R6,A
0FB2 A3                INC     DPTR
0FB3 E0                MOVX    A,@DPTR
0FB4 F500        R     MOV     i_ref+03H,A
0FB6 8E00        R     MOV     i_ref+02H,R6
0FB8 8D00        R     MOV     i_ref+01H,R5
0FBA 8C00        R     MOV     i_ref,R4
                                           ; SOURCE LINE # 669
0FBC 900000      E     MOV     DPTR,#c_mem+069H
0FBF E0                MOVX    A,@DPTR
0FC0 FE                MOV     R6,A
0FC1 A3                INC     DPTR
0FC2 E0                MOVX    A,@DPTR
0FC3 FF                MOV     R7,A
0FC4 EE                MOV     A,R6
0FC5 33                RLC     A
0FC6 95E0              SUBB    A,ACC
0FC8 FD                MOV     R5,A
0FC9 FC                MOV     R4,A
0FCA AB00        R     MOV     R3,i_ref+03H
0FCC AA00        R     MOV     R2,i_ref+02H
0FCE A900        R     MOV     R1,i_ref+01H
0FD0 A800        R     MOV     R0,i_ref
0FD2 D3                SETB    C
0FD3 120000      E     LCALL   ?C?SLCMP
0FD6 4016              JC      ?C0109
                                           ; SOURCE LINE # 670
0FD8 900000      E     MOV     DPTR,#c_mem+069H
0FDB E0                MOVX    A,@DPTR
0FDC FE                MOV     R6,A
0FDD A3                INC     DPTR
0FDE E0                MOVX    A,@DPTR
0FDF FF                MOV     R7,A
0FE0 EE                MOV     A,R6
0FE1 33                RLC     A
0FE2 95E0              SUBB    A,ACC
0FE4 8F00        R     MOV     i_ref+03H,R7
0FE6 8E00        R     MOV     i_ref+02H,R6
0FE8 F500        R     MOV     i_ref+01H,A
0FEA F500        R     MOV     i_ref,A
0FEC 803C              SJMP    ?C0110
0FEE         ?C0109:
                                           ; SOURCE LINE # 671
                                           ; SOURCE LINE # 672
0FEE 900000      E     MOV     DPTR,#c_mem+069H
0FF1 E0                MOVX    A,@DPTR
0FF2 FE                MOV     R6,A
0FF3 A3                INC     DPTR
0FF4 E0                MOVX    A,@DPTR
0FF5 FF                MOV     R7,A
0FF6 C3                CLR     C
0FF7 E4                CLR     A
0FF8 9F                SUBB    A,R7
0FF9 FF                MOV     R7,A
0FFA E4                CLR     A
0FFB 9E                SUBB    A,R6
0FFC FE                MOV     R6,A
0FFD 33                RLC     A
0FFE 95E0              SUBB    A,ACC
1000 FD                MOV     R5,A
1001 FC                MOV     R4,A
1002 AB00        R     MOV     R3,i_ref+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 76  

1004 AA00        R     MOV     R2,i_ref+02H
1006 A900        R     MOV     R1,i_ref+01H
1008 A800        R     MOV     R0,i_ref
100A C3                CLR     C
100B 120000      E     LCALL   ?C?SLCMP
100E 501A              JNC     ?C0110
                                           ; SOURCE LINE # 673
1010 900000      E     MOV     DPTR,#c_mem+069H
1013 E0                MOVX    A,@DPTR
1014 FE                MOV     R6,A
1015 A3                INC     DPTR
1016 E0                MOVX    A,@DPTR
1017 FF                MOV     R7,A
1018 C3                CLR     C
1019 E4                CLR     A
101A 9F                SUBB    A,R7
101B FF                MOV     R7,A
101C E4                CLR     A
101D 9E                SUBB    A,R6
101E FE                MOV     R6,A
101F 33                RLC     A
1020 95E0              SUBB    A,ACC
1022 8F00        R     MOV     i_ref+03H,R7
1024 8E00        R     MOV     i_ref+02H,R6
1026 F500        R     MOV     i_ref+01H,A
1028 F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 674
102A         ?C0110:
                                           ; SOURCE LINE # 677
102A 900000      E     MOV     DPTR,#g_meas+0CH
102D E0                MOVX    A,@DPTR
102E F8                MOV     R0,A
102F A3                INC     DPTR
1030 E0                MOVX    A,@DPTR
1031 F9                MOV     R1,A
1032 A3                INC     DPTR
1033 E0                MOVX    A,@DPTR
1034 FA                MOV     R2,A
1035 A3                INC     DPTR
1036 E0                MOVX    A,@DPTR
1037 FB                MOV     R3,A
1038 C3                CLR     C
1039 E500        R     MOV     A,i_ref+03H
103B 9B                SUBB    A,R3
103C F500        R     MOV     curr_error+03H,A
103E E500        R     MOV     A,i_ref+02H
1040 9A                SUBB    A,R2
1041 F500        R     MOV     curr_error+02H,A
1043 E500        R     MOV     A,i_ref+01H
1045 99                SUBB    A,R1
1046 F500        R     MOV     curr_error+01H,A
1048 E500        R     MOV     A,i_ref
104A 98                SUBB    A,R0
104B F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 678
104D 900000      R     MOV     DPTR,#curr_error_sum
1050 E0                MOVX    A,@DPTR
1051 FC                MOV     R4,A
1052 A3                INC     DPTR
1053 E0                MOVX    A,@DPTR
1054 FD                MOV     R5,A
1055 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 77  

1056 E0                MOVX    A,@DPTR
1057 FE                MOV     R6,A
1058 A3                INC     DPTR
1059 E0                MOVX    A,@DPTR
105A 2500        R     ADD     A,curr_error+03H
105C FF                MOV     R7,A
105D EE                MOV     A,R6
105E 3500        R     ADDC    A,curr_error+02H
1060 FE                MOV     R6,A
1061 ED                MOV     A,R5
1062 3500        R     ADDC    A,curr_error+01H
1064 FD                MOV     R5,A
1065 EC                MOV     A,R4
1066 3500        R     ADDC    A,curr_error
1068 FC                MOV     R4,A
1069 900000      R     MOV     DPTR,#curr_error_sum
106C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 680
106F 7FA0              MOV     R7,#0A0H
1071 7E86              MOV     R6,#086H
1073 7D01              MOV     R5,#01H
1075 7C00              MOV     R4,#00H
1077 900000      R     MOV     DPTR,#curr_error_sum
107A E0                MOVX    A,@DPTR
107B F8                MOV     R0,A
107C A3                INC     DPTR
107D E0                MOVX    A,@DPTR
107E F9                MOV     R1,A
107F A3                INC     DPTR
1080 E0                MOVX    A,@DPTR
1081 FA                MOV     R2,A
1082 A3                INC     DPTR
1083 E0                MOVX    A,@DPTR
1084 FB                MOV     R3,A
1085 D3                SETB    C
1086 120000      E     LCALL   ?C?SLCMP
1089 4010              JC      ?C0112
                                           ; SOURCE LINE # 681
108B 7FA0              MOV     R7,#0A0H
108D 7E86              MOV     R6,#086H
108F 7D01              MOV     R5,#01H
1091 7C00              MOV     R4,#00H
1093 900000      R     MOV     DPTR,#curr_error_sum
1096 120000      E     LCALL   ?C?LSTXDATA
1099 802A              SJMP    ?C0113
109B         ?C0112:
                                           ; SOURCE LINE # 682
                                           ; SOURCE LINE # 683
109B 7F60              MOV     R7,#060H
109D 7E79              MOV     R6,#079H
109F 7DFE              MOV     R5,#0FEH
10A1 7CFF              MOV     R4,#0FFH
10A3 900000      R     MOV     DPTR,#curr_error_sum
10A6 E0                MOVX    A,@DPTR
10A7 F8                MOV     R0,A
10A8 A3                INC     DPTR
10A9 E0                MOVX    A,@DPTR
10AA F9                MOV     R1,A
10AB A3                INC     DPTR
10AC E0                MOVX    A,@DPTR
10AD FA                MOV     R2,A
10AE A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 78  

10AF E0                MOVX    A,@DPTR
10B0 FB                MOV     R3,A
10B1 C3                CLR     C
10B2 120000      E     LCALL   ?C?SLCMP
10B5 500E              JNC     ?C0113
                                           ; SOURCE LINE # 684
10B7 7F60              MOV     R7,#060H
10B9 7E79              MOV     R6,#079H
10BB 7DFE              MOV     R5,#0FEH
10BD 7CFF              MOV     R4,#0FFH
10BF 900000      R     MOV     DPTR,#curr_error_sum
10C2 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 685
10C5         ?C0113:
                                           ; SOURCE LINE # 687
10C5 E4                CLR     A
10C6 F500        R     MOV     pwm_input+03H,A
10C8 F500        R     MOV     pwm_input+02H,A
10CA F500        R     MOV     pwm_input+01H,A
10CC F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 690
10CE FF                MOV     R7,A
10CF FE                MOV     R6,A
10D0 FD                MOV     R5,A
10D1 FC                MOV     R4,A
10D2 AB00        R     MOV     R3,k_p_c+03H
10D4 AA00        R     MOV     R2,k_p_c+02H
10D6 A900        R     MOV     R1,k_p_c+01H
10D8 A800        R     MOV     R0,k_p_c
10DA C3                CLR     C
10DB 120000      E     LCALL   ?C?SLCMP
10DE 6026              JZ      ?C0115
                                           ; SOURCE LINE # 691
10E0 AF00        R     MOV     R7,curr_error+03H
10E2 AE00        R     MOV     R6,curr_error+02H
10E4 AD00        R     MOV     R5,curr_error+01H
10E6 AC00        R     MOV     R4,curr_error
10E8 A800        R     MOV     R0,k_p_c
10EA 120000      E     LCALL   ?C?LMUL
10ED 7810              MOV     R0,#010H
10EF 120000      E     LCALL   ?C?SLSHR
10F2 E500        R     MOV     A,pwm_input+03H
10F4 2F                ADD     A,R7
10F5 F500        R     MOV     pwm_input+03H,A
10F7 E500        R     MOV     A,pwm_input+02H
10F9 3E                ADDC    A,R6
10FA F500        R     MOV     pwm_input+02H,A
10FC E500        R     MOV     A,pwm_input+01H
10FE 3D                ADDC    A,R5
10FF F500        R     MOV     pwm_input+01H,A
1101 E500        R     MOV     A,pwm_input
1103 3C                ADDC    A,R4
1104 F500        R     MOV     pwm_input,A
1106         ?C0115:
                                           ; SOURCE LINE # 694
1106 E4                CLR     A
1107 FF                MOV     R7,A
1108 FE                MOV     R6,A
1109 FD                MOV     R5,A
110A FC                MOV     R4,A
110B AB00        R     MOV     R3,k_i_c+03H
110D AA00        R     MOV     R2,k_i_c+02H
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 79  

110F A900        R     MOV     R1,k_i_c+01H
1111 A800        R     MOV     R0,k_i_c
1113 C3                CLR     C
1114 120000      E     LCALL   ?C?SLCMP
1117 6031              JZ      ?C0116
                                           ; SOURCE LINE # 695
1119 900000      R     MOV     DPTR,#curr_error_sum
111C E0                MOVX    A,@DPTR
111D FC                MOV     R4,A
111E A3                INC     DPTR
111F E0                MOVX    A,@DPTR
1120 FD                MOV     R5,A
1121 A3                INC     DPTR
1122 E0                MOVX    A,@DPTR
1123 FE                MOV     R6,A
1124 A3                INC     DPTR
1125 E0                MOVX    A,@DPTR
1126 FF                MOV     R7,A
1127 7806              MOV     R0,#06H
1129 120000      E     LCALL   ?C?SLSHR
112C A800        R     MOV     R0,k_i_c
112E 120000      E     LCALL   ?C?LMUL
1131 780A              MOV     R0,#0AH
1133 120000      E     LCALL   ?C?SLSHR
1136 E500        R     MOV     A,pwm_input+03H
1138 2F                ADD     A,R7
1139 F500        R     MOV     pwm_input+03H,A
113B E500        R     MOV     A,pwm_input+02H
113D 3E                ADDC    A,R6
113E F500        R     MOV     pwm_input+02H,A
1140 E500        R     MOV     A,pwm_input+01H
1142 3D                ADDC    A,R5
1143 F500        R     MOV     pwm_input+01H,A
1145 E500        R     MOV     A,pwm_input
1147 3C                ADDC    A,R4
1148 F500        R     MOV     pwm_input,A
114A         ?C0116:
                                           ; SOURCE LINE # 698
114A E4                CLR     A
114B FF                MOV     R7,A
114C FE                MOV     R6,A
114D FD                MOV     R5,A
114E FC                MOV     R4,A
114F AB00        R     MOV     R3,k_d_c+03H
1151 AA00        R     MOV     R2,k_d_c+02H
1153 A900        R     MOV     R1,k_d_c+01H
1155 A800        R     MOV     R0,k_d_c
1157 C3                CLR     C
1158 120000      E     LCALL   ?C?SLCMP
115B 6043              JZ      ?C0117
                                           ; SOURCE LINE # 699
115D 900000      R     MOV     DPTR,#prev_curr_err
1160 E0                MOVX    A,@DPTR
1161 F8                MOV     R0,A
1162 A3                INC     DPTR
1163 E0                MOVX    A,@DPTR
1164 F9                MOV     R1,A
1165 A3                INC     DPTR
1166 E0                MOVX    A,@DPTR
1167 FA                MOV     R2,A
1168 A3                INC     DPTR
1169 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 80  

116A FB                MOV     R3,A
116B C3                CLR     C
116C E500        R     MOV     A,curr_error+03H
116E 9B                SUBB    A,R3
116F FF                MOV     R7,A
1170 E500        R     MOV     A,curr_error+02H
1172 9A                SUBB    A,R2
1173 FE                MOV     R6,A
1174 E500        R     MOV     A,curr_error+01H
1176 99                SUBB    A,R1
1177 FD                MOV     R5,A
1178 E500        R     MOV     A,curr_error
117A 98                SUBB    A,R0
117B FC                MOV     R4,A
117C AB00        R     MOV     R3,k_d_c+03H
117E AA00        R     MOV     R2,k_d_c+02H
1180 A900        R     MOV     R1,k_d_c+01H
1182 A800        R     MOV     R0,k_d_c
1184 120000      E     LCALL   ?C?LMUL
1187 7810              MOV     R0,#010H
1189 120000      E     LCALL   ?C?SLSHR
118C E500        R     MOV     A,pwm_input+03H
118E 2F                ADD     A,R7
118F F500        R     MOV     pwm_input+03H,A
1191 E500        R     MOV     A,pwm_input+02H
1193 3E                ADDC    A,R6
1194 F500        R     MOV     pwm_input+02H,A
1196 E500        R     MOV     A,pwm_input+01H
1198 3D                ADDC    A,R5
1199 F500        R     MOV     pwm_input+01H,A
119B E500        R     MOV     A,pwm_input
119D 3C                ADDC    A,R4
119E F500        R     MOV     pwm_input,A
11A0         ?C0117:
                                           ; SOURCE LINE # 701
11A0 AF00        R     MOV     R7,curr_error+03H
11A2 AE00        R     MOV     R6,curr_error+02H
11A4 AD00        R     MOV     R5,curr_error+01H
11A6 AC00        R     MOV     R4,curr_error
11A8 900000      R     MOV     DPTR,#prev_curr_err
11AB 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 703
11AE E4                CLR     A
11AF FF                MOV     R7,A
11B0 FE                MOV     R6,A
11B1 FD                MOV     R5,A
11B2 FC                MOV     R4,A
11B3 AB00        R     MOV     R3,pwm_input+03H
11B5 AA00        R     MOV     R2,pwm_input+02H
11B7 A900        R     MOV     R1,pwm_input+01H
11B9 A800        R     MOV     R0,pwm_input
11BB C3                CLR     C
11BC 120000      E     LCALL   ?C?SLCMP
11BF 4004              JC      ?C0118
                                           ; SOURCE LINE # 704
11C1 D200        R     SETB    motor_dir
11C3 8072              SJMP    ?C0076
11C5         ?C0118:
                                           ; SOURCE LINE # 706
11C5 C200        R     CLR     motor_dir
                                           ; SOURCE LINE # 707
                                           ; SOURCE LINE # 708
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 81  

11C7 806E              SJMP    ?C0076
                                           ; SOURCE LINE # 711
11C9         ?C0120:
                                           ; SOURCE LINE # 713
11C9 900000      E     MOV     DPTR,#g_ref+010H
11CC E0                MOVX    A,@DPTR
11CD FC                MOV     R4,A
11CE A3                INC     DPTR
11CF E0                MOVX    A,@DPTR
11D0 FD                MOV     R5,A
11D1 A3                INC     DPTR
11D2 E0                MOVX    A,@DPTR
11D3 FE                MOV     R6,A
11D4 A3                INC     DPTR
11D5 E0                MOVX    A,@DPTR
11D6 F500        R     MOV     pwm_input+03H,A
11D8 8E00        R     MOV     pwm_input+02H,R6
11DA 8D00        R     MOV     pwm_input+01H,R5
11DC 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 715
11DE E4                CLR     A
11DF FF                MOV     R7,A
11E0 FE                MOV     R6,A
11E1 FD                MOV     R5,A
11E2 FC                MOV     R4,A
11E3 AB00        R     MOV     R3,pwm_input+03H
11E5 AA00        R     MOV     R2,pwm_input+02H
11E7 A900        R     MOV     R1,pwm_input+01H
11E9 A800        R     MOV     R0,pwm_input
11EB D3                SETB    C
11EC 120000      E     LCALL   ?C?SLCMP
11EF 4004              JC      ?C0121
                                           ; SOURCE LINE # 716
11F1 D200        R     SETB    motor_dir
11F3 8002              SJMP    ?C0122
11F5         ?C0121:
                                           ; SOURCE LINE # 718
11F5 C200        R     CLR     motor_dir
11F7         ?C0122:
                                           ; SOURCE LINE # 722
11F7 74FF              MOV     A,#0FFH
11F9 7F9C              MOV     R7,#09CH
11FB FE                MOV     R6,A
11FC FD                MOV     R5,A
11FD FC                MOV     R4,A
11FE AB00        R     MOV     R3,pwm_input+03H
1200 AA00        R     MOV     R2,pwm_input+02H
1202 A900        R     MOV     R1,pwm_input+01H
1204 A800        R     MOV     R0,pwm_input
1206 C3                CLR     C
1207 120000      E     LCALL   ?C?SLCMP
120A 500D              JNC     ?C0123
                                           ; SOURCE LINE # 723
120C 74FF              MOV     A,#0FFH
120E 75009C      R     MOV     pwm_input+03H,#09CH
1211 F500        R     MOV     pwm_input+02H,A
1213 F500        R     MOV     pwm_input+01H,A
1215 F500        R     MOV     pwm_input,A
1217 801E              SJMP    ?C0076
1219         ?C0123:
                                           ; SOURCE LINE # 724
1219 E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 82  

121A 7F64              MOV     R7,#064H
121C FE                MOV     R6,A
121D FD                MOV     R5,A
121E FC                MOV     R4,A
121F AB00        R     MOV     R3,pwm_input+03H
1221 AA00        R     MOV     R2,pwm_input+02H
1223 A900        R     MOV     R1,pwm_input+01H
1225 A800        R     MOV     R0,pwm_input
1227 D3                SETB    C
1228 120000      E     LCALL   ?C?SLCMP
122B 400A              JC      ?C0076
                                           ; SOURCE LINE # 725
122D E4                CLR     A
122E 750064      R     MOV     pwm_input+03H,#064H
1231 F500        R     MOV     pwm_input+02H,A
1233 F500        R     MOV     pwm_input+01H,A
1235 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 728
                                           ; SOURCE LINE # 729
1237         ?C0076:
                                           ; SOURCE LINE # 733
1237 E4                CLR     A
1238 7F64              MOV     R7,#064H
123A FE                MOV     R6,A
123B FD                MOV     R5,A
123C FC                MOV     R4,A
123D AB00        R     MOV     R3,pwm_input+03H
123F AA00        R     MOV     R2,pwm_input+02H
1241 A900        R     MOV     R1,pwm_input+01H
1243 A800        R     MOV     R0,pwm_input
1245 D3                SETB    C
1246 120000      E     LCALL   ?C?SLCMP
1249 400A              JC      ?C0126
                                           ; SOURCE LINE # 734
124B E4                CLR     A
124C 750064      R     MOV     pwm_input+03H,#064H
124F F500        R     MOV     pwm_input+02H,A
1251 F500        R     MOV     pwm_input+01H,A
1253 F500        R     MOV     pwm_input,A
1255         ?C0126:
                                           ; SOURCE LINE # 735
1255 74FF              MOV     A,#0FFH
1257 7F9C              MOV     R7,#09CH
1259 FE                MOV     R6,A
125A FD                MOV     R5,A
125B FC                MOV     R4,A
125C AB00        R     MOV     R3,pwm_input+03H
125E AA00        R     MOV     R2,pwm_input+02H
1260 A900        R     MOV     R1,pwm_input+01H
1262 A800        R     MOV     R0,pwm_input
1264 C3                CLR     C
1265 120000      E     LCALL   ?C?SLCMP
1268 500B              JNC     ?C0127
                                           ; SOURCE LINE # 736
126A 74FF              MOV     A,#0FFH
126C 75009C      R     MOV     pwm_input+03H,#09CH
126F F500        R     MOV     pwm_input+02H,A
1271 F500        R     MOV     pwm_input+01H,A
1273 F500        R     MOV     pwm_input,A
1275         ?C0127:
                                           ; SOURCE LINE # 739
1275 900000      E     MOV     DPTR,#c_mem+034H
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 83  

1278 E0                MOVX    A,@DPTR
1279 6401              XRL     A,#01H
127B 6037              JZ      ?C0128
                                           ; SOURCE LINE # 740
127D AF00        R     MOV     R7,pwm_input+03H
127F AE00        R     MOV     R6,pwm_input+02H
1281 AD00        R     MOV     R5,pwm_input+01H
1283 AC00        R     MOV     R4,pwm_input
1285 780A              MOV     R0,#0AH
1287 120000      E     LCALL   ?C?LSHL
128A E4                CLR     A
128B 7B64              MOV     R3,#064H
128D FA                MOV     R2,A
128E F9                MOV     R1,A
128F F8                MOV     R0,A
1290 120000      E     LCALL   ?C?SLDIV
1293 A804              MOV     R0,AR4
1295 A905              MOV     R1,AR5
1297 AA06              MOV     R2,AR6
1299 AB07              MOV     R3,AR7
129B 900000      E     MOV     DPTR,#dev_pwm_limit
129E E0                MOVX    A,@DPTR
129F FF                MOV     R7,A
12A0 E4                CLR     A
12A1 FC                MOV     R4,A
12A2 FD                MOV     R5,A
12A3 FE                MOV     R6,A
12A4 120000      E     LCALL   ?C?LMUL
12A7 780A              MOV     R0,#0AH
12A9 120000      E     LCALL   ?C?SLSHR
12AC 8F00        R     MOV     pwm_input+03H,R7
12AE 8E00        R     MOV     pwm_input+02H,R6
12B0 8D00        R     MOV     pwm_input+01H,R5
12B2 8C00        R     MOV     pwm_input,R4
12B4         ?C0128:
                                           ; SOURCE LINE # 743
12B4 E4                CLR     A
12B5 FF                MOV     R7,A
12B6 FE                MOV     R6,A
12B7 FD                MOV     R5,A
12B8 FC                MOV     R4,A
12B9 AB00        R     MOV     R3,pwm_input+03H
12BB AA00        R     MOV     R2,pwm_input+02H
12BD A900        R     MOV     R1,pwm_input+01H
12BF A800        R     MOV     R0,pwm_input
12C1 C3                CLR     C
12C2 120000      E     LCALL   ?C?SLCMP
12C5 4004              JC      ?C0129
12C7 7F01              MOV     R7,#01H
12C9 8002              SJMP    ?C0130
12CB         ?C0129:
12CB 7FFF              MOV     R7,#0FFH
12CD         ?C0130:
12CD 900000      E     MOV     DPTR,#pwm_sign
12D0 EF                MOV     A,R7
12D1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 745
12D2 300007            JNB     motor_dir,?C0131
                                           ; SOURCE LINE # 746
12D5 7F01              MOV     R7,#01H
12D7 120000      E     LCALL   _MOTOR_DIR_Write
12DA 8005              SJMP    ?C0132
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 84  

12DC         ?C0131:
                                           ; SOURCE LINE # 748
12DC E4                CLR     A
12DD FF                MOV     R7,A
12DE 120000      E     LCALL   _MOTOR_DIR_Write
12E1         ?C0132:
                                           ; SOURCE LINE # 750
12E1 AE00        R     MOV     R6,pwm_input+02H
12E3 AF00        R     MOV     R7,pwm_input+03H
12E5 120000      E     LCALL   _abs
12E8 120000      E     LCALL   _PWM_MOTORS_WriteCompare1
                                           ; SOURCE LINE # 751
12EB 22                RET     
             ; FUNCTION motor_control (END)

             ; FUNCTION _encoder_reading (BEGIN)
                                           ; SOURCE LINE # 757
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 759
0000 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 780
0002 E500        R     MOV     A,index
0004 C3                CLR     C
0005 9403              SUBB    A,#03H
0007 4003              JC      $ + 5H
0009 020000      R     LJMP    ?C0135
000C         ?C0134:
                                           ; SOURCE LINE # 783
000C 300022            JNB     reset_last_value_flag,?C0136
                                           ; SOURCE LINE # 784
;---- Variable 'jj' assigned to Register 'R3' ----
000F 7B03              MOV     R3,#03H
0011         ?C0137:
0011 AF03              MOV     R7,AR3
0013 1B                DEC     R3
0014 EF                MOV     A,R7
0015 6018              JZ      ?C0138
                                           ; SOURCE LINE # 785
0017 E4                CLR     A
0018 FF                MOV     R7,A
0019 FE                MOV     R6,A
001A FD                MOV     R5,A
001B FC                MOV     R4,A
001C EB                MOV     A,R3
001D 25E0              ADD     A,ACC
001F 25E0              ADD     A,ACC
0021 2400        R     ADD     A,#LOW last_value_encoder
0023 F582              MOV     DPL,A
0025 E4                CLR     A
0026 3400        R     ADDC    A,#HIGH last_value_encoder
0028 F583              MOV     DPH,A
002A 120000      E     LCALL   ?C?LSTXDATA
002D 80E2              SJMP    ?C0137
002F         ?C0138:
                                           ; SOURCE LINE # 787
002F C200        E     CLR     reset_last_value_flag
                                           ; SOURCE LINE # 788
0031         ?C0136:
                                           ; SOURCE LINE # 792
0031 E500        R     MOV     A,index
0033 7018              JNZ     ?C0139
                                           ; SOURCE LINE # 793
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 85  

0035 120000      E     LCALL   SHIFTREG_ENC_1_ReadData
0038 7801              MOV     R0,#01H
003A 120000      E     LCALL   ?C?ULSHR
003D EF                MOV     A,R7
003E EE                MOV     A,R6
003F ED                MOV     A,R5
0040 5403              ANL     A,#03H
0042 FD                MOV     R5,A
0043 E4                CLR     A
0044 FC                MOV     R4,A
0045 900000      R     MOV     DPTR,#data_encoder
0048 120000      E     LCALL   ?C?LSTXDATA
004B 8033              SJMP    ?C0140
004D         ?C0139:
                                           ; SOURCE LINE # 794
                                           ; SOURCE LINE # 795
004D E500        R     MOV     A,index
004F B40118            CJNE    A,#01H,?C0141
                                           ; SOURCE LINE # 796
0052 120000      E     LCALL   SHIFTREG_ENC_2_ReadData
0055 7801              MOV     R0,#01H
0057 120000      E     LCALL   ?C?ULSHR
005A EF                MOV     A,R7
005B EE                MOV     A,R6
005C ED                MOV     A,R5
005D 5403              ANL     A,#03H
005F FD                MOV     R5,A
0060 E4                CLR     A
0061 FC                MOV     R4,A
0062 900000      R     MOV     DPTR,#data_encoder
0065 120000      E     LCALL   ?C?LSTXDATA
0068 8016              SJMP    ?C0140
006A         ?C0141:
                                           ; SOURCE LINE # 798
006A 120000      E     LCALL   SHIFTREG_ENC_3_ReadData
006D 7801              MOV     R0,#01H
006F 120000      E     LCALL   ?C?ULSHR
0072 EF                MOV     A,R7
0073 EE                MOV     A,R6
0074 ED                MOV     A,R5
0075 5403              ANL     A,#03H
0077 FD                MOV     R5,A
0078 E4                CLR     A
0079 FC                MOV     R4,A
007A 900000      R     MOV     DPTR,#data_encoder
007D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 799
0080         ?C0140:
                                           ; SOURCE LINE # 802
0080 7B01              MOV     R3,#01H
0082 7A00        R     MOV     R2,#HIGH data_encoder
0084 7900        R     MOV     R1,#LOW data_encoder
0086 120000      E     LCALL   _check_enc_data
0089 4003              JC      $ + 5H
008B 020000      R     LJMP    ?C0143
                                           ; SOURCE LINE # 804
008E 900000      R     MOV     DPTR,#data_encoder
0091 E0                MOVX    A,@DPTR
0092 FC                MOV     R4,A
0093 A3                INC     DPTR
0094 E0                MOVX    A,@DPTR
0095 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 86  

0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 FE                MOV     R6,A
0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B 54C0              ANL     A,#0C0H
009D FF                MOV     R7,A
009E EE                MOV     A,R6
009F ED                MOV     A,R5
00A0 5403              ANL     A,#03H
00A2 FD                MOV     R5,A
00A3 E4                CLR     A
00A4 2F                ADD     A,R7
00A5 FF                MOV     R7,A
00A6 E4                CLR     A
00A7 3E                ADDC    A,R6
00A8 FE                MOV     R6,A
00A9 ED                MOV     A,R5
00AA 34FE              ADDC    A,#0FEH
00AC FD                MOV     R5,A
00AD E4                CLR     A
00AE 34FF              ADDC    A,#0FFH
00B0 FC                MOV     R4,A
00B1 7802              MOV     R0,#02H
00B3 120000      E     LCALL   ?C?ULSHR
00B6 EE                MOV     A,R6
00B7 33                RLC     A
00B8 95E0              SUBB    A,ACC
00BA FD                MOV     R5,A
00BB FC                MOV     R4,A
00BC E500        R     MOV     A,index
00BE 25E0              ADD     A,ACC
00C0 25E0              ADD     A,ACC
00C2 2400        E     ADD     A,#LOW g_mem+038H
00C4 F582              MOV     DPL,A
00C6 E4                CLR     A
00C7 3400        E     ADDC    A,#HIGH g_mem+038H
00C9 F583              MOV     DPH,A
00CB E0                MOVX    A,@DPTR
00CC F8                MOV     R0,A
00CD A3                INC     DPTR
00CE E0                MOVX    A,@DPTR
00CF F9                MOV     R1,A
00D0 A3                INC     DPTR
00D1 E0                MOVX    A,@DPTR
00D2 FA                MOV     R2,A
00D3 A3                INC     DPTR
00D4 E0                MOVX    A,@DPTR
00D5 2F                ADD     A,R7
00D6 FF                MOV     R7,A
00D7 EA                MOV     A,R2
00D8 3E                ADDC    A,R6
00D9 FE                MOV     R6,A
00DA E9                MOV     A,R1
00DB 3D                ADDC    A,R5
00DC FD                MOV     R5,A
00DD E8                MOV     A,R0
00DE 3C                ADDC    A,R4
00DF FC                MOV     R4,A
00E0 900000      R     MOV     DPTR,#value_encoder
00E3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 811
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 87  

00E6 300027            JNB     only_first_time,?C0144
                                           ; SOURCE LINE # 812
00E9 900000      R     MOV     DPTR,#value_encoder
00EC E0                MOVX    A,@DPTR
00ED FC                MOV     R4,A
00EE A3                INC     DPTR
00EF E0                MOVX    A,@DPTR
00F0 FD                MOV     R5,A
00F1 A3                INC     DPTR
00F2 E0                MOVX    A,@DPTR
00F3 FE                MOV     R6,A
00F4 A3                INC     DPTR
00F5 E0                MOVX    A,@DPTR
00F6 FF                MOV     R7,A
00F7 E500        R     MOV     A,index
00F9 25E0              ADD     A,ACC
00FB 25E0              ADD     A,ACC
00FD 2400        R     ADD     A,#LOW last_value_encoder
00FF F582              MOV     DPL,A
0101 E4                CLR     A
0102 3400        R     ADDC    A,#HIGH last_value_encoder
0104 F583              MOV     DPH,A
0106 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 813
0109 E500        R     MOV     A,index
010B B40202            CJNE    A,#02H,?C0144
                                           ; SOURCE LINE # 814
010E C200        R     CLR     only_first_time
                                           ; SOURCE LINE # 815
0110         ?C0144:
                                           ; SOURCE LINE # 818
0110 E500        R     MOV     A,index
0112 25E0              ADD     A,ACC
0114 25E0              ADD     A,ACC
0116 2400        R     ADD     A,#LOW last_value_encoder
0118 F582              MOV     DPL,A
011A E4                CLR     A
011B 3400        R     ADDC    A,#HIGH last_value_encoder
011D F583              MOV     DPH,A
011F E0                MOVX    A,@DPTR
0120 F8                MOV     R0,A
0121 A3                INC     DPTR
0122 E0                MOVX    A,@DPTR
0123 F9                MOV     R1,A
0124 A3                INC     DPTR
0125 E0                MOVX    A,@DPTR
0126 FA                MOV     R2,A
0127 A3                INC     DPTR
0128 E0                MOVX    A,@DPTR
0129 FB                MOV     R3,A
012A 900000      R     MOV     DPTR,#value_encoder
012D E0                MOVX    A,@DPTR
012E FC                MOV     R4,A
012F A3                INC     DPTR
0130 E0                MOVX    A,@DPTR
0131 FD                MOV     R5,A
0132 A3                INC     DPTR
0133 E0                MOVX    A,@DPTR
0134 FE                MOV     R6,A
0135 A3                INC     DPTR
0136 E0                MOVX    A,@DPTR
0137 C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 88  

0138 9B                SUBB    A,R3
0139 FF                MOV     R7,A
013A EE                MOV     A,R6
013B 9A                SUBB    A,R2
013C FE                MOV     R6,A
013D ED                MOV     A,R5
013E 99                SUBB    A,R1
013F FD                MOV     R5,A
0140 EC                MOV     A,R4
0141 98                SUBB    A,R0
0142 FC                MOV     R4,A
0143 A3                INC     DPTR
0144 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 838
0147 E4                CLR     A
0148 FF                MOV     R7,A
0149 7EC0              MOV     R6,#0C0H
014B FD                MOV     R5,A
014C FC                MOV     R4,A
014D 900000      R     MOV     DPTR,#aux
0150 E0                MOVX    A,@DPTR
0151 F8                MOV     R0,A
0152 A3                INC     DPTR
0153 E0                MOVX    A,@DPTR
0154 F9                MOV     R1,A
0155 A3                INC     DPTR
0156 E0                MOVX    A,@DPTR
0157 FA                MOV     R2,A
0158 A3                INC     DPTR
0159 E0                MOVX    A,@DPTR
015A FB                MOV     R3,A
015B D3                SETB    C
015C 120000      E     LCALL   ?C?SLCMP
015F 4010              JC      ?C0146
                                           ; SOURCE LINE # 839
0161 7400        E     MOV     A,#LOW g_meas+014H
0163 2500        R     ADD     A,index
0165 F582              MOV     DPL,A
0167 E4                CLR     A
0168 3400        E     ADDC    A,#HIGH g_meas+014H
016A F583              MOV     DPH,A
016C E0                MOVX    A,@DPTR
016D 14                DEC     A
016E F0                MOVX    @DPTR,A
016F 8068              SJMP    ?C0147
0171         ?C0146:
                                           ; SOURCE LINE # 840
                                           ; SOURCE LINE # 841
0171 7F00              MOV     R7,#00H
0173 7E40              MOV     R6,#040H
0175 7DFF              MOV     R5,#0FFH
0177 7CFF              MOV     R4,#0FFH
0179 900000      R     MOV     DPTR,#aux
017C E0                MOVX    A,@DPTR
017D F8                MOV     R0,A
017E A3                INC     DPTR
017F E0                MOVX    A,@DPTR
0180 F9                MOV     R1,A
0181 A3                INC     DPTR
0182 E0                MOVX    A,@DPTR
0183 FA                MOV     R2,A
0184 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 89  

0185 E0                MOVX    A,@DPTR
0186 FB                MOV     R3,A
0187 C3                CLR     C
0188 120000      E     LCALL   ?C?SLCMP
018B 5010              JNC     ?C0148
                                           ; SOURCE LINE # 842
018D 7400        E     MOV     A,#LOW g_meas+014H
018F 2500        R     ADD     A,index
0191 F582              MOV     DPL,A
0193 E4                CLR     A
0194 3400        E     ADDC    A,#HIGH g_meas+014H
0196 F583              MOV     DPH,A
0198 E0                MOVX    A,@DPTR
0199 04                INC     A
019A F0                MOVX    @DPTR,A
019B 803C              SJMP    ?C0147
019D         ?C0148:
                                           ; SOURCE LINE # 843
                                           ; SOURCE LINE # 844
019D 900000      R     MOV     DPTR,#aux
01A0 E0                MOVX    A,@DPTR
01A1 A3                INC     DPTR
01A2 E0                MOVX    A,@DPTR
01A3 A3                INC     DPTR
01A4 E0                MOVX    A,@DPTR
01A5 FE                MOV     R6,A
01A6 A3                INC     DPTR
01A7 E0                MOVX    A,@DPTR
01A8 FF                MOV     R7,A
01A9 120000      E     LCALL   _abs
01AC D3                SETB    C
01AD EF                MOV     A,R7
01AE 9400              SUBB    A,#00H
01B0 EE                MOV     A,R6
01B1 6480              XRL     A,#080H
01B3 94C0              SUBB    A,#0C0H
01B5 4022              JC      ?C0147
                                           ; SOURCE LINE # 845
01B7 7400        R     MOV     A,#LOW error
01B9 2500        R     ADD     A,index
01BB F582              MOV     DPL,A
01BD E4                CLR     A
01BE 3400        R     ADDC    A,#HIGH error
01C0 F583              MOV     DPH,A
01C2 E0                MOVX    A,@DPTR
01C3 04                INC     A
01C4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 846
01C5 7400        R     MOV     A,#LOW error
01C7 2500        R     ADD     A,index
01C9 F582              MOV     DPL,A
01CB E4                CLR     A
01CC 3400        R     ADDC    A,#HIGH error
01CE F583              MOV     DPH,A
01D0 E0                MOVX    A,@DPTR
01D1 C3                CLR     C
01D2 940A              SUBB    A,#0AH
01D4 5003              JNC     $ + 5H
01D6 020000      R     LJMP    ?C0135
01D9         ?C0151:
                                           ; SOURCE LINE # 849
                                           ; SOURCE LINE # 850
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 90  

                                           ; SOURCE LINE # 851
01D9         ?C0147:
                                           ; SOURCE LINE # 853
01D9 7400        R     MOV     A,#LOW error
01DB 2500        R     ADD     A,index
01DD F582              MOV     DPL,A
01DF E4                CLR     A
01E0 3400        R     ADDC    A,#HIGH error
01E2 F583              MOV     DPH,A
01E4 E4                CLR     A
01E5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 855
01E6 900000      R     MOV     DPTR,#value_encoder
01E9 E0                MOVX    A,@DPTR
01EA FC                MOV     R4,A
01EB A3                INC     DPTR
01EC E0                MOVX    A,@DPTR
01ED FD                MOV     R5,A
01EE A3                INC     DPTR
01EF E0                MOVX    A,@DPTR
01F0 FE                MOV     R6,A
01F1 A3                INC     DPTR
01F2 E0                MOVX    A,@DPTR
01F3 FF                MOV     R7,A
01F4 E500        R     MOV     A,index
01F6 25E0              ADD     A,ACC
01F8 25E0              ADD     A,ACC
01FA 2400        R     ADD     A,#LOW last_value_encoder
01FC F582              MOV     DPL,A
01FE E4                CLR     A
01FF 3400        R     ADDC    A,#HIGH last_value_encoder
0201 F583              MOV     DPH,A
0203 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 857
0206 900000      R     MOV     DPTR,#value_encoder
0209 E0                MOVX    A,@DPTR
020A F8                MOV     R0,A
020B A3                INC     DPTR
020C E0                MOVX    A,@DPTR
020D F9                MOV     R1,A
020E A3                INC     DPTR
020F E0                MOVX    A,@DPTR
0210 FA                MOV     R2,A
0211 A3                INC     DPTR
0212 E0                MOVX    A,@DPTR
0213 FB                MOV     R3,A
0214 C000              PUSH    AR0
0216 7400        E     MOV     A,#LOW g_meas+014H
0218 2500        R     ADD     A,index
021A F582              MOV     DPL,A
021C E4                CLR     A
021D 3400        E     ADDC    A,#HIGH g_meas+014H
021F F583              MOV     DPH,A
0221 E0                MOVX    A,@DPTR
0222 FF                MOV     R7,A
0223 33                RLC     A
0224 95E0              SUBB    A,ACC
0226 FE                MOV     R6,A
0227 FD                MOV     R5,A
0228 FC                MOV     R4,A
0229 7810              MOV     R0,#010H
022B 120000      E     LCALL   ?C?LSHL
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 91  

022E D000              POP     AR0
0230 EB                MOV     A,R3
0231 2F                ADD     A,R7
0232 FF                MOV     R7,A
0233 EA                MOV     A,R2
0234 3E                ADDC    A,R6
0235 FE                MOV     R6,A
0236 E9                MOV     A,R1
0237 3D                ADDC    A,R5
0238 FD                MOV     R5,A
0239 E8                MOV     A,R0
023A 3C                ADDC    A,R4
023B FC                MOV     R4,A
023C 900000      R     MOV     DPTR,#value_encoder
023F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 859
0242 E500        R     MOV     A,index
0244 25E0              ADD     A,ACC
0246 25E0              ADD     A,ACC
0248 2400        E     ADD     A,#LOW c_mem+044H
024A F582              MOV     DPL,A
024C E4                CLR     A
024D 3400        E     ADDC    A,#HIGH c_mem+044H
024F F583              MOV     DPH,A
0251 E0                MOVX    A,@DPTR
0252 FC                MOV     R4,A
0253 A3                INC     DPTR
0254 E0                MOVX    A,@DPTR
0255 FD                MOV     R5,A
0256 A3                INC     DPTR
0257 E0                MOVX    A,@DPTR
0258 FE                MOV     R6,A
0259 A3                INC     DPTR
025A E0                MOVX    A,@DPTR
025B FF                MOV     R7,A
025C E4                CLR     A
025D FB                MOV     R3,A
025E FA                MOV     R2,A
025F 7980              MOV     R1,#080H
0261 783F              MOV     R0,#03FH
0263 120000      E     LCALL   ?C?FPCMP3
0266 6038              JZ      ?C0152
                                           ; SOURCE LINE # 860
0268 900000      R     MOV     DPTR,#value_encoder
026B E0                MOVX    A,@DPTR
026C FC                MOV     R4,A
026D A3                INC     DPTR
026E E0                MOVX    A,@DPTR
026F FD                MOV     R5,A
0270 A3                INC     DPTR
0271 E0                MOVX    A,@DPTR
0272 FE                MOV     R6,A
0273 A3                INC     DPTR
0274 E0                MOVX    A,@DPTR
0275 FF                MOV     R7,A
0276 EC                MOV     A,R4
0277 120000      E     LCALL   ?C?FCASTL
027A E500        R     MOV     A,index
027C 25E0              ADD     A,ACC
027E 25E0              ADD     A,ACC
0280 2400        E     ADD     A,#LOW c_mem+044H
0282 F582              MOV     DPL,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 92  

0284 E4                CLR     A
0285 3400        E     ADDC    A,#HIGH c_mem+044H
0287 F583              MOV     DPH,A
0289 E0                MOVX    A,@DPTR
028A F8                MOV     R0,A
028B A3                INC     DPTR
028C E0                MOVX    A,@DPTR
028D F9                MOV     R1,A
028E A3                INC     DPTR
028F E0                MOVX    A,@DPTR
0290 FA                MOV     R2,A
0291 A3                INC     DPTR
0292 E0                MOVX    A,@DPTR
0293 FB                MOV     R3,A
0294 120000      E     LCALL   ?C?FPMUL
0297 120000      E     LCALL   ?C?CASTF
029A 900000      R     MOV     DPTR,#value_encoder
029D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 861
02A0         ?C0152:
                                           ; SOURCE LINE # 863
02A0 900000      R     MOV     DPTR,#value_encoder
02A3 E0                MOVX    A,@DPTR
02A4 FC                MOV     R4,A
02A5 A3                INC     DPTR
02A6 E0                MOVX    A,@DPTR
02A7 FD                MOV     R5,A
02A8 A3                INC     DPTR
02A9 E0                MOVX    A,@DPTR
02AA FE                MOV     R6,A
02AB A3                INC     DPTR
02AC E0                MOVX    A,@DPTR
02AD FF                MOV     R7,A
02AE E500        R     MOV     A,index
02B0 25E0              ADD     A,ACC
02B2 25E0              ADD     A,ACC
02B4 2400        E     ADD     A,#LOW g_meas
02B6 F582              MOV     DPL,A
02B8 E4                CLR     A
02B9 3400        E     ADDC    A,#HIGH g_meas
02BB F583              MOV     DPH,A
02BD 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 864
02C0         ?C0143:
                                           ; SOURCE LINE # 867
02C0 300003      R     JNB     pos_reconstruct,$ + 6H
02C3 020000      R     LJMP    ?C0135
                                           ; SOURCE LINE # 868
02C6 900000      R     MOV     DPTR,#one_time_execute
02C9 E0                MOVX    A,@DPTR
02CA C3                CLR     C
02CB 9422              SUBB    A,#022H
02CD 5004              JNC     ?C0154
                                           ; SOURCE LINE # 869
02CF E0                MOVX    A,@DPTR
02D0 04                INC     A
02D1 F0                MOVX    @DPTR,A
02D2 22                RET     
02D3         ?C0154:
                                           ; SOURCE LINE # 870
                                           ; SOURCE LINE # 872
02D3 900000      E     MOV     DPTR,#c_mem+06BH
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 93  

02D6 E0                MOVX    A,@DPTR
02D7 602A              JZ      ?C0156
                                           ; SOURCE LINE # 873
02D9 900000      E     MOV     DPTR,#g_meas+04H
02DC E0                MOVX    A,@DPTR
02DD FC                MOV     R4,A
02DE A3                INC     DPTR
02DF E0                MOVX    A,@DPTR
02E0 FD                MOV     R5,A
02E1 A3                INC     DPTR
02E2 E0                MOVX    A,@DPTR
02E3 FE                MOV     R6,A
02E4 A3                INC     DPTR
02E5 E0                MOVX    A,@DPTR
02E6 FF                MOV     R7,A
02E7 900000      E     MOV     DPTR,#?_calc_turns_fcn?BYTE+04H
02EA 120000      E     LCALL   ?C?LSTXDATA
02ED 900000      E     MOV     DPTR,#g_meas
02F0 E0                MOVX    A,@DPTR
02F1 FC                MOV     R4,A
02F2 A3                INC     DPTR
02F3 E0                MOVX    A,@DPTR
02F4 FD                MOV     R5,A
02F5 A3                INC     DPTR
02F6 E0                MOVX    A,@DPTR
02F7 FE                MOV     R6,A
02F8 A3                INC     DPTR
02F9 E0                MOVX    A,@DPTR
02FA FF                MOV     R7,A
02FB 120000      E     LCALL   _calc_turns_fcn
02FE 900000      E     MOV     DPTR,#g_meas+014H
0301 EF                MOV     A,R7
0302 F0                MOVX    @DPTR,A
0303         ?C0156:
                                           ; SOURCE LINE # 875
0303 900000      E     MOV     DPTR,#g_meas
0306 E0                MOVX    A,@DPTR
0307 F8                MOV     R0,A
0308 A3                INC     DPTR
0309 E0                MOVX    A,@DPTR
030A F9                MOV     R1,A
030B A3                INC     DPTR
030C E0                MOVX    A,@DPTR
030D FA                MOV     R2,A
030E A3                INC     DPTR
030F E0                MOVX    A,@DPTR
0310 FB                MOV     R3,A
0311 C000              PUSH    AR0
0313 900000      E     MOV     DPTR,#g_meas+014H
0316 E0                MOVX    A,@DPTR
0317 FF                MOV     R7,A
0318 33                RLC     A
0319 95E0              SUBB    A,ACC
031B FE                MOV     R6,A
031C FD                MOV     R5,A
031D FC                MOV     R4,A
031E 7810              MOV     R0,#010H
0320 120000      E     LCALL   ?C?LSHL
0323 D000              POP     AR0
0325 EB                MOV     A,R3
0326 2F                ADD     A,R7
0327 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 94  

0328 EA                MOV     A,R2
0329 3E                ADDC    A,R6
032A FE                MOV     R6,A
032B E9                MOV     A,R1
032C 3D                ADDC    A,R5
032D FD                MOV     R5,A
032E E8                MOV     A,R0
032F 3C                ADDC    A,R4
0330 FC                MOV     R4,A
0331 900000      E     MOV     DPTR,#g_meas
0334 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 878
0337 900000      E     MOV     DPTR,#g_meas
033A E0                MOVX    A,@DPTR
033B FC                MOV     R4,A
033C A3                INC     DPTR
033D E0                MOVX    A,@DPTR
033E FD                MOV     R5,A
033F A3                INC     DPTR
0340 E0                MOVX    A,@DPTR
0341 FE                MOV     R6,A
0342 A3                INC     DPTR
0343 E0                MOVX    A,@DPTR
0344 FF                MOV     R7,A
0345 900000      E     MOV     DPTR,#g_refNew
0348 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 880
034B 900000      E     MOV     DPTR,#g_ref+018H
034E E0                MOVX    A,@DPTR
034F FF                MOV     R7,A
0350 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 882
0353 D200        R     SETB    pos_reconstruct
                                           ; SOURCE LINE # 883
                                           ; SOURCE LINE # 884
                                           ; SOURCE LINE # 885
0355         ?C0135:
0355 22                RET     
             ; FUNCTION _encoder_reading (END)

             ; FUNCTION analog_read_end (BEGIN)
                                           ; SOURCE LINE # 891
0000         ?C0157:
                                           ; SOURCE LINE # 924
0000 120000      E     LCALL   ADC_STATUS_Read
0003 EF                MOV     A,R7
0004 700A              JNZ     ?C0158
                                           ; SOURCE LINE # 925
0006 3000F7            JNB     interrupt_flag,?C0157
                                           ; SOURCE LINE # 926
0009 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 927
000B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 928
                                           ; SOURCE LINE # 929
000E 80F0              SJMP    ?C0157
0010         ?C0158:
                                           ; SOURCE LINE # 932
0010 900000      E     MOV     DPTR,#ADC_buf+01H
0013 E0                MOVX    A,@DPTR
0014 249A              ADD     A,#09AH
0016 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 95  

0017 900000      E     MOV     DPTR,#ADC_buf
001A E0                MOVX    A,@DPTR
001B 34F9              ADDC    A,#0F9H
001D FE                MOV     R6,A
001E 33                RLC     A
001F 95E0              SUBB    A,ACC
0021 FD                MOV     R5,A
0022 FC                MOV     R4,A
0023 E4                CLR     A
0024 7BA0              MOV     R3,#0A0H
0026 7A07              MOV     R2,#07H
0028 F9                MOV     R1,A
0029 F8                MOV     R0,A
002A 120000      E     LCALL   ?C?LMUL
002D 7807              MOV     R0,#07H
002F 120000      E     LCALL   ?C?SLSHR
0032 900000      E     MOV     DPTR,#dev_tension
0035 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 934
0038 300005            JNB     interrupt_flag,?C0160
                                           ; SOURCE LINE # 935
003B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 936
003D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 937
0040         ?C0160:
                                           ; SOURCE LINE # 941
0040 E4                CLR     A
0041 FF                MOV     R7,A
0042 FE                MOV     R6,A
0043 FD                MOV     R5,A
0044 FC                MOV     R4,A
0045 900000      E     MOV     DPTR,#dev_tension
0048 E0                MOVX    A,@DPTR
0049 F8                MOV     R0,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C F9                MOV     R1,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F FA                MOV     R2,A
0050 A3                INC     DPTR
0051 E0                MOVX    A,@DPTR
0052 FB                MOV     R3,A
0053 D3                SETB    C
0054 120000      E     LCALL   ?C?SLCMP
0057 5003              JNC     $ + 5H
0059 020000      R     LJMP    ?C0161
                                           ; SOURCE LINE # 944
005C D200        E     SETB    tension_valid
                                           ; SOURCE LINE # 946
005E 900000      E     MOV     DPTR,#g_mem+06DH
0061 E0                MOVX    A,@DPTR
0062 6003              JZ      ?C0162
                                           ; SOURCE LINE # 947
0064 120000      R     LCALL   pwm_limit_search
0067         ?C0162:
                                           ; SOURCE LINE # 950
0067 900000      E     MOV     DPTR,#ADC_buf+03H
006A E0                MOVX    A,@DPTR
006B 249A              ADD     A,#09AH
006D FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 96  

006E 900000      E     MOV     DPTR,#ADC_buf+02H
0071 E0                MOVX    A,@DPTR
0072 34F9              ADDC    A,#0F9H
0074 FE                MOV     R6,A
0075 33                RLC     A
0076 95E0              SUBB    A,ACC
0078 FD                MOV     R5,A
0079 FC                MOV     R4,A
007A E4                CLR     A
007B 7BAB              MOV     R3,#0ABH
007D 7A64              MOV     R2,#064H
007F F9                MOV     R1,A
0080 F8                MOV     R0,A
0081 120000      E     LCALL   ?C?LMUL
0084 780D              MOV     R0,#0DH
0086 120000      E     LCALL   ?C?SLSHR
0089 900000      E     MOV     DPTR,#pwm_sign
008C E0                MOVX    A,@DPTR
008D FD                MOV     R5,A
008E 33                RLC     A
008F 95E0              SUBB    A,ACC
0091 FC                MOV     R4,A
0092 120000      E     LCALL   ?C?IMUL
0095 EE                MOV     A,R6
0096 33                RLC     A
0097 95E0              SUBB    A,ACC
0099 FD                MOV     R5,A
009A FC                MOV     R4,A
009B 120000      E     LCALL   _filter_i1
009E 900000      E     MOV     DPTR,#g_meas+0CH
00A1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 954
00A4 300005            JNB     interrupt_flag,?C0163
                                           ; SOURCE LINE # 955
00A7 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 956
00A9 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 957
00AC         ?C0163:
                                           ; SOURCE LINE # 959
00AC E500        R     MOV     A,UD_status
00AE 14                DEC     A
00AF 7003              JNZ     $ + 5H
00B1 020000      R     LJMP    ?C0170
00B4 14                DEC     A
00B5 7003              JNZ     $ + 5H
00B7 020000      R     LJMP    ?C0171
00BA 14                DEC     A
00BB 7003              JNZ     $ + 5H
00BD 020000      R     LJMP    ?C0174
00C0 14                DEC     A
00C1 7003              JNZ     $ + 5H
00C3 020000      R     LJMP    ?C0178
00C6 2404              ADD     A,#04H
00C8 6003              JZ      $ + 5H
00CA 020000      R     LJMP    ?C0164
                                           ; SOURCE LINE # 960
00CD         ?C0165:
                                           ; SOURCE LINE # 961
00CD 900000      E     MOV     DPTR,#ADC_buf+04H
00D0 E0                MOVX    A,@DPTR
00D1 F500        R     MOV     i_aux,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 97  

00D3 A3                INC     DPTR
00D4 E0                MOVX    A,@DPTR
00D5 F500        R     MOV     i_aux+01H,A
                                           ; SOURCE LINE # 963
00D7 AE00        R     MOV     R6,i_aux
00D9 EE                MOV     A,R6
00DA 33                RLC     A
00DB 95E0              SUBB    A,ACC
00DD FD                MOV     R5,A
00DE FC                MOV     R4,A
00DF 900000      R     MOV     DPTR,#UD_mean_value
00E2 E0                MOVX    A,@DPTR
00E3 F8                MOV     R0,A
00E4 A3                INC     DPTR
00E5 E0                MOVX    A,@DPTR
00E6 F9                MOV     R1,A
00E7 A3                INC     DPTR
00E8 E0                MOVX    A,@DPTR
00E9 FA                MOV     R2,A
00EA A3                INC     DPTR
00EB E0                MOVX    A,@DPTR
00EC FB                MOV     R3,A
00ED C3                CLR     C
00EE E500        R     MOV     A,i_aux+01H
00F0 9B                SUBB    A,R3
00F1 FF                MOV     R7,A
00F2 EE                MOV     A,R6
00F3 9A                SUBB    A,R2
00F4 FE                MOV     R6,A
00F5 ED                MOV     A,R5
00F6 99                SUBB    A,R1
00F7 FD                MOV     R5,A
00F8 EC                MOV     A,R4
00F9 98                SUBB    A,R0
00FA FC                MOV     R4,A
00FB 120000      E     LCALL   ?C?FCASTL
00FE C004              PUSH    AR4
0100 C005              PUSH    AR5
0102 C006              PUSH    AR6
0104 C007              PUSH    AR7
0106 900000      R     MOV     DPTR,#UD_mean_value
0109 E0                MOVX    A,@DPTR
010A FC                MOV     R4,A
010B A3                INC     DPTR
010C E0                MOVX    A,@DPTR
010D FD                MOV     R5,A
010E A3                INC     DPTR
010F E0                MOVX    A,@DPTR
0110 FE                MOV     R6,A
0111 A3                INC     DPTR
0112 E0                MOVX    A,@DPTR
0113 FF                MOV     R7,A
0114 EC                MOV     A,R4
0115 120000      E     LCALL   ?C?FCASTL
0118 A804              MOV     R0,AR4
011A A905              MOV     R1,AR5
011C AA06              MOV     R2,AR6
011E AB07              MOV     R3,AR7
0120 D007              POP     AR7
0122 D006              POP     AR6
0124 D005              POP     AR5
0126 D004              POP     AR4
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 98  

0128 120000      E     LCALL   ?C?FPDIV
012B C004              PUSH    AR4
012D C005              PUSH    AR5
012F C006              PUSH    AR6
0131 C007              PUSH    AR7
0133 900000      E     MOV     DPTR,#g_mem+08EH
0136 E0                MOVX    A,@DPTR
0137 FC                MOV     R4,A
0138 A3                INC     DPTR
0139 E0                MOVX    A,@DPTR
013A FD                MOV     R5,A
013B E4                CLR     A
013C 120000      E     LCALL   ?C?FCASTI
013F D003              POP     AR3
0141 D002              POP     AR2
0143 D001              POP     AR1
0145 D000              POP     AR0
0147 120000      E     LCALL   ?C?FPMUL
014A 120000      E     LCALL   ?C?CASTF
014D 8E00        R     MOV     i_aux,R6
014F 8F00        R     MOV     i_aux+01H,R7
                                           ; SOURCE LINE # 965
0151 300005            JNB     interrupt_flag,?C0166
                                           ; SOURCE LINE # 966
0154 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 967
0156 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 968
0159         ?C0166:
                                           ; SOURCE LINE # 971
0159 C3                CLR     C
015A E500        R     MOV     A,i_aux
015C 6480              XRL     A,#080H
015E 947C              SUBB    A,#07CH
0160 5006              JNC     ?C0167
                                           ; SOURCE LINE # 972
0162 7500FC      R     MOV     i_aux,#0FCH
0165 750000      R     MOV     i_aux+01H,#00H
0168         ?C0167:
                                           ; SOURCE LINE # 973
0168 D3                SETB    C
0169 E500        R     MOV     A,i_aux+01H
016B 9400              SUBB    A,#00H
016D E500        R     MOV     A,i_aux
016F 6480              XRL     A,#080H
0171 9484              SUBB    A,#084H
0173 4006              JC      ?C0168
                                           ; SOURCE LINE # 974
0175 750004      R     MOV     i_aux,#04H
0178 750000      R     MOV     i_aux+01H,#00H
017B         ?C0168:
                                           ; SOURCE LINE # 976
017B 900000      E     MOV     DPTR,#g_meas+031H
017E E500        R     MOV     A,i_aux
0180 F0                MOVX    @DPTR,A
0181 A3                INC     DPTR
0182 E500        R     MOV     A,i_aux+01H
0184 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 978
0185 200003      E     JB      interrupt_flag,$ + 6H
0188 020000      R     LJMP    ?C0164
                                           ; SOURCE LINE # 979
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 99  

018B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 980
018D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 981
                                           ; SOURCE LINE # 983
0190 020000      R     LJMP    ?C0164
                                           ; SOURCE LINE # 985
0193         ?C0170:
                                           ; SOURCE LINE # 986
0193 E4                CLR     A
0194 900000      R     MOV     DPTR,#UD_counter
0197 F0                MOVX    @DPTR,A
0198 A3                INC     DPTR
0199 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 987
019A FF                MOV     R7,A
019B FE                MOV     R6,A
019C FD                MOV     R5,A
019D FC                MOV     R4,A
019E 900000      R     MOV     DPTR,#UD_mean_value
01A1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 988
01A4 750004      R     MOV     UD_status,#04H
                                           ; SOURCE LINE # 990
01A7 020000      R     LJMP    ?C0164
                                           ; SOURCE LINE # 992
01AA         ?C0171:
                                           ; SOURCE LINE # 993
01AA 900000      R     MOV     DPTR,#UD_counter+01H
01AD E0                MOVX    A,@DPTR
01AE 04                INC     A
01AF F0                MOVX    @DPTR,A
01B0 7006              JNZ     ?C0214
01B2 900000      R     MOV     DPTR,#UD_counter
01B5 E0                MOVX    A,@DPTR
01B6 04                INC     A
01B7 F0                MOVX    @DPTR,A
01B8         ?C0214:
                                           ; SOURCE LINE # 994
01B8 900000      R     MOV     DPTR,#UD_counter
01BB E0                MOVX    A,@DPTR
01BC 7004              JNZ     ?C0215
01BE A3                INC     DPTR
01BF E0                MOVX    A,@DPTR
01C0 6464              XRL     A,#064H
01C2         ?C0215:
01C2 6003              JZ      $ + 5H
01C4 020000      R     LJMP    ?C0164
                                           ; SOURCE LINE # 995
01C7 900000      R     MOV     DPTR,#UD_counter
01CA F0                MOVX    @DPTR,A
01CB A3                INC     DPTR
01CC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 997
01CD 300005            JNB     interrupt_flag,?C0173
                                           ; SOURCE LINE # 998
01D0 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 999
01D2 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1000
01D5         ?C0173:
                                           ; SOURCE LINE # 1002
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 100 

01D5 750003      R     MOV     UD_status,#03H
                                           ; SOURCE LINE # 1003
                                           ; SOURCE LINE # 1005
01D8 020000      R     LJMP    ?C0164
                                           ; SOURCE LINE # 1007
01DB         ?C0174:
                                           ; SOURCE LINE # 1009
01DB 900000      R     MOV     DPTR,#UD_counter+01H
01DE E0                MOVX    A,@DPTR
01DF 04                INC     A
01E0 F0                MOVX    @DPTR,A
01E1 7006              JNZ     ?C0216
01E3 900000      R     MOV     DPTR,#UD_counter
01E6 E0                MOVX    A,@DPTR
01E7 04                INC     A
01E8 F0                MOVX    @DPTR,A
01E9         ?C0216:
                                           ; SOURCE LINE # 1010
01E9 900000      R     MOV     DPTR,#UD_mean_value
01EC E0                MOVX    A,@DPTR
01ED F8                MOV     R0,A
01EE A3                INC     DPTR
01EF E0                MOVX    A,@DPTR
01F0 F9                MOV     R1,A
01F1 A3                INC     DPTR
01F2 E0                MOVX    A,@DPTR
01F3 FA                MOV     R2,A
01F4 A3                INC     DPTR
01F5 E0                MOVX    A,@DPTR
01F6 FB                MOV     R3,A
01F7 900000      E     MOV     DPTR,#ADC_buf+04H
01FA E0                MOVX    A,@DPTR
01FB FE                MOV     R6,A
01FC A3                INC     DPTR
01FD E0                MOVX    A,@DPTR
01FE FF                MOV     R7,A
01FF EE                MOV     A,R6
0200 33                RLC     A
0201 95E0              SUBB    A,ACC
0203 FD                MOV     R5,A
0204 FC                MOV     R4,A
0205 EB                MOV     A,R3
0206 2F                ADD     A,R7
0207 FF                MOV     R7,A
0208 EA                MOV     A,R2
0209 3E                ADDC    A,R6
020A FE                MOV     R6,A
020B E9                MOV     A,R1
020C 3D                ADDC    A,R5
020D FD                MOV     R5,A
020E E8                MOV     A,R0
020F 3C                ADDC    A,R4
0210 FC                MOV     R4,A
0211 900000      R     MOV     DPTR,#UD_mean_value
0214 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1012
0217 300005            JNB     interrupt_flag,?C0175
                                           ; SOURCE LINE # 1013
021A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1014
021C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1015
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 101 

021F         ?C0175:
                                           ; SOURCE LINE # 1017
021F 900000      R     MOV     DPTR,#UD_counter
0222 E0                MOVX    A,@DPTR
0223 7004              JNZ     ?C0217
0225 A3                INC     DPTR
0226 E0                MOVX    A,@DPTR
0227 64C8              XRL     A,#0C8H
0229         ?C0217:
0229 7033              JNZ     ?C0164
                                           ; SOURCE LINE # 1018
022B 900000      R     MOV     DPTR,#UD_mean_value
022E E0                MOVX    A,@DPTR
022F FC                MOV     R4,A
0230 A3                INC     DPTR
0231 E0                MOVX    A,@DPTR
0232 FD                MOV     R5,A
0233 A3                INC     DPTR
0234 E0                MOVX    A,@DPTR
0235 FE                MOV     R6,A
0236 A3                INC     DPTR
0237 E0                MOVX    A,@DPTR
0238 FF                MOV     R7,A
0239 E4                CLR     A
023A 7BC8              MOV     R3,#0C8H
023C FA                MOV     R2,A
023D F9                MOV     R1,A
023E F8                MOV     R0,A
023F 120000      E     LCALL   ?C?SLDIV
0242 900000      R     MOV     DPTR,#UD_mean_value
0245 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1020
0248 300005            JNB     interrupt_flag,?C0177
                                           ; SOURCE LINE # 1021
024B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1022
024D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1023
0250         ?C0177:
                                           ; SOURCE LINE # 1025
0250 E4                CLR     A
0251 900000      R     MOV     DPTR,#UD_counter
0254 F0                MOVX    @DPTR,A
0255 A3                INC     DPTR
0256 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1026
0257 F500        R     MOV     UD_status,A
                                           ; SOURCE LINE # 1027
                                           ; SOURCE LINE # 1028
0259 8003              SJMP    ?C0164
                                           ; SOURCE LINE # 1030
025B         ?C0178:
                                           ; SOURCE LINE # 1031
025B 750002      R     MOV     UD_status,#02H
                                           ; SOURCE LINE # 1032
                                           ; SOURCE LINE # 1033
025E         ?C0164:
                                           ; SOURCE LINE # 1035
025E E500        R     MOV     A,LR_status
0260 14                DEC     A
0261 7003              JNZ     $ + 5H
0263 020000      R     LJMP    ?C0185
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 102 

0266 14                DEC     A
0267 7003              JNZ     $ + 5H
0269 020000      R     LJMP    ?C0186
026C 14                DEC     A
026D 7003              JNZ     $ + 5H
026F 020000      R     LJMP    ?C0189
0272 14                DEC     A
0273 7003              JNZ     $ + 5H
0275 020000      R     LJMP    ?C0192
0278 2404              ADD     A,#04H
027A 6003              JZ      $ + 5H
027C 020000      R     LJMP    ?C0179
                                           ; SOURCE LINE # 1036
027F         ?C0180:
                                           ; SOURCE LINE # 1037
027F 900000      E     MOV     DPTR,#ADC_buf+06H
0282 E0                MOVX    A,@DPTR
0283 F500        R     MOV     i_aux,A
0285 A3                INC     DPTR
0286 E0                MOVX    A,@DPTR
0287 F500        R     MOV     i_aux+01H,A
                                           ; SOURCE LINE # 1039
0289 AE00        R     MOV     R6,i_aux
028B EE                MOV     A,R6
028C 33                RLC     A
028D 95E0              SUBB    A,ACC
028F FD                MOV     R5,A
0290 FC                MOV     R4,A
0291 900000      R     MOV     DPTR,#LR_mean_value
0294 E0                MOVX    A,@DPTR
0295 F8                MOV     R0,A
0296 A3                INC     DPTR
0297 E0                MOVX    A,@DPTR
0298 F9                MOV     R1,A
0299 A3                INC     DPTR
029A E0                MOVX    A,@DPTR
029B FA                MOV     R2,A
029C A3                INC     DPTR
029D E0                MOVX    A,@DPTR
029E FB                MOV     R3,A
029F C3                CLR     C
02A0 E500        R     MOV     A,i_aux+01H
02A2 9B                SUBB    A,R3
02A3 FF                MOV     R7,A
02A4 EE                MOV     A,R6
02A5 9A                SUBB    A,R2
02A6 FE                MOV     R6,A
02A7 ED                MOV     A,R5
02A8 99                SUBB    A,R1
02A9 FD                MOV     R5,A
02AA EC                MOV     A,R4
02AB 98                SUBB    A,R0
02AC FC                MOV     R4,A
02AD 120000      E     LCALL   ?C?FCASTL
02B0 C004              PUSH    AR4
02B2 C005              PUSH    AR5
02B4 C006              PUSH    AR6
02B6 C007              PUSH    AR7
02B8 900000      R     MOV     DPTR,#LR_mean_value
02BB E0                MOVX    A,@DPTR
02BC FC                MOV     R4,A
02BD A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 103 

02BE E0                MOVX    A,@DPTR
02BF FD                MOV     R5,A
02C0 A3                INC     DPTR
02C1 E0                MOVX    A,@DPTR
02C2 FE                MOV     R6,A
02C3 A3                INC     DPTR
02C4 E0                MOVX    A,@DPTR
02C5 FF                MOV     R7,A
02C6 EC                MOV     A,R4
02C7 120000      E     LCALL   ?C?FCASTL
02CA A804              MOV     R0,AR4
02CC A905              MOV     R1,AR5
02CE AA06              MOV     R2,AR6
02D0 AB07              MOV     R3,AR7
02D2 D007              POP     AR7
02D4 D006              POP     AR6
02D6 D005              POP     AR5
02D8 D004              POP     AR4
02DA 120000      E     LCALL   ?C?FPDIV
02DD C004              PUSH    AR4
02DF C005              PUSH    AR5
02E1 C006              PUSH    AR6
02E3 C007              PUSH    AR7
02E5 900000      E     MOV     DPTR,#g_mem+08CH
02E8 E0                MOVX    A,@DPTR
02E9 FC                MOV     R4,A
02EA A3                INC     DPTR
02EB E0                MOVX    A,@DPTR
02EC FD                MOV     R5,A
02ED E4                CLR     A
02EE 120000      E     LCALL   ?C?FCASTI
02F1 D003              POP     AR3
02F3 D002              POP     AR2
02F5 D001              POP     AR1
02F7 D000              POP     AR0
02F9 120000      E     LCALL   ?C?FPMUL
02FC 120000      E     LCALL   ?C?CASTF
02FF 8E00        R     MOV     i_aux,R6
0301 8F00        R     MOV     i_aux+01H,R7
                                           ; SOURCE LINE # 1041
0303 300005            JNB     interrupt_flag,?C0181
                                           ; SOURCE LINE # 1042
0306 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1043
0308 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1044
030B         ?C0181:
                                           ; SOURCE LINE # 1047
030B C3                CLR     C
030C E500        R     MOV     A,i_aux
030E 6480              XRL     A,#080H
0310 947C              SUBB    A,#07CH
0312 5006              JNC     ?C0182
                                           ; SOURCE LINE # 1048
0314 7500FC      R     MOV     i_aux,#0FCH
0317 750000      R     MOV     i_aux+01H,#00H
031A         ?C0182:
                                           ; SOURCE LINE # 1049
031A D3                SETB    C
031B E500        R     MOV     A,i_aux+01H
031D 9400              SUBB    A,#00H
031F E500        R     MOV     A,i_aux
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 104 

0321 6480              XRL     A,#080H
0323 9484              SUBB    A,#084H
0325 4006              JC      ?C0183
                                           ; SOURCE LINE # 1050
0327 750004      R     MOV     i_aux,#04H
032A 750000      R     MOV     i_aux+01H,#00H
032D         ?C0183:
                                           ; SOURCE LINE # 1052
032D 300005            JNB     interrupt_flag,?C0184
                                           ; SOURCE LINE # 1053
0330 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1054
0332 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1055
0335         ?C0184:
                                           ; SOURCE LINE # 1057
0335 900000      E     MOV     DPTR,#g_meas+02FH
0338 E500        R     MOV     A,i_aux
033A F0                MOVX    @DPTR,A
033B A3                INC     DPTR
033C E500        R     MOV     A,i_aux+01H
033E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1059
033F 020000      R     LJMP    ?C0179
                                           ; SOURCE LINE # 1061
0342         ?C0185:
                                           ; SOURCE LINE # 1062
0342 E4                CLR     A
0343 900000      R     MOV     DPTR,#LR_counter
0346 F0                MOVX    @DPTR,A
0347 A3                INC     DPTR
0348 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1063
0349 FF                MOV     R7,A
034A FE                MOV     R6,A
034B FD                MOV     R5,A
034C FC                MOV     R4,A
034D 900000      R     MOV     DPTR,#LR_mean_value
0350 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1064
0353 750004      R     MOV     LR_status,#04H
                                           ; SOURCE LINE # 1065
0356 020000      R     LJMP    ?C0179
                                           ; SOURCE LINE # 1067
0359         ?C0186:
                                           ; SOURCE LINE # 1068
0359 900000      R     MOV     DPTR,#LR_counter+01H
035C E0                MOVX    A,@DPTR
035D 04                INC     A
035E F0                MOVX    @DPTR,A
035F 7006              JNZ     ?C0218
0361 900000      R     MOV     DPTR,#LR_counter
0364 E0                MOVX    A,@DPTR
0365 04                INC     A
0366 F0                MOVX    @DPTR,A
0367         ?C0218:
                                           ; SOURCE LINE # 1069
0367 900000      R     MOV     DPTR,#LR_counter
036A E0                MOVX    A,@DPTR
036B 7004              JNZ     ?C0219
036D A3                INC     DPTR
036E E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 105 

036F 6464              XRL     A,#064H
0371         ?C0219:
0371 6003              JZ      $ + 5H
0373 020000      R     LJMP    ?C0179
                                           ; SOURCE LINE # 1070
0376 900000      R     MOV     DPTR,#LR_counter
0379 F0                MOVX    @DPTR,A
037A A3                INC     DPTR
037B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1072
037C 300005            JNB     interrupt_flag,?C0188
                                           ; SOURCE LINE # 1073
037F C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1074
0381 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1075
0384         ?C0188:
                                           ; SOURCE LINE # 1077
0384 750003      R     MOV     LR_status,#03H
                                           ; SOURCE LINE # 1078
                                           ; SOURCE LINE # 1079
0387 807F              SJMP    ?C0179
                                           ; SOURCE LINE # 1081
0389         ?C0189:
                                           ; SOURCE LINE # 1083
0389 900000      R     MOV     DPTR,#LR_counter+01H
038C E0                MOVX    A,@DPTR
038D 04                INC     A
038E F0                MOVX    @DPTR,A
038F 7006              JNZ     ?C0220
0391 900000      R     MOV     DPTR,#LR_counter
0394 E0                MOVX    A,@DPTR
0395 04                INC     A
0396 F0                MOVX    @DPTR,A
0397         ?C0220:
                                           ; SOURCE LINE # 1084
0397 900000      R     MOV     DPTR,#LR_mean_value
039A E0                MOVX    A,@DPTR
039B F8                MOV     R0,A
039C A3                INC     DPTR
039D E0                MOVX    A,@DPTR
039E F9                MOV     R1,A
039F A3                INC     DPTR
03A0 E0                MOVX    A,@DPTR
03A1 FA                MOV     R2,A
03A2 A3                INC     DPTR
03A3 E0                MOVX    A,@DPTR
03A4 FB                MOV     R3,A
03A5 900000      E     MOV     DPTR,#ADC_buf+06H
03A8 E0                MOVX    A,@DPTR
03A9 FE                MOV     R6,A
03AA A3                INC     DPTR
03AB E0                MOVX    A,@DPTR
03AC FF                MOV     R7,A
03AD EE                MOV     A,R6
03AE 33                RLC     A
03AF 95E0              SUBB    A,ACC
03B1 FD                MOV     R5,A
03B2 FC                MOV     R4,A
03B3 EB                MOV     A,R3
03B4 2F                ADD     A,R7
03B5 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 106 

03B6 EA                MOV     A,R2
03B7 3E                ADDC    A,R6
03B8 FE                MOV     R6,A
03B9 E9                MOV     A,R1
03BA 3D                ADDC    A,R5
03BB FD                MOV     R5,A
03BC E8                MOV     A,R0
03BD 3C                ADDC    A,R4
03BE FC                MOV     R4,A
03BF 900000      R     MOV     DPTR,#LR_mean_value
03C2 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1085
03C5 900000      R     MOV     DPTR,#LR_counter
03C8 E0                MOVX    A,@DPTR
03C9 7004              JNZ     ?C0221
03CB A3                INC     DPTR
03CC E0                MOVX    A,@DPTR
03CD 64C8              XRL     A,#0C8H
03CF         ?C0221:
03CF 7037              JNZ     ?C0179
                                           ; SOURCE LINE # 1086
03D1 900000      R     MOV     DPTR,#LR_mean_value
03D4 E0                MOVX    A,@DPTR
03D5 FC                MOV     R4,A
03D6 A3                INC     DPTR
03D7 E0                MOVX    A,@DPTR
03D8 FD                MOV     R5,A
03D9 A3                INC     DPTR
03DA E0                MOVX    A,@DPTR
03DB FE                MOV     R6,A
03DC A3                INC     DPTR
03DD E0                MOVX    A,@DPTR
03DE FF                MOV     R7,A
03DF E4                CLR     A
03E0 7BC8              MOV     R3,#0C8H
03E2 FA                MOV     R2,A
03E3 F9                MOV     R1,A
03E4 F8                MOV     R0,A
03E5 120000      E     LCALL   ?C?SLDIV
03E8 900000      R     MOV     DPTR,#LR_mean_value
03EB 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1088
03EE 300005            JNB     interrupt_flag,?C0191
                                           ; SOURCE LINE # 1089
03F1 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1090
03F3 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1091
03F6         ?C0191:
                                           ; SOURCE LINE # 1093
03F6 E4                CLR     A
03F7 900000      R     MOV     DPTR,#LR_counter
03FA F0                MOVX    @DPTR,A
03FB A3                INC     DPTR
03FC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1094
03FD F500        R     MOV     LR_status,A
                                           ; SOURCE LINE # 1095
                                           ; SOURCE LINE # 1096
03FF 8007              SJMP    ?C0179
                                           ; SOURCE LINE # 1098
0401         ?C0192:
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 107 

                                           ; SOURCE LINE # 1099
0401 E500        R     MOV     A,UD_status
0403 7003              JNZ     ?C0179
                                           ; SOURCE LINE # 1100
0405 750002      R     MOV     LR_status,#02H
                                           ; SOURCE LINE # 1101
                                           ; SOURCE LINE # 1102
0408         ?C0179:
                                           ; SOURCE LINE # 1104
0408 30002D            JNB     interrupt_flag,?C0195
                                           ; SOURCE LINE # 1105
040B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1106
040D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1107
                                           ; SOURCE LINE # 1108
0410 8026              SJMP    ?C0195
0412         ?C0161:
                                           ; SOURCE LINE # 1109
                                           ; SOURCE LINE # 1110
0412 750001      R     MOV     UD_status,#01H
                                           ; SOURCE LINE # 1111
0415 750001      R     MOV     LR_status,#01H
                                           ; SOURCE LINE # 1113
0418 C200        E     CLR     tension_valid
                                           ; SOURCE LINE # 1115
041A 300005            JNB     interrupt_flag,?C0196
                                           ; SOURCE LINE # 1116
041D C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1117
041F 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1118
0422         ?C0196:
                                           ; SOURCE LINE # 1121
0422 E4                CLR     A
0423 FF                MOV     R7,A
0424 FE                MOV     R6,A
0425 FD                MOV     R5,A
0426 FC                MOV     R4,A
0427 900000      E     MOV     DPTR,#g_meas+0CH
042A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1124
042D E4                CLR     A
042E 900000      E     MOV     DPTR,#g_meas+02FH
0431 F0                MOVX    @DPTR,A
0432 A3                INC     DPTR
0433 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1125
0434 A3                INC     DPTR
0435 F0                MOVX    @DPTR,A
0436 A3                INC     DPTR
0437 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1127
0438         ?C0195:
                                           ; SOURCE LINE # 1129
0438 300005            JNB     interrupt_flag,?C0198
                                           ; SOURCE LINE # 1130
043B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1131
043D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1132
                                           ; SOURCE LINE # 1133
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 108 

0440         ?C0198:
0440 22                RET     
             ; FUNCTION analog_read_end (END)

             ; FUNCTION overcurrent_control (BEGIN)
                                           ; SOURCE LINE # 1139
                                           ; SOURCE LINE # 1140
0000 900000      E     MOV     DPTR,#c_mem+069H
0003 E0                MOVX    A,@DPTR
0004 FE                MOV     R6,A
0005 A3                INC     DPTR
0006 E0                MOVX    A,@DPTR
0007 FF                MOV     R7,A
0008 4E                ORL     A,R6
0009 6068              JZ      ?C0206
                                           ; SOURCE LINE # 1142
000B EE                MOV     A,R6
000C 33                RLC     A
000D 95E0              SUBB    A,ACC
000F FD                MOV     R5,A
0010 FC                MOV     R4,A
0011 900000      E     MOV     DPTR,#g_meas+0CH
0014 E0                MOVX    A,@DPTR
0015 F8                MOV     R0,A
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 F9                MOV     R1,A
0019 A3                INC     DPTR
001A E0                MOVX    A,@DPTR
001B FA                MOV     R2,A
001C A3                INC     DPTR
001D E0                MOVX    A,@DPTR
001E FB                MOV     R3,A
001F D3                SETB    C
0020 120000      E     LCALL   ?C?SLCMP
0023 4008              JC      ?C0200
                                           ; SOURCE LINE # 1144
0025 900000      E     MOV     DPTR,#dev_pwm_limit
0028 E0                MOVX    A,@DPTR
0029 14                DEC     A
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1146
002B 802D              SJMP    ?C0201
002D         ?C0200:
002D 900000      E     MOV     DPTR,#c_mem+06AH
0030 E0                MOVX    A,@DPTR
0031 24F6              ADD     A,#0F6H
0033 FF                MOV     R7,A
0034 900000      E     MOV     DPTR,#c_mem+069H
0037 E0                MOVX    A,@DPTR
0038 34FF              ADDC    A,#0FFH
003A FE                MOV     R6,A
003B 33                RLC     A
003C 95E0              SUBB    A,ACC
003E FD                MOV     R5,A
003F FC                MOV     R4,A
0040 900000      E     MOV     DPTR,#g_meas+0CH
0043 E0                MOVX    A,@DPTR
0044 F8                MOV     R0,A
0045 A3                INC     DPTR
0046 E0                MOVX    A,@DPTR
0047 F9                MOV     R1,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 109 

0048 A3                INC     DPTR
0049 E0                MOVX    A,@DPTR
004A FA                MOV     R2,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D FB                MOV     R3,A
004E C3                CLR     C
004F 120000      E     LCALL   ?C?SLCMP
0052 5006              JNC     ?C0201
                                           ; SOURCE LINE # 1148
0054 900000      E     MOV     DPTR,#dev_pwm_limit
0057 E0                MOVX    A,@DPTR
0058 04                INC     A
0059 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1149
005A         ?C0201:
                                           ; SOURCE LINE # 1152
005A 900000      E     MOV     DPTR,#dev_pwm_limit
005D E0                MOVX    A,@DPTR
005E FF                MOV     R7,A
005F C3                CLR     C
0060 9400              SUBB    A,#00H
0062 5003              JNC     ?C0203
                                           ; SOURCE LINE # 1153
0064 E4                CLR     A
0065 F0                MOVX    @DPTR,A
0066 22                RET     
0067         ?C0203:
                                           ; SOURCE LINE # 1155
0067 EF                MOV     A,R7
0068 D3                SETB    C
0069 9464              SUBB    A,#064H
006B 4006              JC      ?C0206
                                           ; SOURCE LINE # 1156
006D 900000      E     MOV     DPTR,#dev_pwm_limit
0070 7464              MOV     A,#064H
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1157
                                           ; SOURCE LINE # 1158
0073         ?C0206:
0073 22                RET     
             ; FUNCTION overcurrent_control (END)

             ; FUNCTION pwm_limit_search (BEGIN)
                                           ; SOURCE LINE # 1164
                                           ; SOURCE LINE # 1168
0000 E4                CLR     A
0001 7F9C              MOV     R7,#09CH
0003 7E63              MOV     R6,#063H
0005 FD                MOV     R5,A
0006 FC                MOV     R4,A
0007 900000      E     MOV     DPTR,#dev_tension
000A E0                MOVX    A,@DPTR
000B F8                MOV     R0,A
000C A3                INC     DPTR
000D E0                MOVX    A,@DPTR
000E F9                MOV     R1,A
000F A3                INC     DPTR
0010 E0                MOVX    A,@DPTR
0011 FA                MOV     R2,A
0012 A3                INC     DPTR
0013 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 110 

0014 FB                MOV     R3,A
0015 D3                SETB    C
0016 120000      E     LCALL   ?C?SLCMP
0019 4006              JC      ?C0207
                                           ; SOURCE LINE # 1169
001B E4                CLR     A
001C 900000      E     MOV     DPTR,#dev_pwm_limit
001F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1170
0020 22                RET     
0021         ?C0207:
0021 E4                CLR     A
0022 7FEC              MOV     R7,#0ECH
0024 7E2C              MOV     R6,#02CH
0026 FD                MOV     R5,A
0027 FC                MOV     R4,A
0028 900000      E     MOV     DPTR,#dev_tension
002B E0                MOVX    A,@DPTR
002C F8                MOV     R0,A
002D A3                INC     DPTR
002E E0                MOVX    A,@DPTR
002F F9                MOV     R1,A
0030 A3                INC     DPTR
0031 E0                MOVX    A,@DPTR
0032 FA                MOV     R2,A
0033 A3                INC     DPTR
0034 E0                MOVX    A,@DPTR
0035 FB                MOV     R3,A
0036 C3                CLR     C
0037 120000      E     LCALL   ?C?SLCMP
003A 5007              JNC     ?C0209
                                           ; SOURCE LINE # 1171
003C 900000      E     MOV     DPTR,#dev_pwm_limit
003F 7464              MOV     A,#064H
0041 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1172
0042 22                RET     
0043         ?C0209:
                                           ; SOURCE LINE # 1173
0043 900000      E     MOV     DPTR,#dev_tension
0046 E0                MOVX    A,@DPTR
0047 FC                MOV     R4,A
0048 A3                INC     DPTR
0049 E0                MOVX    A,@DPTR
004A FD                MOV     R5,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D FE                MOV     R6,A
004E A3                INC     DPTR
004F E0                MOVX    A,@DPTR
0050 2414              ADD     A,#014H
0052 FF                MOV     R7,A
0053 EE                MOV     A,R6
0054 34D3              ADDC    A,#0D3H
0056 FE                MOV     R6,A
0057 ED                MOV     A,R5
0058 34FF              ADDC    A,#0FFH
005A FD                MOV     R5,A
005B EC                MOV     A,R4
005C 34FF              ADDC    A,#0FFH
005E FC                MOV     R4,A
005F 7809              MOV     R0,#09H
C51 COMPILER V9.51   INTERRUPTIONS                                                         12/05/2016 17:11:53 PAGE 111 

0061 120000      E     LCALL   ?C?SLSHR
0064 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 1174
0066 7400        R     MOV     A,#LOW pwm_preload_values
0068 2F                ADD     A,R7
0069 F582              MOV     DPL,A
006B E4                CLR     A
006C 3400        R     ADDC    A,#HIGH pwm_preload_values
006E F583              MOV     DPH,A
0070 E0                MOVX    A,@DPTR
0071 900000      E     MOV     DPTR,#dev_pwm_limit
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1175
                                           ; SOURCE LINE # 1176
0075         ?C0211:
0075 22                RET     
             ; FUNCTION pwm_limit_search (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   7545    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    203      12
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8      90
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
